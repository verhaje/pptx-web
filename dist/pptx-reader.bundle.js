function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach(function(t){_defineProperty(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function _regeneratorValues(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],r=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}throw new TypeError(_typeof(e)+" is not iterable")}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var a=0,n=function(){};return{s:n,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=Array(t);r<t;r++)a[r]=e[r];return a}function _regenerator(){var e,t,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",n=r.toStringTag||"@@toStringTag";function i(r,a,n,i){var l=a&&a.prototype instanceof s?a:s,c=Object.create(l.prototype);return _regeneratorDefine2(c,"_invoke",function(r,a,n){var i,s,l,c=0,u=n||[],h=!1,d={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,r){return i=t,s=0,l=e,d.n=r,o}};function f(r,a){for(s=r,l=a,t=0;!h&&c&&!n&&t<u.length;t++){var n,i=u[t],f=d.p,p=i[2];r>3?(n=p===a)&&(l=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=f&&((n=r<2&&f<i[1])?(s=0,d.v=a,d.n=i[1]):f<p&&(n=r<3||i[0]>a||a>p)&&(i[4]=r,i[5]=a,d.n=p,s=0))}if(n||r>1)return o;throw h=!0,a}return function(n,u,p){if(c>1)throw TypeError("Generator is already running");for(h&&1===u&&f(u,p),s=u,l=p;(t=s<2?e:l)||!h;){i||(s?s<3?(s>1&&(d.n=-1),f(s,l)):d.n=l:d.v=l);try{if(c=2,i){if(s||(n="next"),t=i[n]){if(!(t=t.call(i,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(l=TypeError("The iterator does not provide a '"+n+"' method"),s=1);i=e}else if((t=(h=d.n<0)?l:r.call(a,d))!==o)break}catch(t){i=e,s=1,l=t}finally{c=1}}return{value:t,done:h}}}(r,n,i),!0),c}var o={};function s(){}function l(){}function c(){}t=Object.getPrototypeOf;var u=[][a]?t(t([][a]())):(_regeneratorDefine2(t={},a,function(){return this}),t),h=c.prototype=s.prototype=Object.create(u);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,_regeneratorDefine2(e,n,"GeneratorFunction")),e.prototype=Object.create(h),e}return l.prototype=c,_regeneratorDefine2(h,"constructor",c),_regeneratorDefine2(c,"constructor",l),l.displayName="GeneratorFunction",_regeneratorDefine2(c,n,"GeneratorFunction"),_regeneratorDefine2(h),_regeneratorDefine2(h,n,"Generator"),_regeneratorDefine2(h,a,function(){return this}),_regeneratorDefine2(h,"toString",function(){return"[object Generator]"}),(_regenerator=function(){return{w:i,m:d}})()}function _regeneratorDefine2(e,t,r,a){var n=Object.defineProperty;try{n({},"",{})}catch(e){n=0}_regeneratorDefine2=function(e,t,r,a){function i(t,r){_regeneratorDefine2(e,t,function(e){return this._invoke(t,r,e)})}t?n?n(e,t,{value:r,enumerable:!a,configurable:!a,writable:!a}):e[t]=r:(i("next",0),i("throw",1),i("return",2))},_regeneratorDefine2(e,t,r,a)}function asyncGeneratorStep(e,t,r,a,n,i,o){try{var s=e[i](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(a,n)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(a,n){var i=e.apply(t,r);function o(e){asyncGeneratorStep(i,a,n,o,s,"next",e)}function s(e){asyncGeneratorStep(i,a,n,o,s,"throw",e)}o(void 0)})}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,_toPropertyKey(a.key),a)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=_typeof(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}!function(e){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).JSZip=e()}(function(){return function e(t,r,a){function n(o,s){if(!r[o]){if(!t[o]){var l="function"==typeof require&&require;if(!s&&l)return l(o,!0);if(i)return i(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var u=r[o]={exports:{}};t[o][0].call(u.exports,function(e){return n(t[o][1][e]||e)},u,u.exports,e,t,r,a)}return r[o].exports}for(var i="function"==typeof require&&require,o=0;o<a.length;o++)n(a[o]);return n}({1:[function(e,t,r){"use strict";var a=e("./utils"),n=e("./support"),i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(e){for(var t,r,n,o,s,l,c,u=[],h=0,d=e.length,f=d,p="string"!==a.getTypeOf(e);h<e.length;)f=d-h,n=p?(t=e[h++],r=h<d?e[h++]:0,h<d?e[h++]:0):(t=e.charCodeAt(h++),r=h<d?e.charCodeAt(h++):0,h<d?e.charCodeAt(h++):0),o=t>>2,s=(3&t)<<4|r>>4,l=1<f?(15&r)<<2|n>>6:64,c=2<f?63&n:64,u.push(i.charAt(o)+i.charAt(s)+i.charAt(l)+i.charAt(c));return u.join("")},r.decode=function(e){var t,r,a,o,s,l,c=0,u=0;if("data:"===e.substr(0,5))throw new Error("Invalid base64 input, it looks like a data url.");var h,d=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===i.charAt(64)&&d--,e.charAt(e.length-2)===i.charAt(64)&&d--,d%1!=0)throw new Error("Invalid base64 input, bad content length.");for(h=n.uint8array?new Uint8Array(0|d):new Array(0|d);c<e.length;)t=i.indexOf(e.charAt(c++))<<2|(o=i.indexOf(e.charAt(c++)))>>4,r=(15&o)<<4|(s=i.indexOf(e.charAt(c++)))>>2,a=(3&s)<<6|(l=i.indexOf(e.charAt(c++))),h[u++]=t,64!==s&&(h[u++]=r),64!==l&&(h[u++]=a);return h}},{"./support":30,"./utils":32}],2:[function(e,t,r){"use strict";var a=e("./external"),n=e("./stream/DataWorker"),i=e("./stream/Crc32Probe"),o=e("./stream/DataLengthProbe");function s(e,t,r,a,n){this.compressedSize=e,this.uncompressedSize=t,this.crc32=r,this.compression=a,this.compressedContent=n}s.prototype={getContentWorker:function(){var e=new n(a.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new o("data_length")),t=this;return e.on("end",function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),e},getCompressedWorker:function(){return new n(a.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},s.createWorkerFrom=function(e,t,r){return e.pipe(new i).pipe(new o("uncompressedSize")).pipe(t.compressWorker(r)).pipe(new o("compressedSize")).withStreamInfo("compression",t)},t.exports=s},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,r){"use strict";var a=e("./stream/GenericWorker");r.STORE={magic:"\0\0",compressWorker:function(){return new a("STORE compression")},uncompressWorker:function(){return new a("STORE decompression")}},r.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,r){"use strict";var a=e("./utils"),n=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var a=0;a<8;a++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==a.getTypeOf(e)?function(e,t,r){var a=n,i=0+r;e^=-1;for(var o=0;o<i;o++)e=e>>>8^a[255&(e^t[o])];return-1^e}(0|t,e,e.length):function(e,t,r){var a=n,i=0+r;e^=-1;for(var o=0;o<i;o++)e=e>>>8^a[255&(e^t.charCodeAt(o))];return-1^e}(0|t,e,e.length):0}},{"./utils":32}],5:[function(e,t,r){"use strict";r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!0,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],6:[function(e,t,r){"use strict";var a;a="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:a}},{lie:37}],7:[function(e,t,r){"use strict";var a="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,n=e("pako"),i=e("./utils"),o=e("./stream/GenericWorker"),s=a?"uint8array":"array";function l(e,t){o.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}r.magic="\b\0",i.inherits(l,o),l.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(i.transformTo(s,e.data),!1)},l.prototype.flush=function(){o.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new n[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},r.compressWorker=function(e){return new l("Deflate",e)},r.uncompressWorker=function(){return new l("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,r){"use strict";function a(e,t){var r,a="";for(r=0;r<t;r++)a+=String.fromCharCode(255&e),e>>>=8;return a}function n(e,t,r,n,o,u){var h,d,f=e.file,p=e.compression,g=u!==s.utf8encode,m=i.transformTo("string",u(f.name)),y=i.transformTo("string",s.utf8encode(f.name)),v=f.comment,b=i.transformTo("string",u(v)),x=i.transformTo("string",s.utf8encode(v)),_=y.length!==f.name.length,E=x.length!==v.length,w="",k="",T="",S=f.dir,A=f.date,I={crc32:0,compressedSize:0,uncompressedSize:0};t&&!r||(I.crc32=e.crc32,I.compressedSize=e.compressedSize,I.uncompressedSize=e.uncompressedSize);var C=0;t&&(C|=8),g||!_&&!E||(C|=2048);var B=0,N=0;S&&(B|=16),"UNIX"===o?(N=798,B|=function(e,t){var r=e;return e||(r=t?16893:33204),(65535&r)<<16}(f.unixPermissions,S)):(N=20,B|=function(e){return 63&(e||0)}(f.dosPermissions)),h=A.getUTCHours(),h<<=6,h|=A.getUTCMinutes(),h<<=5,h|=A.getUTCSeconds()/2,d=A.getUTCFullYear()-1980,d<<=4,d|=A.getUTCMonth()+1,d<<=5,d|=A.getUTCDate(),_&&(k=a(1,1)+a(l(m),4)+y,w+="up"+a(k.length,2)+k),E&&(T=a(1,1)+a(l(b),4)+x,w+="uc"+a(T.length,2)+T);var P="";return P+="\n\0",P+=a(C,2),P+=p.magic,P+=a(h,2),P+=a(d,2),P+=a(I.crc32,4),P+=a(I.compressedSize,4),P+=a(I.uncompressedSize,4),P+=a(m.length,2),P+=a(w.length,2),{fileRecord:c.LOCAL_FILE_HEADER+P+m+w,dirRecord:c.CENTRAL_FILE_HEADER+a(N,2)+P+a(b.length,2)+"\0\0\0\0"+a(B,4)+a(n,4)+m+w+b}}var i=e("../utils"),o=e("../stream/GenericWorker"),s=e("../utf8"),l=e("../crc32"),c=e("../signature");function u(e,t,r,a){o.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=r,this.encodeFileName=a,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}i.inherits(u,o),u.prototype.push=function(e){var t=e.meta.percent||0,r=this.entriesCount,a=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,o.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:r?(t+100*(r-a-1))/r:100}}))},u.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var r=n(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:r.fileRecord,meta:{percent:0}})}else this.accumulate=!0},u.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,r=n(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(r.dirRecord),t)this.push({data:function(e){return c.DATA_DESCRIPTOR+a(e.crc32,4)+a(e.compressedSize,4)+a(e.uncompressedSize,4)}(e),meta:{percent:100}});else for(this.push({data:r.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},u.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var r=this.bytesWritten-e,n=function(e,t,r,n,o){var s=i.transformTo("string",o(n));return c.CENTRAL_DIRECTORY_END+"\0\0\0\0"+a(e,2)+a(e,2)+a(t,4)+a(r,4)+a(s.length,2)+s}(this.dirRecords.length,r,e,this.zipComment,this.encodeFileName);this.push({data:n,meta:{percent:100}})},u.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},u.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()}),e.on("error",function(e){t.error(e)}),this},u.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},u.prototype.error=function(e){var t=this._sources;if(!o.prototype.error.call(this,e))return!1;for(var r=0;r<t.length;r++)try{t[r].error(e)}catch(e){}return!0},u.prototype.lock=function(){o.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=u},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,r){"use strict";var a=e("../compressions"),n=e("./ZipFileWorker");r.generateWorker=function(e,t,r){var i=new n(t.streamFiles,r,t.platform,t.encodeFileName),o=0;try{e.forEach(function(e,r){o++;var n=function(e,t){var r=e||t,n=a[r];if(!n)throw new Error(r+" is not a valid compression method !");return n}(r.options.compression,t.compression),s=r.options.compressionOptions||t.compressionOptions||{},l=r.dir,c=r.date;r._compressWorker(n,s).withStreamInfo("file",{name:e,dir:l,date:c,comment:r.comment||"",unixPermissions:r.unixPermissions,dosPermissions:r.dosPermissions}).pipe(i)}),i.entriesCount=o}catch(e){i.error(e)}return i}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,r){"use strict";function a(){if(!(this instanceof a))return new a;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new a;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(a.prototype=e("./object")).loadAsync=e("./load"),a.support=e("./support"),a.defaults=e("./defaults"),a.version="3.10.1",a.loadAsync=function(e,t){return(new a).loadAsync(e,t)},a.external=e("./external"),t.exports=a},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,r){"use strict";var a=e("./utils"),n=e("./external"),i=e("./utf8"),o=e("./zipEntries"),s=e("./stream/Crc32Probe"),l=e("./nodejsUtils");function c(e){return new n.Promise(function(t,r){var a=e.decompressed.getContentWorker().pipe(new s);a.on("error",function(e){r(e)}).on("end",function(){a.streamInfo.crc32!==e.decompressed.crc32?r(new Error("Corrupted zip : CRC32 mismatch")):t()}).resume()})}t.exports=function(e,t){var r=this;return t=a.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:i.utf8decode}),l.isNode&&l.isStream(e)?n.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):a.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then(function(e){var r=new o(t);return r.load(e),r}).then(function(e){var r=[n.Promise.resolve(e)],a=e.files;if(t.checkCRC32)for(var i=0;i<a.length;i++)r.push(c(a[i]));return n.Promise.all(r)}).then(function(e){for(var n=e.shift(),i=n.files,o=0;o<i.length;o++){var s=i[o],l=s.fileNameStr,c=a.resolve(s.fileNameStr);r.file(c,s.decompressed,{binary:!0,optimizedBinaryString:!0,date:s.date,dir:s.dir,comment:s.fileCommentStr.length?s.fileCommentStr:null,unixPermissions:s.unixPermissions,dosPermissions:s.dosPermissions,createFolders:t.createFolders}),s.dir||(r.file(c).unsafeOriginalName=l)}return n.zipComment.length&&(r.comment=n.zipComment),r})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,r){"use strict";var a=e("../utils"),n=e("../stream/GenericWorker");function i(e,t){n.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}a.inherits(i,n),i.prototype._bindStream=function(e){var t=this;(this._stream=e).pause(),e.on("data",function(e){t.push({data:e,meta:{percent:0}})}).on("error",function(e){t.isPaused?this.generatedError=e:t.error(e)}).on("end",function(){t.isPaused?t._upstreamEnded=!0:t.end()})},i.prototype.pause=function(){return!!n.prototype.pause.call(this)&&(this._stream.pause(),!0)},i.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=i},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,r){"use strict";var a=e("readable-stream").Readable;function n(e,t,r){a.call(this,t),this._helper=e;var n=this;e.on("data",function(e,t){n.push(e)||n._helper.pause(),r&&r(t)}).on("error",function(e){n.emit("error",e)}).on("end",function(){n.push(null)})}e("../utils").inherits(n,a),n.prototype._read=function(){this._helper.resume()},t.exports=n},{"../utils":32,"readable-stream":16}],14:[function(e,t,r){"use strict";t.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,r){"use strict";function a(e,t,r){var a,n=i.getTypeOf(t),s=i.extend(r||{},l);s.date=s.date||new Date,null!==s.compression&&(s.compression=s.compression.toUpperCase()),"string"==typeof s.unixPermissions&&(s.unixPermissions=parseInt(s.unixPermissions,8)),s.unixPermissions&&16384&s.unixPermissions&&(s.dir=!0),s.dosPermissions&&16&s.dosPermissions&&(s.dir=!0),s.dir&&(e=g(e)),s.createFolders&&(a=p(e))&&m.call(this,a,!0);var h,y="string"===n&&!1===s.binary&&!1===s.base64;r&&void 0!==r.binary||(s.binary=!y),(t instanceof c&&0===t.uncompressedSize||s.dir||!t||0===t.length)&&(s.base64=!1,s.binary=!0,t="",s.compression="STORE",n="string"),h=t instanceof c||t instanceof o?t:d.isNode&&d.isStream(t)?new f(e,t):i.prepareContent(e,t,s.binary,s.optimizedBinaryString,s.base64);var v=new u(e,h,s);this.files[e]=v}var n=e("./utf8"),i=e("./utils"),o=e("./stream/GenericWorker"),s=e("./stream/StreamHelper"),l=e("./defaults"),c=e("./compressedObject"),u=e("./zipObject"),h=e("./generate"),d=e("./nodejsUtils"),f=e("./nodejs/NodejsStreamInputAdapter"),p=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""},g=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},m=function(e,t){return t=void 0!==t?t:l.createFolders,e=g(e),this.files[e]||a.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function y(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var v={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,r,a;for(t in this.files)a=this.files[t],(r=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(r,a)},filter:function(e){var t=[];return this.forEach(function(r,a){e(r,a)&&t.push(a)}),t},file:function(e,t,r){if(1!==arguments.length)return e=this.root+e,a.call(this,e,t,r),this;if(y(e)){var n=e;return this.filter(function(e,t){return!t.dir&&n.test(e)})}var i=this.files[this.root+e];return i&&!i.dir?i:null},folder:function(e){if(!e)return this;if(y(e))return this.filter(function(t,r){return r.dir&&e.test(t)});var t=this.root+e,r=m.call(this,t),a=this.clone();return a.root=r.name,a},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var r=this.filter(function(t,r){return r.name.slice(0,e.length)===e}),a=0;a<r.length;a++)delete this.files[r[a].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,r={};try{if((r=i.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:n.utf8encode})).type=r.type.toLowerCase(),r.compression=r.compression.toUpperCase(),"binarystring"===r.type&&(r.type="string"),!r.type)throw new Error("No output type specified.");i.checkSupport(r.type),"darwin"!==r.platform&&"freebsd"!==r.platform&&"linux"!==r.platform&&"sunos"!==r.platform||(r.platform="UNIX"),"win32"===r.platform&&(r.platform="DOS");var a=r.comment||this.comment||"";t=h.generateWorker(this,r,a)}catch(e){(t=new o("error")).error(e)}return new s(t,r.type||"string",r.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=v},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,r){"use strict";t.exports=e("stream")},{stream:void 0}],17:[function(e,t,r){"use strict";var a=e("./DataReader");function n(e){a.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(n,a),n.prototype.byteAt=function(e){return this.data[this.zero+e]},n.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),r=e.charCodeAt(1),a=e.charCodeAt(2),n=e.charCodeAt(3),i=this.length-4;0<=i;--i)if(this.data[i]===t&&this.data[i+1]===r&&this.data[i+2]===a&&this.data[i+3]===n)return i-this.zero;return-1},n.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1),a=e.charCodeAt(2),n=e.charCodeAt(3),i=this.readData(4);return t===i[0]&&r===i[1]&&a===i[2]&&n===i[3]},n.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=n},{"../utils":32,"./DataReader":18}],18:[function(e,t,r){"use strict";var a=e("../utils");function n(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}n.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,r=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)r=(r<<8)+this.byteAt(t);return this.index+=e,r},readString:function(e){return a.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=n},{"../utils":32}],19:[function(e,t,r){"use strict";var a=e("./Uint8ArrayReader");function n(e){a.call(this,e)}e("../utils").inherits(n,a),n.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=n},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,r){"use strict";var a=e("./DataReader");function n(e){a.call(this,e)}e("../utils").inherits(n,a),n.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},n.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},n.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},n.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=n},{"../utils":32,"./DataReader":18}],21:[function(e,t,r){"use strict";var a=e("./ArrayReader");function n(e){a.call(this,e)}e("../utils").inherits(n,a),n.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=n},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,r){"use strict";var a=e("../utils"),n=e("../support"),i=e("./ArrayReader"),o=e("./StringReader"),s=e("./NodeBufferReader"),l=e("./Uint8ArrayReader");t.exports=function(e){var t=a.getTypeOf(e);return a.checkSupport(t),"string"!==t||n.uint8array?"nodebuffer"===t?new s(e):n.uint8array?new l(a.transformTo("uint8array",e)):new i(a.transformTo("array",e)):new o(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,r){"use strict";r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\b"},{}],24:[function(e,t,r){"use strict";var a=e("./GenericWorker"),n=e("../utils");function i(e){a.call(this,"ConvertWorker to "+e),this.destType=e}n.inherits(i,a),i.prototype.processChunk=function(e){this.push({data:n.transformTo(this.destType,e.data),meta:e.meta})},t.exports=i},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,r){"use strict";var a=e("./GenericWorker"),n=e("../crc32");function i(){a.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(i,a),i.prototype.processChunk=function(e){this.streamInfo.crc32=n(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=i},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,r){"use strict";var a=e("../utils"),n=e("./GenericWorker");function i(e){n.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}a.inherits(i,n),i.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}n.prototype.processChunk.call(this,e)},t.exports=i},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,r){"use strict";var a=e("../utils"),n=e("./GenericWorker");function i(e){n.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then(function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=a.getTypeOf(e),t.isPaused||t._tickAndRepeat()},function(e){t.error(e)})}a.inherits(i,n),i.prototype.cleanUp=function(){n.prototype.cleanUp.call(this),this.data=null},i.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,a.delay(this._tickAndRepeat,[],this)),!0)},i.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(a.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},i.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=i},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,r){"use strict";function a(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}a.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var r=0;r<this._listeners[e].length;r++)this._listeners[e][r].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.end()}),e.on("error",function(e){t.error(e)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=a},{}],29:[function(e,t,r){"use strict";var a=e("../utils"),n=e("./ConvertWorker"),i=e("./GenericWorker"),o=e("../base64"),s=e("../support"),l=e("../external"),c=null;if(s.nodestream)try{c=e("../nodejs/NodejsStreamOutputAdapter")}catch(e){}function u(e,t,r){var o=t;switch(t){case"blob":case"arraybuffer":o="uint8array";break;case"base64":o="string"}try{this._internalType=o,this._outputType=t,this._mimeType=r,a.checkSupport(o),this._worker=e.pipe(new n(o)),e.lock()}catch(e){this._worker=new i("error"),this._worker.error(e)}}u.prototype={accumulate:function(e){return function(e,t){return new l.Promise(function(r,n){var i=[],s=e._internalType,l=e._outputType,c=e._mimeType;e.on("data",function(e,r){i.push(e),t&&t(r)}).on("error",function(e){i=[],n(e)}).on("end",function(){try{var e=function(e,t,r){switch(e){case"blob":return a.newBlob(a.transformTo("arraybuffer",t),r);case"base64":return o.encode(t);default:return a.transformTo(e,t)}}(l,function(e,t){var r,a=0,n=null,i=0;for(r=0;r<t.length;r++)i+=t[r].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(n=new Uint8Array(i),r=0;r<t.length;r++)n.set(t[r],a),a+=t[r].length;return n;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(s,i),c);r(e)}catch(e){n(e)}i=[]}).resume()})}(this,e)},on:function(e,t){var r=this;return"data"===e?this._worker.on(e,function(e){t.call(r,e.data,e.meta)}):this._worker.on(e,function(){a.delay(t,arguments,r)}),this},resume:function(){return a.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(a.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new c(this,{objectMode:"nodebuffer"!==this._outputType},e)}},t.exports=u},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,r){"use strict";if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,r.nodebuffer="undefined"!=typeof Buffer,r.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)r.blob=!1;else{var a=new ArrayBuffer(0);try{r.blob=0===new Blob([a],{type:"application/zip"}).size}catch(e){try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);n.append(a),r.blob=0===n.getBlob("application/zip").size}catch(e){r.blob=!1}}}try{r.nodestream=!!e("readable-stream").Readable}catch(e){r.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,r){"use strict";for(var a=e("./utils"),n=e("./support"),i=e("./nodejsUtils"),o=e("./stream/GenericWorker"),s=new Array(256),l=0;l<256;l++)s[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function c(){o.call(this,"utf-8 decode"),this.leftOver=null}function u(){o.call(this,"utf-8 encode")}s[254]=s[254]=1,r.utf8encode=function(e){return n.nodebuffer?i.newBufferFrom(e,"utf-8"):function(e){var t,r,a,i,o,s=e.length,l=0;for(i=0;i<s;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<s&&56320==(64512&(a=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(a-56320),i++),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=n.uint8array?new Uint8Array(l):new Array(l),i=o=0;o<l;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<s&&56320==(64512&(a=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(a-56320),i++),r<128?t[o++]=r:(r<2048?t[o++]=192|r>>>6:(r<65536?t[o++]=224|r>>>12:(t[o++]=240|r>>>18,t[o++]=128|r>>>12&63),t[o++]=128|r>>>6&63),t[o++]=128|63&r);return t}(e)},r.utf8decode=function(e){return n.nodebuffer?a.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,r,n,i,o=e.length,l=new Array(2*o);for(t=r=0;t<o;)if((n=e[t++])<128)l[r++]=n;else if(4<(i=s[n]))l[r++]=65533,t+=i-1;else{for(n&=2===i?31:3===i?15:7;1<i&&t<o;)n=n<<6|63&e[t++],i--;1<i?l[r++]=65533:n<65536?l[r++]=n:(n-=65536,l[r++]=55296|n>>10&1023,l[r++]=56320|1023&n)}return l.length!==r&&(l.subarray?l=l.subarray(0,r):l.length=r),a.applyFromCharCode(l)}(e=a.transformTo(n.uint8array?"uint8array":"array",e))},a.inherits(c,o),c.prototype.processChunk=function(e){var t=a.transformTo(n.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(n.uint8array){var i=t;(t=new Uint8Array(i.length+this.leftOver.length)).set(this.leftOver,0),t.set(i,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var o=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;0<=r&&128==(192&e[r]);)r--;return r<0||0===r?t:r+s[e[r]]>t?r:t}(t),l=t;o!==t.length&&(n.uint8array?(l=t.subarray(0,o),this.leftOver=t.subarray(o,t.length)):(l=t.slice(0,o),this.leftOver=t.slice(o,t.length))),this.push({data:r.utf8decode(l),meta:e.meta})},c.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:r.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},r.Utf8DecodeWorker=c,a.inherits(u,o),u.prototype.processChunk=function(e){this.push({data:r.utf8encode(e.data),meta:e.meta})},r.Utf8EncodeWorker=u},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,r){"use strict";var a=e("./support"),n=e("./base64"),i=e("./nodejsUtils"),o=e("./external");function s(e){return e}function l(e,t){for(var r=0;r<e.length;++r)t[r]=255&e.charCodeAt(r);return t}e("setimmediate"),r.newBlob=function(e,t){r.checkSupport("blob");try{return new Blob([e],{type:t})}catch(r){try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return a.append(e),a.getBlob(t)}catch(e){throw new Error("Bug : can't construct the Blob.")}}};var c={stringifyByChunk:function(e,t,r){var a=[],n=0,i=e.length;if(i<=r)return String.fromCharCode.apply(null,e);for(;n<i;)"array"===t||"nodebuffer"===t?a.push(String.fromCharCode.apply(null,e.slice(n,Math.min(n+r,i)))):a.push(String.fromCharCode.apply(null,e.subarray(n,Math.min(n+r,i)))),n+=r;return a.join("")},stringifyByChar:function(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},applyCanBeUsed:{uint8array:function(){try{return a.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return a.nodebuffer&&1===String.fromCharCode.apply(null,i.allocBuffer(1)).length}catch(e){return!1}}()}};function u(e){var t=65536,a=r.getTypeOf(e),n=!0;if("uint8array"===a?n=c.applyCanBeUsed.uint8array:"nodebuffer"===a&&(n=c.applyCanBeUsed.nodebuffer),n)for(;1<t;)try{return c.stringifyByChunk(e,a,t)}catch(e){t=Math.floor(t/2)}return c.stringifyByChar(e)}function h(e,t){for(var r=0;r<e.length;r++)t[r]=e[r];return t}r.applyFromCharCode=u;var d={};d.string={string:s,array:function(e){return l(e,new Array(e.length))},arraybuffer:function(e){return d.string.uint8array(e).buffer},uint8array:function(e){return l(e,new Uint8Array(e.length))},nodebuffer:function(e){return l(e,i.allocBuffer(e.length))}},d.array={string:u,array:s,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return i.newBufferFrom(e)}},d.arraybuffer={string:function(e){return u(new Uint8Array(e))},array:function(e){return h(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:s,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return i.newBufferFrom(new Uint8Array(e))}},d.uint8array={string:u,array:function(e){return h(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:s,nodebuffer:function(e){return i.newBufferFrom(e)}},d.nodebuffer={string:u,array:function(e){return h(e,new Array(e.length))},arraybuffer:function(e){return d.nodebuffer.uint8array(e).buffer},uint8array:function(e){return h(e,new Uint8Array(e.length))},nodebuffer:s},r.transformTo=function(e,t){if(t=t||"",!e)return t;r.checkSupport(e);var a=r.getTypeOf(t);return d[a][e](t)},r.resolve=function(e){for(var t=e.split("/"),r=[],a=0;a<t.length;a++){var n=t[a];"."===n||""===n&&0!==a&&a!==t.length-1||(".."===n?r.pop():r.push(n))}return r.join("/")},r.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":a.nodebuffer&&i.isBuffer(e)?"nodebuffer":a.uint8array&&e instanceof Uint8Array?"uint8array":a.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},r.checkSupport=function(e){if(!a[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(e){var t,r,a="";for(r=0;r<(e||"").length;r++)a+="\\x"+((t=e.charCodeAt(r))<16?"0":"")+t.toString(16).toUpperCase();return a},r.delay=function(e,t,r){setImmediate(function(){e.apply(r||null,t||[])})},r.inherits=function(e,t){function r(){}r.prototype=t.prototype,e.prototype=new r},r.extend=function(){var e,t,r={};for(e=0;e<arguments.length;e++)for(t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&void 0===r[t]&&(r[t]=arguments[e][t]);return r},r.prepareContent=function(e,t,i,s,c){return o.Promise.resolve(t).then(function(e){return a.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new o.Promise(function(t,r){var a=new FileReader;a.onload=function(e){t(e.target.result)},a.onerror=function(e){r(e.target.error)},a.readAsArrayBuffer(e)}):e}).then(function(t){var u=r.getTypeOf(t);return u?("arraybuffer"===u?t=r.transformTo("uint8array",t):"string"===u&&(c?t=n.decode(t):i&&!0!==s&&(t=function(e){return l(e,a.uint8array?new Uint8Array(e.length):new Array(e.length))}(t))),t):o.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,t,r){"use strict";var a=e("./reader/readerFor"),n=e("./utils"),i=e("./signature"),o=e("./zipEntry"),s=e("./support");function l(e){this.files=[],this.loadOptions=e}l.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+n.pretty(t)+", expected "+n.pretty(e)+")")}},isSignature:function(e,t){var r=this.reader.index;this.reader.setIndex(e);var a=this.reader.readString(4)===t;return this.reader.setIndex(r),a},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=s.uint8array?"uint8array":"array",r=n.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(r)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,r,a=this.zip64EndOfCentralSize-44;0<a;)e=this.reader.readInt(2),t=this.reader.readInt(4),r=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(i.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(i.CENTRAL_FILE_HEADER);)(e=new o({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(i.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,i.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(i.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===n.MAX_VALUE_16BITS||this.diskWithCentralDirStart===n.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===n.MAX_VALUE_16BITS||this.centralDirRecords===n.MAX_VALUE_16BITS||this.centralDirSize===n.MAX_VALUE_32BITS||this.centralDirOffset===n.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(i.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(i.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,i.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(i.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(i.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var r=this.centralDirOffset+this.centralDirSize;this.zip64&&(r+=20,r+=12+this.zip64EndOfCentralSize);var a=t-r;if(0<a)this.isSignature(t,i.CENTRAL_FILE_HEADER)||(this.reader.zero=a);else if(a<0)throw new Error("Corrupted zip: missing "+Math.abs(a)+" bytes.")},prepareReader:function(e){this.reader=a(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=l},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,t,r){"use strict";var a=e("./reader/readerFor"),n=e("./utils"),i=e("./compressedObject"),o=e("./crc32"),s=e("./utf8"),l=e("./compressions"),c=e("./support");function u(e,t){this.options=e,this.loadOptions=t}u.prototype={isEncrypted:function(){return!(1&~this.bitFlag)},useUTF8:function(){return!(2048&~this.bitFlag)},readLocalPart:function(e){var t,r;if(e.skip(22),this.fileNameLength=e.readInt(2),r=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(r),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in l)if(Object.prototype.hasOwnProperty.call(l,t)&&l[t].magic===e)return l[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+n.pretty(this.compressionMethod)+" unknown (inner file : "+n.transformTo("string",this.fileName)+")");this.decompressed=new i(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=a(this.extraFields[1].value);this.uncompressedSize===n.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===n.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===n.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===n.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t,r,a,n=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<n;)t=e.readInt(2),r=e.readInt(2),a=e.readData(r),this.extraFields[t]={id:t,length:r,value:a};e.setIndex(n)},handleUTF8:function(){var e=c.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=s.utf8decode(this.fileName),this.fileCommentStr=s.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var r=n.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(r)}var a=this.findExtraFieldUnicodeComment();if(null!==a)this.fileCommentStr=a;else{var i=n.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(i)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=a(e.value);return 1!==t.readInt(1)||o(this.fileName)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=a(e.value);return 1!==t.readInt(1)||o(this.fileComment)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null}},t.exports=u},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,r){"use strict";function a(e,t,r){this.name=e,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=t,this._dataBinary=r.binary,this.options={compression:r.compression,compressionOptions:r.compressionOptions}}var n=e("./stream/StreamHelper"),i=e("./stream/DataWorker"),o=e("./utf8"),s=e("./compressedObject"),l=e("./stream/GenericWorker");a.prototype={internalStream:function(e){var t=null,r="string";try{if(!e)throw new Error("No output type specified.");var a="string"===(r=e.toLowerCase())||"text"===r;"binarystring"!==r&&"text"!==r||(r="string"),t=this._decompressWorker();var i=!this._dataBinary;i&&!a&&(t=t.pipe(new o.Utf8EncodeWorker)),!i&&a&&(t=t.pipe(new o.Utf8DecodeWorker))}catch(e){(t=new l("error")).error(e)}return new n(t,r,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof s&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var r=this._decompressWorker();return this._dataBinary||(r=r.pipe(new o.Utf8EncodeWorker)),s.createWorkerFrom(r,e,t)},_decompressWorker:function(){return this._data instanceof s?this._data.getContentWorker():this._data instanceof l?this._data:new i(this._data)}};for(var c=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],u=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},h=0;h<c.length;h++)a.prototype[c[h]]=u;t.exports=a},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,r){(function(e){"use strict";var r,a,n=e.MutationObserver||e.WebKitMutationObserver;if(n){var i=0,o=new n(u),s=e.document.createTextNode("");o.observe(s,{characterData:!0}),r=function(){s.data=i=++i%2}}else if(e.setImmediate||void 0===e.MessageChannel)r="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){u(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(u,0)};else{var l=new e.MessageChannel;l.port1.onmessage=u,r=function(){l.port2.postMessage(0)}}var c=[];function u(){var e,t;a=!0;for(var r=c.length;r;){for(t=c,c=[],e=-1;++e<r;)t[e]();r=c.length}a=!1}t.exports=function(e){1!==c.push(e)||a||r()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,r){"use strict";var a=e("immediate");function n(){}var i={},o=["REJECTED"],s=["FULFILLED"],l=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==n&&f(this,e)}function u(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function h(e,t,r){a(function(){var a;try{a=t(r)}catch(a){return i.reject(e,a)}a===e?i.reject(e,new TypeError("Cannot resolve promise with itself")):i.resolve(e,a)})}function d(e){var t=e&&e.then;if(e&&("object"==_typeof(e)||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function f(e,t){var r=!1;function a(t){r||(r=!0,i.reject(e,t))}function n(t){r||(r=!0,i.resolve(e,t))}var o=p(function(){t(n,a)});"error"===o.status&&a(o.value)}function p(e,t){var r={};try{r.value=e(t),r.status="success"}catch(e){r.status="error",r.value=e}return r}(t.exports=c).prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then(function(r){return t.resolve(e()).then(function(){return r})},function(r){return t.resolve(e()).then(function(){throw r})})},c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===o)return this;var r=new this.constructor(n);return this.state!==l?h(r,this.state===s?e:t,this.outcome):this.queue.push(new u(r,e,t)),r},u.prototype.callFulfilled=function(e){i.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){h(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){i.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){h(this.promise,this.onRejected,e)},i.resolve=function(e,t){var r=p(d,t);if("error"===r.status)return i.reject(e,r.value);var a=r.value;if(a)f(e,a);else{e.state=s,e.outcome=t;for(var n=-1,o=e.queue.length;++n<o;)e.queue[n].callFulfilled(t)}return e},i.reject=function(e,t){e.state=o,e.outcome=t;for(var r=-1,a=e.queue.length;++r<a;)e.queue[r].callRejected(t);return e},c.resolve=function(e){return e instanceof this?e:i.resolve(new this(n),e)},c.reject=function(e){var t=new this(n);return i.reject(t,e)},c.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,a=!1;if(!r)return this.resolve([]);for(var o=new Array(r),s=0,l=-1,c=new this(n);++l<r;)u(e[l],l);return c;function u(e,n){t.resolve(e).then(function(e){o[n]=e,++s!==r||a||(a=!0,i.resolve(c,o))},function(e){a||(a=!0,i.reject(c,e))})}},c.race=function(e){if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var t=e.length,r=!1;if(!t)return this.resolve([]);for(var a,o=-1,s=new this(n);++o<t;)a=e[o],this.resolve(a).then(function(e){r||(r=!0,i.resolve(s,e))},function(e){r||(r=!0,i.reject(s,e))});return s}},{immediate:36}],38:[function(e,t,r){"use strict";var a={};(0,e("./lib/utils/common").assign)(a,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=a},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,r){"use strict";var a=e("./zlib/deflate"),n=e("./utils/common"),i=e("./utils/strings"),o=e("./zlib/messages"),s=e("./zlib/zstream"),l=Object.prototype.toString;function c(e){if(!(this instanceof c))return new c(e);this.options=n.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var r=a.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(0!==r)throw new Error(o[r]);if(t.header&&a.deflateSetHeader(this.strm,t.header),t.dictionary){var u;if(u="string"==typeof t.dictionary?i.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,0!==(r=a.deflateSetDictionary(this.strm,u)))throw new Error(o[r]);this._dict_set=!0}}function u(e,t){var r=new c(t);if(r.push(e,!0),r.err)throw r.msg||o[r.err];return r.result}c.prototype.push=function(e,t){var r,o,s=this.strm,c=this.options.chunkSize;if(this.ended)return!1;o=t===~~t?t:!0===t?4:0,"string"==typeof e?s.input=i.string2buf(e):"[object ArrayBuffer]"===l.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new n.Buf8(c),s.next_out=0,s.avail_out=c),1!==(r=a.deflate(s,o))&&0!==r)return this.onEnd(r),!(this.ended=!0);0!==s.avail_out&&(0!==s.avail_in||4!==o&&2!==o)||("string"===this.options.to?this.onData(i.buf2binstring(n.shrinkBuf(s.output,s.next_out))):this.onData(n.shrinkBuf(s.output,s.next_out)))}while((0<s.avail_in||0===s.avail_out)&&1!==r);return 4===o?(r=a.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,0===r):2!==o||(this.onEnd(0),!(s.avail_out=0))},c.prototype.onData=function(e){this.chunks.push(e)},c.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},r.Deflate=c,r.deflate=u,r.deflateRaw=function(e,t){return(t=t||{}).raw=!0,u(e,t)},r.gzip=function(e,t){return(t=t||{}).gzip=!0,u(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,r){"use strict";var a=e("./zlib/inflate"),n=e("./utils/common"),i=e("./utils/strings"),o=e("./zlib/constants"),s=e("./zlib/messages"),l=e("./zlib/zstream"),c=e("./zlib/gzheader"),u=Object.prototype.toString;function h(e){if(!(this instanceof h))return new h(e);this.options=n.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&!(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var r=a.inflateInit2(this.strm,t.windowBits);if(r!==o.Z_OK)throw new Error(s[r]);this.header=new c,a.inflateGetHeader(this.strm,this.header)}function d(e,t){var r=new h(t);if(r.push(e,!0),r.err)throw r.msg||s[r.err];return r.result}h.prototype.push=function(e,t){var r,s,l,c,h,d,f=this.strm,p=this.options.chunkSize,g=this.options.dictionary,m=!1;if(this.ended)return!1;s=t===~~t?t:!0===t?o.Z_FINISH:o.Z_NO_FLUSH,"string"==typeof e?f.input=i.binstring2buf(e):"[object ArrayBuffer]"===u.call(e)?f.input=new Uint8Array(e):f.input=e,f.next_in=0,f.avail_in=f.input.length;do{if(0===f.avail_out&&(f.output=new n.Buf8(p),f.next_out=0,f.avail_out=p),(r=a.inflate(f,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&g&&(d="string"==typeof g?i.string2buf(g):"[object ArrayBuffer]"===u.call(g)?new Uint8Array(g):g,r=a.inflateSetDictionary(this.strm,d)),r===o.Z_BUF_ERROR&&!0===m&&(r=o.Z_OK,m=!1),r!==o.Z_STREAM_END&&r!==o.Z_OK)return this.onEnd(r),!(this.ended=!0);f.next_out&&(0!==f.avail_out&&r!==o.Z_STREAM_END&&(0!==f.avail_in||s!==o.Z_FINISH&&s!==o.Z_SYNC_FLUSH)||("string"===this.options.to?(l=i.utf8border(f.output,f.next_out),c=f.next_out-l,h=i.buf2string(f.output,l),f.next_out=c,f.avail_out=p-c,c&&n.arraySet(f.output,f.output,l,c,0),this.onData(h)):this.onData(n.shrinkBuf(f.output,f.next_out)))),0===f.avail_in&&0===f.avail_out&&(m=!0)}while((0<f.avail_in||0===f.avail_out)&&r!==o.Z_STREAM_END);return r===o.Z_STREAM_END&&(s=o.Z_FINISH),s===o.Z_FINISH?(r=a.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===o.Z_OK):s!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),!(f.avail_out=0))},h.prototype.onData=function(e){this.chunks.push(e)},h.prototype.onEnd=function(e){e===o.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},r.Inflate=h,r.inflate=d,r.inflateRaw=function(e,t){return(t=t||{}).raw=!0,d(e,t)},r.ungzip=d},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,r){"use strict";var a="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;r.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!=_typeof(r))throw new TypeError(r+"must be non-object");for(var a in r)r.hasOwnProperty(a)&&(e[a]=r[a])}}return e},r.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var n={arraySet:function(e,t,r,a,n){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+a),n);else for(var i=0;i<a;i++)e[n+i]=t[r+i]},flattenChunks:function(e){var t,r,a,n,i,o;for(t=a=0,r=e.length;t<r;t++)a+=e[t].length;for(o=new Uint8Array(a),t=n=0,r=e.length;t<r;t++)i=e[t],o.set(i,n),n+=i.length;return o}},i={arraySet:function(e,t,r,a,n){for(var i=0;i<a;i++)e[n+i]=t[r+i]},flattenChunks:function(e){return[].concat.apply([],e)}};r.setTyped=function(e){e?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,n)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,i))},r.setTyped(a)},{}],42:[function(e,t,r){"use strict";var a=e("./common"),n=!0,i=!0;try{String.fromCharCode.apply(null,[0])}catch(e){n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){i=!1}for(var o=new a.Buf8(256),s=0;s<256;s++)o[s]=252<=s?6:248<=s?5:240<=s?4:224<=s?3:192<=s?2:1;function l(e,t){if(t<65537&&(e.subarray&&i||!e.subarray&&n))return String.fromCharCode.apply(null,a.shrinkBuf(e,t));for(var r="",o=0;o<t;o++)r+=String.fromCharCode(e[o]);return r}o[254]=o[254]=1,r.string2buf=function(e){var t,r,n,i,o,s=e.length,l=0;for(i=0;i<s;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<s&&56320==(64512&(n=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=new a.Buf8(l),i=o=0;o<l;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<s&&56320==(64512&(n=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),r<128?t[o++]=r:(r<2048?t[o++]=192|r>>>6:(r<65536?t[o++]=224|r>>>12:(t[o++]=240|r>>>18,t[o++]=128|r>>>12&63),t[o++]=128|r>>>6&63),t[o++]=128|63&r);return t},r.buf2binstring=function(e){return l(e,e.length)},r.binstring2buf=function(e){for(var t=new a.Buf8(e.length),r=0,n=t.length;r<n;r++)t[r]=e.charCodeAt(r);return t},r.buf2string=function(e,t){var r,a,n,i,s=t||e.length,c=new Array(2*s);for(r=a=0;r<s;)if((n=e[r++])<128)c[a++]=n;else if(4<(i=o[n]))c[a++]=65533,r+=i-1;else{for(n&=2===i?31:3===i?15:7;1<i&&r<s;)n=n<<6|63&e[r++],i--;1<i?c[a++]=65533:n<65536?c[a++]=n:(n-=65536,c[a++]=55296|n>>10&1023,c[a++]=56320|1023&n)}return l(c,a)},r.utf8border=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;0<=r&&128==(192&e[r]);)r--;return r<0||0===r?t:r+o[e[r]]>t?r:t}},{"./common":41}],43:[function(e,t,r){"use strict";t.exports=function(e,t,r,a){for(var n=65535&e,i=e>>>16&65535,o=0;0!==r;){for(r-=o=2e3<r?2e3:r;i=i+(n=n+t[a++]|0)|0,--o;);n%=65521,i%=65521}return n|i<<16}},{}],44:[function(e,t,r){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,r){"use strict";var a=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var a=0;a<8;a++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();t.exports=function(e,t,r,n){var i=a,o=n+r;e^=-1;for(var s=n;s<o;s++)e=e>>>8^i[255&(e^t[s])];return-1^e}},{}],46:[function(e,t,r){"use strict";var a,n=e("../utils/common"),i=e("./trees"),o=e("./adler32"),s=e("./crc32"),l=e("./messages"),c=-2,u=258,h=262,d=113;function f(e,t){return e.msg=l[t],t}function p(e){return(e<<1)-(4<e?9:0)}function g(e){for(var t=e.length;0<=--t;)e[t]=0}function m(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(n.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function y(e,t){i._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,m(e.strm)}function v(e,t){e.pending_buf[e.pending++]=t}function b(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function x(e,t){var r,a,n=e.max_chain_length,i=e.strstart,o=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-h?e.strstart-(e.w_size-h):0,c=e.window,d=e.w_mask,f=e.prev,p=e.strstart+u,g=c[i+o-1],m=c[i+o];e.prev_length>=e.good_match&&(n>>=2),s>e.lookahead&&(s=e.lookahead);do{if(c[(r=t)+o]===m&&c[r+o-1]===g&&c[r]===c[i]&&c[++r]===c[i+1]){i+=2,r++;do{}while(c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&i<p);if(a=u-(p-i),i=p-u,o<a){if(e.match_start=t,s<=(o=a))break;g=c[i+o-1],m=c[i+o]}}}while((t=f[t&d])>l&&0!=--n);return o<=e.lookahead?o:e.lookahead}function _(e){var t,r,a,i,l,c,u,d,f,p,g=e.w_size;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=g+(g-h)){for(n.arraySet(e.window,e.window,g,g,0),e.match_start-=g,e.strstart-=g,e.block_start-=g,t=r=e.hash_size;a=e.head[--t],e.head[t]=g<=a?a-g:0,--r;);for(t=r=g;a=e.prev[--t],e.prev[t]=g<=a?a-g:0,--r;);i+=g}if(0===e.strm.avail_in)break;if(c=e.strm,u=e.window,d=e.strstart+e.lookahead,p=void 0,(f=i)<(p=c.avail_in)&&(p=f),r=0===p?0:(c.avail_in-=p,n.arraySet(u,c.input,c.next_in,p,d),1===c.state.wrap?c.adler=o(c.adler,u,p,d):2===c.state.wrap&&(c.adler=s(c.adler,u,p,d)),c.next_in+=p,c.total_in+=p,p),e.lookahead+=r,e.lookahead+e.insert>=3)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+3-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<h&&0!==e.strm.avail_in)}function E(e,t){for(var r,a;;){if(e.lookahead<h){if(_(e),e.lookahead<h&&0===t)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-h&&(e.match_length=x(e,r)),e.match_length>=3)if(a=i._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else a=i._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(a&&(y(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(y(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(y(e,!1),0===e.strm.avail_out)?1:2}function w(e,t){for(var r,a,n;;){if(e.lookahead<h){if(_(e),e.lookahead<h&&0===t)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-h&&(e.match_length=x(e,r),e.match_length<=5&&(1===e.strategy||3===e.match_length&&4096<e.strstart-e.match_start)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){for(n=e.strstart+e.lookahead-3,a=i._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=n&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=2,e.strstart++,a&&(y(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((a=i._tr_tally(e,0,e.window[e.strstart-1]))&&y(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(a=i._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(y(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(y(e,!1),0===e.strm.avail_out)?1:2}function k(e,t,r,a,n){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=a,this.func=n}function T(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(1146),this.dyn_dtree=new n.Buf16(122),this.bl_tree=new n.Buf16(78),g(this.dyn_ltree),g(this.dyn_dtree),g(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(16),this.heap=new n.Buf16(573),g(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(573),g(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function S(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:d,e.adler=2===t.wrap?0:1,t.last_flush=0,i._tr_init(t),0):f(e,c)}function A(e){var t=S(e);return 0===t&&function(e){e.window_size=2*e.w_size,g(e.head),e.max_lazy_match=a[e.level].max_lazy,e.good_match=a[e.level].good_length,e.nice_match=a[e.level].nice_length,e.max_chain_length=a[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0}(e.state),t}function I(e,t,r,a,i,o){if(!e)return c;var s=1;if(-1===t&&(t=6),a<0?(s=0,a=-a):15<a&&(s=2,a-=16),i<1||9<i||8!==r||a<8||15<a||t<0||9<t||o<0||4<o)return f(e,c);8===a&&(a=9);var l=new T;return(e.state=l).strm=e,l.wrap=s,l.gzhead=null,l.w_bits=a,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=i+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new n.Buf8(2*l.w_size),l.head=new n.Buf16(l.hash_size),l.prev=new n.Buf16(l.w_size),l.lit_bufsize=1<<i+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new n.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=o,l.method=r,A(e)}a=[new k(0,0,0,0,function(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(_(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var a=e.block_start+r;if((0===e.strstart||e.strstart>=a)&&(e.lookahead=e.strstart-a,e.strstart=a,y(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-h&&(y(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(y(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(y(e,!1),e.strm.avail_out),1)}),new k(4,4,8,4,E),new k(4,5,16,8,E),new k(4,6,32,32,E),new k(4,4,16,16,w),new k(8,16,32,32,w),new k(8,16,128,128,w),new k(8,32,128,256,w),new k(32,128,258,1024,w),new k(32,258,258,4096,w)],r.deflateInit=function(e,t){return I(e,t,8,15,8,0)},r.deflateInit2=I,r.deflateReset=A,r.deflateResetKeep=S,r.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?c:(e.state.gzhead=t,0):c},r.deflate=function(e,t){var r,n,o,l;if(!e||!e.state||5<t||t<0)return e?f(e,c):c;if(n=e.state,!e.output||!e.input&&0!==e.avail_in||666===n.status&&4!==t)return f(e,0===e.avail_out?-5:c);if(n.strm=e,r=n.last_flush,n.last_flush=t,42===n.status)if(2===n.wrap)e.adler=0,v(n,31),v(n,139),v(n,8),n.gzhead?(v(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),v(n,255&n.gzhead.time),v(n,n.gzhead.time>>8&255),v(n,n.gzhead.time>>16&255),v(n,n.gzhead.time>>24&255),v(n,9===n.level?2:2<=n.strategy||n.level<2?4:0),v(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(v(n,255&n.gzhead.extra.length),v(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=s(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(v(n,0),v(n,0),v(n,0),v(n,0),v(n,0),v(n,9===n.level?2:2<=n.strategy||n.level<2?4:0),v(n,3),n.status=d);else{var h=8+(n.w_bits-8<<4)<<8;h|=(2<=n.strategy||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(h|=32),h+=31-h%31,n.status=d,b(n,h),0!==n.strstart&&(b(n,e.adler>>>16),b(n,65535&e.adler)),e.adler=1}if(69===n.status)if(n.gzhead.extra){for(o=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>o&&(e.adler=s(e.adler,n.pending_buf,n.pending-o,o)),m(e),o=n.pending,n.pending!==n.pending_buf_size));)v(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>o&&(e.adler=s(e.adler,n.pending_buf,n.pending-o,o)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(73===n.status)if(n.gzhead.name){o=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>o&&(e.adler=s(e.adler,n.pending_buf,n.pending-o,o)),m(e),o=n.pending,n.pending===n.pending_buf_size)){l=1;break}l=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,v(n,l)}while(0!==l);n.gzhead.hcrc&&n.pending>o&&(e.adler=s(e.adler,n.pending_buf,n.pending-o,o)),0===l&&(n.gzindex=0,n.status=91)}else n.status=91;if(91===n.status)if(n.gzhead.comment){o=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>o&&(e.adler=s(e.adler,n.pending_buf,n.pending-o,o)),m(e),o=n.pending,n.pending===n.pending_buf_size)){l=1;break}l=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,v(n,l)}while(0!==l);n.gzhead.hcrc&&n.pending>o&&(e.adler=s(e.adler,n.pending_buf,n.pending-o,o)),0===l&&(n.status=103)}else n.status=103;if(103===n.status&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&m(e),n.pending+2<=n.pending_buf_size&&(v(n,255&e.adler),v(n,e.adler>>8&255),e.adler=0,n.status=d)):n.status=d),0!==n.pending){if(m(e),0===e.avail_out)return n.last_flush=-1,0}else if(0===e.avail_in&&p(t)<=p(r)&&4!==t)return f(e,-5);if(666===n.status&&0!==e.avail_in)return f(e,-5);if(0!==e.avail_in||0!==n.lookahead||0!==t&&666!==n.status){var x=2===n.strategy?function(e,t){for(var r;;){if(0===e.lookahead&&(_(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,r=i._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(y(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(y(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(y(e,!1),0===e.strm.avail_out)?1:2}(n,t):3===n.strategy?function(e,t){for(var r,a,n,o,s=e.window;;){if(e.lookahead<=u){if(_(e),e.lookahead<=u&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&0<e.strstart&&(a=s[n=e.strstart-1])===s[++n]&&a===s[++n]&&a===s[++n]){o=e.strstart+u;do{}while(a===s[++n]&&a===s[++n]&&a===s[++n]&&a===s[++n]&&a===s[++n]&&a===s[++n]&&a===s[++n]&&a===s[++n]&&n<o);e.match_length=u-(o-n),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(r=i._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=i._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(y(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(y(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(y(e,!1),0===e.strm.avail_out)?1:2}(n,t):a[n.level].func(n,t);if(3!==x&&4!==x||(n.status=666),1===x||3===x)return 0===e.avail_out&&(n.last_flush=-1),0;if(2===x&&(1===t?i._tr_align(n):5!==t&&(i._tr_stored_block(n,0,0,!1),3===t&&(g(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),m(e),0===e.avail_out))return n.last_flush=-1,0}return 4!==t?0:n.wrap<=0?1:(2===n.wrap?(v(n,255&e.adler),v(n,e.adler>>8&255),v(n,e.adler>>16&255),v(n,e.adler>>24&255),v(n,255&e.total_in),v(n,e.total_in>>8&255),v(n,e.total_in>>16&255),v(n,e.total_in>>24&255)):(b(n,e.adler>>>16),b(n,65535&e.adler)),m(e),0<n.wrap&&(n.wrap=-n.wrap),0!==n.pending?0:1)},r.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&103!==t&&t!==d&&666!==t?f(e,c):(e.state=null,t===d?f(e,-3):0):c},r.deflateSetDictionary=function(e,t){var r,a,i,s,l,u,h,d,f=t.length;if(!e||!e.state)return c;if(2===(s=(r=e.state).wrap)||1===s&&42!==r.status||r.lookahead)return c;for(1===s&&(e.adler=o(e.adler,t,f,0)),r.wrap=0,f>=r.w_size&&(0===s&&(g(r.head),r.strstart=0,r.block_start=0,r.insert=0),d=new n.Buf8(r.w_size),n.arraySet(d,t,f-r.w_size,r.w_size,0),t=d,f=r.w_size),l=e.avail_in,u=e.next_in,h=e.input,e.avail_in=f,e.next_in=0,e.input=t,_(r);r.lookahead>=3;){for(a=r.strstart,i=r.lookahead-2;r.ins_h=(r.ins_h<<r.hash_shift^r.window[a+3-1])&r.hash_mask,r.prev[a&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=a,a++,--i;);r.strstart=a,r.lookahead=2,_(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=u,e.input=h,e.avail_in=l,r.wrap=s,0},r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,r){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,r){"use strict";t.exports=function(e,t){var r,a,n,i,o,s,l,c,u,h,d,f,p,g,m,y,v,b,x,_,E,w,k,T,S;r=e.state,a=e.next_in,T=e.input,n=a+(e.avail_in-5),i=e.next_out,S=e.output,o=i-(t-e.avail_out),s=i+(e.avail_out-257),l=r.dmax,c=r.wsize,u=r.whave,h=r.wnext,d=r.window,f=r.hold,p=r.bits,g=r.lencode,m=r.distcode,y=(1<<r.lenbits)-1,v=(1<<r.distbits)-1;e:do{p<15&&(f+=T[a++]<<p,p+=8,f+=T[a++]<<p,p+=8),b=g[f&y];t:for(;;){if(f>>>=x=b>>>24,p-=x,0==(x=b>>>16&255))S[i++]=65535&b;else{if(!(16&x)){if(!(64&x)){b=g[(65535&b)+(f&(1<<x)-1)];continue t}if(32&x){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}_=65535&b,(x&=15)&&(p<x&&(f+=T[a++]<<p,p+=8),_+=f&(1<<x)-1,f>>>=x,p-=x),p<15&&(f+=T[a++]<<p,p+=8,f+=T[a++]<<p,p+=8),b=m[f&v];r:for(;;){if(f>>>=x=b>>>24,p-=x,!(16&(x=b>>>16&255))){if(!(64&x)){b=m[(65535&b)+(f&(1<<x)-1)];continue r}e.msg="invalid distance code",r.mode=30;break e}if(E=65535&b,p<(x&=15)&&(f+=T[a++]<<p,(p+=8)<x&&(f+=T[a++]<<p,p+=8)),l<(E+=f&(1<<x)-1)){e.msg="invalid distance too far back",r.mode=30;break e}if(f>>>=x,p-=x,(x=i-o)<E){if(u<(x=E-x)&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(k=d,(w=0)===h){if(w+=c-x,x<_){for(_-=x;S[i++]=d[w++],--x;);w=i-E,k=S}}else if(h<x){if(w+=c+h-x,(x-=h)<_){for(_-=x;S[i++]=d[w++],--x;);if(w=0,h<_){for(_-=x=h;S[i++]=d[w++],--x;);w=i-E,k=S}}}else if(w+=h-x,x<_){for(_-=x;S[i++]=d[w++],--x;);w=i-E,k=S}for(;2<_;)S[i++]=k[w++],S[i++]=k[w++],S[i++]=k[w++],_-=3;_&&(S[i++]=k[w++],1<_&&(S[i++]=k[w++]))}else{for(w=i-E;S[i++]=S[w++],S[i++]=S[w++],S[i++]=S[w++],2<(_-=3););_&&(S[i++]=S[w++],1<_&&(S[i++]=S[w++]))}break}}break}}while(a<n&&i<s);a-=_=p>>3,f&=(1<<(p-=_<<3))-1,e.next_in=a,e.next_out=i,e.avail_in=a<n?n-a+5:5-(a-n),e.avail_out=i<s?s-i+257:257-(i-s),r.hold=f,r.bits=p}},{}],49:[function(e,t,r){"use strict";var a=e("../utils/common"),n=e("./adler32"),i=e("./crc32"),o=e("./inffast"),s=e("./inftrees"),l=-2;function c(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function u(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new a.Buf16(320),this.work=new a.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function h(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new a.Buf32(852),t.distcode=t.distdyn=new a.Buf32(592),t.sane=1,t.back=-1,0):l}function d(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,h(e)):l}function f(e,t){var r,a;return e&&e.state?(a=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?l:(null!==a.window&&a.wbits!==t&&(a.window=null),a.wrap=r,a.wbits=t,d(e))):l}function p(e,t){var r,a;return e?(a=new u,(e.state=a).window=null,0!==(r=f(e,t))&&(e.state=null),r):l}var g,m,y=!0;function v(e){if(y){var t;for(g=new a.Buf32(512),m=new a.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(s(1,e.lens,0,288,g,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;s(2,e.lens,0,32,m,0,e.work,{bits:5}),y=!1}e.lencode=g,e.lenbits=9,e.distcode=m,e.distbits=5}function b(e,t,r,n){var i,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new a.Buf8(o.wsize)),n>=o.wsize?(a.arraySet(o.window,t,r-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(n<(i=o.wsize-o.wnext)&&(i=n),a.arraySet(o.window,t,r-n,i,o.wnext),(n-=i)?(a.arraySet(o.window,t,r-n,n,0),o.wnext=n,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0}r.inflateReset=d,r.inflateReset2=f,r.inflateResetKeep=h,r.inflateInit=function(e){return p(e,15)},r.inflateInit2=p,r.inflate=function(e,t){var r,u,h,d,f,p,g,m,y,x,_,E,w,k,T,S,A,I,C,B,N,P,F,M,L=0,z=new a.Buf8(4),D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return l;12===(r=e.state).mode&&(r.mode=13),f=e.next_out,h=e.output,g=e.avail_out,d=e.next_in,u=e.input,p=e.avail_in,m=r.hold,y=r.bits,x=p,_=g,P=0;e:for(;;)switch(r.mode){case 1:if(0===r.wrap){r.mode=13;break}for(;y<16;){if(0===p)break e;p--,m+=u[d++]<<y,y+=8}if(2&r.wrap&&35615===m){z[r.check=0]=255&m,z[1]=m>>>8&255,r.check=i(r.check,z,2,0),y=m=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&m)<<8)+(m>>8))%31){e.msg="incorrect header check",r.mode=30;break}if(8!=(15&m)){e.msg="unknown compression method",r.mode=30;break}if(y-=4,N=8+(15&(m>>>=4)),0===r.wbits)r.wbits=N;else if(N>r.wbits){e.msg="invalid window size",r.mode=30;break}r.dmax=1<<N,e.adler=r.check=1,r.mode=512&m?10:12,y=m=0;break;case 2:for(;y<16;){if(0===p)break e;p--,m+=u[d++]<<y,y+=8}if(r.flags=m,8!=(255&r.flags)){e.msg="unknown compression method",r.mode=30;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=30;break}r.head&&(r.head.text=m>>8&1),512&r.flags&&(z[0]=255&m,z[1]=m>>>8&255,r.check=i(r.check,z,2,0)),y=m=0,r.mode=3;case 3:for(;y<32;){if(0===p)break e;p--,m+=u[d++]<<y,y+=8}r.head&&(r.head.time=m),512&r.flags&&(z[0]=255&m,z[1]=m>>>8&255,z[2]=m>>>16&255,z[3]=m>>>24&255,r.check=i(r.check,z,4,0)),y=m=0,r.mode=4;case 4:for(;y<16;){if(0===p)break e;p--,m+=u[d++]<<y,y+=8}r.head&&(r.head.xflags=255&m,r.head.os=m>>8),512&r.flags&&(z[0]=255&m,z[1]=m>>>8&255,r.check=i(r.check,z,2,0)),y=m=0,r.mode=5;case 5:if(1024&r.flags){for(;y<16;){if(0===p)break e;p--,m+=u[d++]<<y,y+=8}r.length=m,r.head&&(r.head.extra_len=m),512&r.flags&&(z[0]=255&m,z[1]=m>>>8&255,r.check=i(r.check,z,2,0)),y=m=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&(p<(E=r.length)&&(E=p),E&&(r.head&&(N=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),a.arraySet(r.head.extra,u,d,E,N)),512&r.flags&&(r.check=i(r.check,u,E,d)),p-=E,d+=E,r.length-=E),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===p)break e;for(E=0;N=u[d+E++],r.head&&N&&r.length<65536&&(r.head.name+=String.fromCharCode(N)),N&&E<p;);if(512&r.flags&&(r.check=i(r.check,u,E,d)),p-=E,d+=E,N)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===p)break e;for(E=0;N=u[d+E++],r.head&&N&&r.length<65536&&(r.head.comment+=String.fromCharCode(N)),N&&E<p;);if(512&r.flags&&(r.check=i(r.check,u,E,d)),p-=E,d+=E,N)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;y<16;){if(0===p)break e;p--,m+=u[d++]<<y,y+=8}if(m!==(65535&r.check)){e.msg="header crc mismatch",r.mode=30;break}y=m=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=12;break;case 10:for(;y<32;){if(0===p)break e;p--,m+=u[d++]<<y,y+=8}e.adler=r.check=c(m),y=m=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=f,e.avail_out=g,e.next_in=d,e.avail_in=p,r.hold=m,r.bits=y,2;e.adler=r.check=1,r.mode=12;case 12:if(5===t||6===t)break e;case 13:if(r.last){m>>>=7&y,y-=7&y,r.mode=27;break}for(;y<3;){if(0===p)break e;p--,m+=u[d++]<<y,y+=8}switch(r.last=1&m,y-=1,3&(m>>>=1)){case 0:r.mode=14;break;case 1:if(v(r),r.mode=20,6!==t)break;m>>>=2,y-=2;break e;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=30}m>>>=2,y-=2;break;case 14:for(m>>>=7&y,y-=7&y;y<32;){if(0===p)break e;p--,m+=u[d++]<<y,y+=8}if((65535&m)!=(m>>>16^65535)){e.msg="invalid stored block lengths",r.mode=30;break}if(r.length=65535&m,y=m=0,r.mode=15,6===t)break e;case 15:r.mode=16;case 16:if(E=r.length){if(p<E&&(E=p),g<E&&(E=g),0===E)break e;a.arraySet(h,u,d,E,f),p-=E,d+=E,g-=E,f+=E,r.length-=E;break}r.mode=12;break;case 17:for(;y<14;){if(0===p)break e;p--,m+=u[d++]<<y,y+=8}if(r.nlen=257+(31&m),m>>>=5,y-=5,r.ndist=1+(31&m),m>>>=5,y-=5,r.ncode=4+(15&m),m>>>=4,y-=4,286<r.nlen||30<r.ndist){e.msg="too many length or distance symbols",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;y<3;){if(0===p)break e;p--,m+=u[d++]<<y,y+=8}r.lens[D[r.have++]]=7&m,m>>>=3,y-=3}for(;r.have<19;)r.lens[D[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,F={bits:r.lenbits},P=s(0,r.lens,0,19,r.lencode,0,r.work,F),r.lenbits=F.bits,P){e.msg="invalid code lengths set",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;S=(L=r.lencode[m&(1<<r.lenbits)-1])>>>16&255,A=65535&L,!((T=L>>>24)<=y);){if(0===p)break e;p--,m+=u[d++]<<y,y+=8}if(A<16)m>>>=T,y-=T,r.lens[r.have++]=A;else{if(16===A){for(M=T+2;y<M;){if(0===p)break e;p--,m+=u[d++]<<y,y+=8}if(m>>>=T,y-=T,0===r.have){e.msg="invalid bit length repeat",r.mode=30;break}N=r.lens[r.have-1],E=3+(3&m),m>>>=2,y-=2}else if(17===A){for(M=T+3;y<M;){if(0===p)break e;p--,m+=u[d++]<<y,y+=8}y-=T,N=0,E=3+(7&(m>>>=T)),m>>>=3,y-=3}else{for(M=T+7;y<M;){if(0===p)break e;p--,m+=u[d++]<<y,y+=8}y-=T,N=0,E=11+(127&(m>>>=T)),m>>>=7,y-=7}if(r.have+E>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=30;break}for(;E--;)r.lens[r.have++]=N}}if(30===r.mode)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=30;break}if(r.lenbits=9,F={bits:r.lenbits},P=s(1,r.lens,0,r.nlen,r.lencode,0,r.work,F),r.lenbits=F.bits,P){e.msg="invalid literal/lengths set",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,F={bits:r.distbits},P=s(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,F),r.distbits=F.bits,P){e.msg="invalid distances set",r.mode=30;break}if(r.mode=20,6===t)break e;case 20:r.mode=21;case 21:if(6<=p&&258<=g){e.next_out=f,e.avail_out=g,e.next_in=d,e.avail_in=p,r.hold=m,r.bits=y,o(e,_),f=e.next_out,h=e.output,g=e.avail_out,d=e.next_in,u=e.input,p=e.avail_in,m=r.hold,y=r.bits,12===r.mode&&(r.back=-1);break}for(r.back=0;S=(L=r.lencode[m&(1<<r.lenbits)-1])>>>16&255,A=65535&L,!((T=L>>>24)<=y);){if(0===p)break e;p--,m+=u[d++]<<y,y+=8}if(S&&!(240&S)){for(I=T,C=S,B=A;S=(L=r.lencode[B+((m&(1<<I+C)-1)>>I)])>>>16&255,A=65535&L,!(I+(T=L>>>24)<=y);){if(0===p)break e;p--,m+=u[d++]<<y,y+=8}m>>>=I,y-=I,r.back+=I}if(m>>>=T,y-=T,r.back+=T,r.length=A,0===S){r.mode=26;break}if(32&S){r.back=-1,r.mode=12;break}if(64&S){e.msg="invalid literal/length code",r.mode=30;break}r.extra=15&S,r.mode=22;case 22:if(r.extra){for(M=r.extra;y<M;){if(0===p)break e;p--,m+=u[d++]<<y,y+=8}r.length+=m&(1<<r.extra)-1,m>>>=r.extra,y-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;S=(L=r.distcode[m&(1<<r.distbits)-1])>>>16&255,A=65535&L,!((T=L>>>24)<=y);){if(0===p)break e;p--,m+=u[d++]<<y,y+=8}if(!(240&S)){for(I=T,C=S,B=A;S=(L=r.distcode[B+((m&(1<<I+C)-1)>>I)])>>>16&255,A=65535&L,!(I+(T=L>>>24)<=y);){if(0===p)break e;p--,m+=u[d++]<<y,y+=8}m>>>=I,y-=I,r.back+=I}if(m>>>=T,y-=T,r.back+=T,64&S){e.msg="invalid distance code",r.mode=30;break}r.offset=A,r.extra=15&S,r.mode=24;case 24:if(r.extra){for(M=r.extra;y<M;){if(0===p)break e;p--,m+=u[d++]<<y,y+=8}r.offset+=m&(1<<r.extra)-1,m>>>=r.extra,y-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=30;break}r.mode=25;case 25:if(0===g)break e;if(E=_-g,r.offset>E){if((E=r.offset-E)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=30;break}w=E>r.wnext?(E-=r.wnext,r.wsize-E):r.wnext-E,E>r.length&&(E=r.length),k=r.window}else k=h,w=f-r.offset,E=r.length;for(g<E&&(E=g),g-=E,r.length-=E;h[f++]=k[w++],--E;);0===r.length&&(r.mode=21);break;case 26:if(0===g)break e;h[f++]=r.length,g--,r.mode=21;break;case 27:if(r.wrap){for(;y<32;){if(0===p)break e;p--,m|=u[d++]<<y,y+=8}if(_-=g,e.total_out+=_,r.total+=_,_&&(e.adler=r.check=r.flags?i(r.check,h,_,f-_):n(r.check,h,_,f-_)),_=g,(r.flags?m:c(m))!==r.check){e.msg="incorrect data check",r.mode=30;break}y=m=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;y<32;){if(0===p)break e;p--,m+=u[d++]<<y,y+=8}if(m!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=30;break}y=m=0}r.mode=29;case 29:P=1;break e;case 30:P=-3;break e;case 31:return-4;default:return l}return e.next_out=f,e.avail_out=g,e.next_in=d,e.avail_in=p,r.hold=m,r.bits=y,(r.wsize||_!==e.avail_out&&r.mode<30&&(r.mode<27||4!==t))&&b(e,e.output,e.next_out,_-e.avail_out)?(r.mode=31,-4):(x-=e.avail_in,_-=e.avail_out,e.total_in+=x,e.total_out+=_,r.total+=_,r.wrap&&_&&(e.adler=r.check=r.flags?i(r.check,h,_,e.next_out-_):n(r.check,h,_,e.next_out-_)),e.data_type=r.bits+(r.last?64:0)+(12===r.mode?128:0)+(20===r.mode||15===r.mode?256:0),(0==x&&0===_||4===t)&&0===P&&(P=-5),P)},r.inflateEnd=function(e){if(!e||!e.state)return l;var t=e.state;return t.window&&(t.window=null),e.state=null,0},r.inflateGetHeader=function(e,t){var r;return e&&e.state&&2&(r=e.state).wrap?((r.head=t).done=!1,0):l},r.inflateSetDictionary=function(e,t){var r,a=t.length;return e&&e.state?0!==(r=e.state).wrap&&11!==r.mode?l:11===r.mode&&n(1,t,a,0)!==r.check?-3:b(e,t,a,a)?(r.mode=31,-4):(r.havedict=1,0):l},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,r){"use strict";var a=e("../utils/common"),n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],i=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,r,l,c,u,h,d){var f,p,g,m,y,v,b,x,_,E=d.bits,w=0,k=0,T=0,S=0,A=0,I=0,C=0,B=0,N=0,P=0,F=null,M=0,L=new a.Buf16(16),z=new a.Buf16(16),D=null,O=0;for(w=0;w<=15;w++)L[w]=0;for(k=0;k<l;k++)L[t[r+k]]++;for(A=E,S=15;1<=S&&0===L[S];S--);if(S<A&&(A=S),0===S)return c[u++]=20971520,c[u++]=20971520,d.bits=1,0;for(T=1;T<S&&0===L[T];T++);for(A<T&&(A=T),w=B=1;w<=15;w++)if(B<<=1,(B-=L[w])<0)return-1;if(0<B&&(0===e||1!==S))return-1;for(z[1]=0,w=1;w<15;w++)z[w+1]=z[w]+L[w];for(k=0;k<l;k++)0!==t[r+k]&&(h[z[t[r+k]]++]=k);if(v=0===e?(F=D=h,19):1===e?(F=n,M-=257,D=i,O-=257,256):(F=o,D=s,-1),w=T,y=u,C=k=P=0,g=-1,m=(N=1<<(I=A))-1,1===e&&852<N||2===e&&592<N)return 1;for(;;){for(b=w-C,_=h[k]<v?(x=0,h[k]):h[k]>v?(x=D[O+h[k]],F[M+h[k]]):(x=96,0),f=1<<w-C,T=p=1<<I;c[y+(P>>C)+(p-=f)]=b<<24|x<<16|_,0!==p;);for(f=1<<w-1;P&f;)f>>=1;if(0!==f?(P&=f-1,P+=f):P=0,k++,0==--L[w]){if(w===S)break;w=t[r+h[k]]}if(A<w&&(P&m)!==g){for(0===C&&(C=A),y+=T,B=1<<(I=w-C);I+C<S&&!((B-=L[I+C])<=0);)I++,B<<=1;if(N+=1<<I,1===e&&852<N||2===e&&592<N)return 1;c[g=P&m]=A<<24|I<<16|y-u}}return 0!==P&&(c[y+P]=w-C<<24|64<<16),d.bits=A,0}},{"../utils/common":41}],51:[function(e,t,r){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,r){"use strict";var a=e("../utils/common");function n(e){for(var t=e.length;0<=--t;)e[t]=0}var i=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],o=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],l=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],c=new Array(576);n(c);var u=new Array(60);n(u);var h=new Array(512);n(h);var d=new Array(256);n(d);var f=new Array(29);n(f);var p,g,m,y=new Array(30);function v(e,t,r,a,n){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=a,this.max_length=n,this.has_stree=e&&e.length}function b(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function x(e){return e<256?h[e]:h[256+(e>>>7)]}function _(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function E(e,t,r){e.bi_valid>16-r?(e.bi_buf|=t<<e.bi_valid&65535,_(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=r-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function w(e,t,r){E(e,r[2*t],r[2*t+1])}function k(e,t){for(var r=0;r|=1&e,e>>>=1,r<<=1,0<--t;);return r>>>1}function T(e,t,r){var a,n,i=new Array(16),o=0;for(a=1;a<=15;a++)i[a]=o=o+r[a-1]<<1;for(n=0;n<=t;n++){var s=e[2*n+1];0!==s&&(e[2*n]=k(i[s]++,s))}}function S(e){var t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function A(e){8<e.bi_valid?_(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function I(e,t,r,a){var n=2*t,i=2*r;return e[n]<e[i]||e[n]===e[i]&&a[t]<=a[r]}function C(e,t,r){for(var a=e.heap[r],n=r<<1;n<=e.heap_len&&(n<e.heap_len&&I(t,e.heap[n+1],e.heap[n],e.depth)&&n++,!I(t,a,e.heap[n],e.depth));)e.heap[r]=e.heap[n],r=n,n<<=1;e.heap[r]=a}function B(e,t,r){var a,n,s,l,c=0;if(0!==e.last_lit)for(;a=e.pending_buf[e.d_buf+2*c]<<8|e.pending_buf[e.d_buf+2*c+1],n=e.pending_buf[e.l_buf+c],c++,0===a?w(e,n,t):(w(e,(s=d[n])+256+1,t),0!==(l=i[s])&&E(e,n-=f[s],l),w(e,s=x(--a),r),0!==(l=o[s])&&E(e,a-=y[s],l)),c<e.last_lit;);w(e,256,t)}function N(e,t){var r,a,n,i=t.dyn_tree,o=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=573,r=0;r<l;r++)0!==i[2*r]?(e.heap[++e.heap_len]=c=r,e.depth[r]=0):i[2*r+1]=0;for(;e.heap_len<2;)i[2*(n=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[n]=0,e.opt_len--,s&&(e.static_len-=o[2*n+1]);for(t.max_code=c,r=e.heap_len>>1;1<=r;r--)C(e,i,r);for(n=l;r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],C(e,i,1),a=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=a,i[2*n]=i[2*r]+i[2*a],e.depth[n]=(e.depth[r]>=e.depth[a]?e.depth[r]:e.depth[a])+1,i[2*r+1]=i[2*a+1]=n,e.heap[1]=n++,C(e,i,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var r,a,n,i,o,s,l=t.dyn_tree,c=t.max_code,u=t.stat_desc.static_tree,h=t.stat_desc.has_stree,d=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,p=t.stat_desc.max_length,g=0;for(i=0;i<=15;i++)e.bl_count[i]=0;for(l[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<573;r++)p<(i=l[2*l[2*(a=e.heap[r])+1]+1]+1)&&(i=p,g++),l[2*a+1]=i,c<a||(e.bl_count[i]++,o=0,f<=a&&(o=d[a-f]),s=l[2*a],e.opt_len+=s*(i+o),h&&(e.static_len+=s*(u[2*a+1]+o)));if(0!==g){do{for(i=p-1;0===e.bl_count[i];)i--;e.bl_count[i]--,e.bl_count[i+1]+=2,e.bl_count[p]--,g-=2}while(0<g);for(i=p;0!==i;i--)for(a=e.bl_count[i];0!==a;)c<(n=e.heap[--r])||(l[2*n+1]!==i&&(e.opt_len+=(i-l[2*n+1])*l[2*n],l[2*n+1]=i),a--)}}(e,t),T(i,c,e.bl_count)}function P(e,t,r){var a,n,i=-1,o=t[1],s=0,l=7,c=4;for(0===o&&(l=138,c=3),t[2*(r+1)+1]=65535,a=0;a<=r;a++)n=o,o=t[2*(a+1)+1],++s<l&&n===o||(s<c?e.bl_tree[2*n]+=s:0!==n?(n!==i&&e.bl_tree[2*n]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,i=n,c=(s=0)===o?(l=138,3):n===o?(l=6,3):(l=7,4))}function F(e,t,r){var a,n,i=-1,o=t[1],s=0,l=7,c=4;for(0===o&&(l=138,c=3),a=0;a<=r;a++)if(n=o,o=t[2*(a+1)+1],!(++s<l&&n===o)){if(s<c)for(;w(e,n,e.bl_tree),0!=--s;);else 0!==n?(n!==i&&(w(e,n,e.bl_tree),s--),w(e,16,e.bl_tree),E(e,s-3,2)):s<=10?(w(e,17,e.bl_tree),E(e,s-3,3)):(w(e,18,e.bl_tree),E(e,s-11,7));i=n,c=(s=0)===o?(l=138,3):n===o?(l=6,3):(l=7,4)}}n(y);var M=!1;function L(e,t,r,n){E(e,0+(n?1:0),3),function(e,t,r){A(e),_(e,r),_(e,~r),a.arraySet(e.pending_buf,e.window,t,r,e.pending),e.pending+=r}(e,t,r)}r._tr_init=function(e){M||(function(){var e,t,r,a,n,l=new Array(16);for(a=r=0;a<28;a++)for(f[a]=r,e=0;e<1<<i[a];e++)d[r++]=a;for(d[r-1]=a,a=n=0;a<16;a++)for(y[a]=n,e=0;e<1<<o[a];e++)h[n++]=a;for(n>>=7;a<30;a++)for(y[a]=n<<7,e=0;e<1<<o[a]-7;e++)h[256+n++]=a;for(t=0;t<=15;t++)l[t]=0;for(e=0;e<=143;)c[2*e+1]=8,e++,l[8]++;for(;e<=255;)c[2*e+1]=9,e++,l[9]++;for(;e<=279;)c[2*e+1]=7,e++,l[7]++;for(;e<=287;)c[2*e+1]=8,e++,l[8]++;for(T(c,287,l),e=0;e<30;e++)u[2*e+1]=5,u[2*e]=k(e,5);p=new v(c,i,257,286,15),g=new v(u,o,0,30,15),m=new v(new Array(0),s,0,19,7)}(),M=!0),e.l_desc=new b(e.dyn_ltree,p),e.d_desc=new b(e.dyn_dtree,g),e.bl_desc=new b(e.bl_tree,m),e.bi_buf=0,e.bi_valid=0,S(e)},r._tr_stored_block=L,r._tr_flush_block=function(e,t,r,a){var n,i,o=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),N(e,e.l_desc),N(e,e.d_desc),o=function(e){var t;for(P(e,e.dyn_ltree,e.l_desc.max_code),P(e,e.dyn_dtree,e.d_desc.max_code),N(e,e.bl_desc),t=18;3<=t&&0===e.bl_tree[2*l[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),n=e.opt_len+3+7>>>3,(i=e.static_len+3+7>>>3)<=n&&(n=i)):n=i=r+5,r+4<=n&&-1!==t?L(e,t,r,a):4===e.strategy||i===n?(E(e,2+(a?1:0),3),B(e,c,u)):(E(e,4+(a?1:0),3),function(e,t,r,a){var n;for(E(e,t-257,5),E(e,r-1,5),E(e,a-4,4),n=0;n<a;n++)E(e,e.bl_tree[2*l[n]+1],3);F(e,e.dyn_ltree,t-1),F(e,e.dyn_dtree,r-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),B(e,e.dyn_ltree,e.dyn_dtree)),S(e),a&&A(e)},r._tr_tally=function(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(d[r]+256+1)]++,e.dyn_dtree[2*x(t)]++),e.last_lit===e.lit_bufsize-1},r._tr_align=function(e){E(e,2,3),w(e,256,c),function(e){16===e.bi_valid?(_(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):8<=e.bi_valid&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},{"../utils/common":41}],53:[function(e,t,r){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,r){(function(e){!function(e){"use strict";if(!e.setImmediate){var t,r,a,n,i=1,o={},s=!1,l=e.document,c=Object.getPrototypeOf&&Object.getPrototypeOf(e);c=c&&c.setTimeout?c:e,t="[object process]"==={}.toString.call(e.process)?function(e){process.nextTick(function(){h(e)})}:function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?(n="setImmediate$"+Math.random()+"$",e.addEventListener?e.addEventListener("message",d,!1):e.attachEvent("onmessage",d),function(t){e.postMessage(n+t,"*")}):e.MessageChannel?((a=new MessageChannel).port1.onmessage=function(e){h(e.data)},function(e){a.port2.postMessage(e)}):l&&"onreadystatechange"in l.createElement("script")?(r=l.documentElement,function(e){var t=l.createElement("script");t.onreadystatechange=function(){h(e),t.onreadystatechange=null,r.removeChild(t),t=null},r.appendChild(t)}):function(e){setTimeout(h,0,e)},c.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var r=new Array(arguments.length-1),a=0;a<r.length;a++)r[a]=arguments[a+1];var n={callback:e,args:r};return o[i]=n,t(i),i++},c.clearImmediate=u}function u(e){delete o[e]}function h(e){if(s)setTimeout(h,0,e);else{var t=o[e];if(t){s=!0;try{!function(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(void 0,r)}}(t)}finally{u(e),s=!1}}}}function d(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(n)&&h(+t.data.slice(n.length))}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10)});var XMLUtils=function(){return _createClass(function XMLUtils(){_classCallCheck(this,XMLUtils)},null,[{key:"getFileContent",value:(e=_asyncToGenerator(_regenerator().m(function e(t,r){var a;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(!(a=t.files[r])){e.n=2;break}return e.n=1,a.async("string");case 1:return e.a(2,e.v);case 2:return e.a(2,null)}},e)})),function(t,r){return e.apply(this,arguments)})},{key:"parseRelationships",value:function(e){if(!e)return[];var t,r=[],a=_createForOfIteratorHelper((new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("Relationship"));try{for(a.s();!(t=a.n()).done;){var n=t.value;r.push({id:n.getAttribute("Id"),type:n.getAttribute("Type"),target:n.getAttribute("Target")})}}catch(e){a.e(e)}finally{a.f()}return r}},{key:"getSlideOrder",value:function(e){if(!e)return[];var t=[],r=(new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("p:sldIdLst")[0];if(r){var a,n=_createForOfIteratorHelper(r.getElementsByTagName("p:sldId"));try{for(n.s();!(a=n.n()).done;){var i=a.value.getAttribute("r:id");i&&t.push(i)}}catch(e){n.e(e)}finally{n.f()}}return t}},{key:"parseXML",value:function(e){return(new DOMParser).parseFromString(e,"text/xml")}}]);var e}();window.XMLUtils=XMLUtils;var ThemeExtractor=function(){return _createClass(function ThemeExtractor(){_classCallCheck(this,ThemeExtractor),this.themeColors={},this.themeFonts={majorFont:"Calibri Light",minorFont:"Calibri"},this.defaultThemeColors={dk1:"#000000",lt1:"#FFFFFF",dk2:"#1F497D",lt2:"#EEECE1",accent1:"#5B9BD5",accent2:"#ED7D31",accent3:"#A5A5A5",accent4:"#FFC000",accent5:"#4472C4",accent6:"#70AD47",hlink:"#0563C1",folHlink:"#954F72"},this.fillStyleNodes=[],this.bgFillStyleNodes=[],this.themeRelationships=[]},[{key:"setThemeRelationships",value:function(e){this.themeRelationships=Array.isArray(e)?e:[]}},{key:"getThemeRelationshipTarget",value:function(e){if(!e||!Array.isArray(this.themeRelationships))return null;var t=this.themeRelationships.find(function(t){return t&&t.id===e});return t&&"string"==typeof t.target?t.target:null}},{key:"resolveThemeImageUrl",value:function(e,t){var r=this.getThemeRelationshipTarget(e);if(!r||!t)return null;var a=r.split("/").pop();return a&&t[a]||null}},{key:"extract",value:(e=_asyncToGenerator(_regenerator().m(function e(t){return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(t){e.n=1;break}return e.a(2);case 1:this.extractColorScheme(t),this.extractFontScheme(t),this.extractFormatScheme(t);case 2:return e.a(2)}},e,this)})),function(t){return e.apply(this,arguments)})},{key:"extractFormatScheme",value:function(e){var t=e.getElementsByTagName("a:fmtScheme")[0];if(t){var r=function(e){return e?Array.from(e.childNodes).filter(function(e){return e&&1===e.nodeType}):[]},a=t.getElementsByTagName("a:fillStyleLst")[0],n=t.getElementsByTagName("a:bgFillStyleLst")[0];this.fillStyleNodes=r(a),this.bgFillStyleNodes=r(n)}}},{key:"getFillStyleNode",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).background,r=void 0!==t&&t?this.bgFillStyleNodes:this.fillStyleNodes;if(!Array.isArray(r)||0===r.length)return null;if(!Number.isFinite(e))return null;if(e>=0&&e<r.length)return r[e];var a=e-1;return a>=0&&a<r.length?r[a]:null}},{key:"extractColorScheme",value:function(e){var t=e.getElementsByTagName("a:clrScheme")[0];if(t)for(var r=0,a=["dk1","lt1","dk2","lt2","accent1","accent2","accent3","accent4","accent5","accent6","hlink","folHlink"];r<a.length;r++){var n=a[r],i=t.getElementsByTagName("a:"+n)[0];if(i){var o=i.getElementsByTagName("a:srgbClr")[0],s=i.getElementsByTagName("a:sysClr")[0];if(o)this.themeColors[n]="#"+o.getAttribute("val");else if(s){var l=s.getAttribute("lastClr");l&&(this.themeColors[n]="#"+l)}}}}},{key:"extractFontScheme",value:function(e){var t=e.getElementsByTagName("a:fontScheme")[0];if(t){var r=t.getElementsByTagName("a:majorFont")[0];if(r){var a=r.getElementsByTagName("a:latin")[0];a&&(this.themeFonts.majorFont=a.getAttribute("typeface")||"Calibri Light")}var n=t.getElementsByTagName("a:minorFont")[0];if(n){var i=n.getElementsByTagName("a:latin")[0];i&&(this.themeFonts.minorFont=i.getAttribute("typeface")||"Calibri")}}}},{key:"getSchemeColor",value:function(e){var t={tx1:"dk1",tx2:"dk2",bg1:"lt1",bg2:"lt2",accent1:"accent1",accent2:"accent2",accent3:"accent3",accent4:"accent4",accent5:"accent5",accent6:"accent6",hlink:"hlink",folHlink:"folHlink",dk1:"dk1",dk2:"dk2",lt1:"lt1",lt2:"lt2"}[e]||e;return this.themeColors[t]||this.defaultThemeColors[t]||null}},{key:"getColors",value:function(){return this.themeColors}},{key:"getFonts",value:function(){return this.themeFonts}},{key:"getDefaultTextColor",value:function(){return this.themeColors.dk1||"#000000"}},{key:"getTitleFont",value:function(){return this.themeFonts.majorFont||"Calibri Light"}},{key:"getBodyFont",value:function(){return this.themeFonts.minorFont||"Calibri"}},{key:"getAccentColor",value:function(e){var t="accent".concat(e);return this.themeColors[t]||this.defaultThemeColors[t]||null}},{key:"getBackgroundColor",value:function(){return this.themeColors.lt1||"#FFFFFF"}},{key:"getSecondaryTextColor",value:function(){return this.themeColors.dk2||"#444444"}},{key:"getHyperlinkColor",value:function(){return this.themeColors.hlink||"#0563C1"}},{key:"reset",value:function(){this.themeColors={},this.themeFonts={majorFont:"Calibri Light",minorFont:"Calibri"},this.fillStyleNodes=[],this.bgFillStyleNodes=[]}}]);var e}();window.ThemeExtractor=ThemeExtractor;var BackgroundExtractor=function(){return _createClass(function BackgroundExtractor(e,t){_classCallCheck(this,BackgroundExtractor),this.themeExtractor=e,this.images=t},[{key:"extract",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a={type:null,color:null,gradient:null,image:null},n=e.getElementsByTagName("p:bgPr")[0],i=e.getElementsByTagName("p:bg")[0];if(n){var o=n.getElementsByTagName("a:solidFill")[0];if(o)return a.type="solid",a.color=this.extractColor(o),a;var s=n.getElementsByTagName("a:gradFill")[0];if(s)return a.type="gradient",a.gradient=this.extractGradient(s),a;var l=n.getElementsByTagName("a:blipFill")[0];if(l){var c=l.getElementsByTagName("a:blip")[0];if(c){var u=c.getElementsByTagName("asvg:svgBlip")[0],h=u?u.getAttribute("r:embed"):null,d=c.getAttribute("r:embed"),f=function(e){if(!e)return null;var a=r.find(function(t){return(t.getAttribute?t.getAttribute("Id"):t.id)===e});if(!a)return null;var n=(a.getAttribute?a.getAttribute("Target"):a.target).split("/").pop();return t.images[n]||null},p=f(h),g=f(d),m=p||g;if(m)return a.type="image",a.image=m,a}}var y=n.getElementsByTagName("a:pattFill")[0];if(y){a.type="pattern";var v=y.getElementsByTagName("a:fgClr")[0],b=y.getElementsByTagName("a:bgClr")[0];return a.color=this.extractColor(v)||this.extractColor(b),a}}var x=i?i.getElementsByTagName("p:bgRef")[0]:null;return x&&x.getElementsByTagName("a:schemeClr")[0]?(a.type="solid",a.color=this.extractColor(x),a):a.type?a:null}},{key:"extractGradient",value:function(e){var t={type:"linear",angle:90,stops:[]},r=e.getElementsByTagName("a:lin")[0];if(r){var a=r.getAttribute("ang");a&&(t.angle=parseInt(a)/6e4)}var n=e.getElementsByTagName("a:path")[0];n&&(t.type=n.getAttribute("path")||"circle");var i=e.getElementsByTagName("a:gsLst")[0];if(i){var o,s=_createForOfIteratorHelper(i.getElementsByTagName("a:gs"));try{for(s.s();!(o=s.n()).done;){var l=o.value,c=parseInt(l.getAttribute("pos")||"0")/1e3,u=this.extractColor(l);if(u){var h={position:c,color:u},d=l.getElementsByTagName("a:alpha")[0];if(d){var f=parseInt(d.getAttribute("val")||"100000");h.opacity=f/1e5}else h.opacity=1;t.stops.push(h)}}}catch(e){s.e(e)}finally{s.f()}}return t.stops.sort(function(e,t){return e.position-t.position}),t}},{key:"extractColor",value:function(e){if(!e)return null;var t=e.getElementsByTagName("a:srgbClr")[0];if(t){var r="#"+t.getAttribute("val");return this.applyColorTransforms(r,t)}var a=e.getElementsByTagName("a:schemeClr")[0];if(a){var n=a.getAttribute("val"),i=this.themeExtractor.getSchemeColor(n);return i?this.applyColorTransforms(i,a):null}var o=e.getElementsByTagName("a:sysClr")[0];if(o){var s=o.getAttribute("lastClr");if(s){var l="#"+s;return this.applyColorTransforms(l,o)}}var c=e.getElementsByTagName("a:prstClr")[0];if(c){var u=c.getAttribute("val"),h=this.presetColorToHex(u);if(h)return this.applyColorTransforms(h,c)}return null}},{key:"extractColorWithOpacity",value:function(e){if(!e)return null;var t=this.extractColor(e);if(!t)return null;var r=1,a=e.getElementsByTagName("a:alpha")[0];return a&&(r=parseInt(a.getAttribute("val")||"100000")/1e5),{color:t,opacity:r}}},{key:"applyColorTransforms",value:function(e,t){if(!t)return e;var r=this.hexToRgb(e),a=r.r,n=r.g,i=r.b,o=this.rgbToHsl(a,n,i),s=o.h,l=o.s,c=o.l,u=t.getElementsByTagName("a:lumMod")[0];u&&(c*=parseInt(u.getAttribute("val")||"100000")/1e5);var h=t.getElementsByTagName("a:lumOff")[0];h&&(c+=parseInt(h.getAttribute("val")||"0")/1e5);var d=t.getElementsByTagName("a:tint")[0];d&&(c+=(1-c)*(1-parseInt(d.getAttribute("val")||"100000")/1e5));var f=t.getElementsByTagName("a:shade")[0];f&&(c*=parseInt(f.getAttribute("val")||"100000")/1e5);var p=t.getElementsByTagName("a:satMod")[0];p&&(l*=parseInt(p.getAttribute("val")||"100000")/1e5),c=Math.max(0,Math.min(1,c)),l=Math.max(0,Math.min(1,l));var g=this.hslToRgb(s,l,c);return this.rgbToHex(g.r,g.g,g.b)}},{key:"hexToRgb",value:function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:{r:0,g:0,b:0}}},{key:"rgbToHsl",value:function(e,t,r){e/=255,t/=255,r/=255;var a,n,i=Math.max(e,t,r),o=Math.min(e,t,r),s=(i+o)/2;if(i===o)a=n=0;else{var l=i-o;switch(n=s>.5?l/(2-i-o):l/(i+o),i){case e:a=((t-r)/l+(t<r?6:0))/6;break;case t:a=((r-e)/l+2)/6;break;case r:a=((e-t)/l+4)/6}}return{h:a,s:n,l:s}}},{key:"hslToRgb",value:function(e,t,r){var a,n,i;if(0===t)a=n=i=r;else{var o=function(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e},s=r<.5?r*(1+t):r+t-r*t,l=2*r-s;a=o(l,s,e+1/3),n=o(l,s,e),i=o(l,s,e-1/3)}return{r:Math.round(255*a),g:Math.round(255*n),b:Math.round(255*i)}}},{key:"rgbToHex",value:function(e,t,r){return"#"+[e,t,r].map(function(e){var t=e.toString(16);return 1===t.length?"0"+t:t}).join("")}},{key:"presetColorToHex",value:function(e){var t;if(!e)return null;var r=(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(t={black:"#000000",white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",yellow:"#FFFF00",cyan:"#00FFFF",magenta:"#FF00FF",orange:"#FFA500",brown:"#A52A2A",gray:"#808080",silver:"#C0C0C0",dkGray:"#404040",ltGray:"#D3D3D3",darkRed:"#8B0000",darkGreen:"#006400",darkBlue:"#00008B",darkGray:"#404040",dkRed:"#8B0000",dkGreen:"#006400",dkBlue:"#00008B",lightRed:"#FFA07A",lightGreen:"#90EE90",lightBlue:"#ADD8E6",lightGray:"#D3D3D3",ltRed:"#FFA07A",ltGreen:"#90EE90",ltBlue:"#ADD8E6"},"ltGray","#D3D3D3"),"maroon","#800000"),"olive","#808000"),"navy","#000080"),"purple","#800080"),"teal","#008080"),"aqua","#00FFFF"),"lime","#00FF00"),"fuchsia","#FF00FF"),"gold","#FFD700"),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(t,"coral","#FF7F50"),"crimson","#DC143C"),"indigo","#4B0082"),"violet","#EE82EE"),"plum","#DDA0DD"),"tan","#D2B48C"))[e];return r||console.warn("[PPTX] Unmapped preset color '".concat(e,"'")),r||null}}])}();window.BackgroundExtractor=BackgroundExtractor;var TextExtractor=function(){return _createClass(function TextExtractor(e,t){_classCallCheck(this,TextExtractor),this.themeExtractor=e,this.backgroundExtractor=t},[{key:"extractTextElements",value:function(e){var t,r=[],a=_createForOfIteratorHelper(e.getElementsByTagName("p:sp"));try{for(a.s();!(t=a.n()).done;){var n=t.value;if(!this.shouldSkipPlaceholder(n)){var i=this.isTitlePlaceholder(n),o=n.getElementsByTagName("p:txBody")[0];if(o){var s=this.extractTextFromBody(o,i);s&&r.push(s)}}}}catch(e){a.e(e)}finally{a.f()}return r}},{key:"shouldSkipPlaceholder",value:function(e){return!1}},{key:"isTitlePlaceholder",value:function(e){var t=e.getElementsByTagName("p:nvSpPr")[0];if(t){var r=t.getElementsByTagName("p:nvPr")[0];if(r){var a=r.getElementsByTagName("p:ph")[0];if(a){var n=a.getAttribute("type");return"title"===n||"ctrTitle"===n||"subTitle"===n}}}return!1}},{key:"extractTextFromBody",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=[],n=_createForOfIteratorHelper(e.getElementsByTagName("a:p"));try{for(n.s();!(t=n.n()).done;){var i=t.value,o=this.extractParagraph(i,r);o.length>0&&a.push(o)}}catch(e){n.e(e)}finally{n.f()}return a.length>0?{paragraphs:a}:null}},{key:"extractParagraph",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.getElementsByTagName("a:pPr")[0],a="left",n=null,i=null,o=null;if(r){var s=r.getAttribute("algn");"ctr"===s?a="center":"r"===s?a="right":"just"===s&&(a="justify");var l=r.getElementsByTagName("a:defRPr")[0];if(l){var c=l.getAttribute("sz");c&&(n=parseInt(c)/100);var u=l.getElementsByTagName("a:solidFill")[0];i=this.backgroundExtractor.extractColor(u);var h=l.getElementsByTagName("a:latin")[0];if(h){var d=h.getAttribute("typeface");if(d){var f=this.themeExtractor.getFonts();"+mj-lt"===d?o=f.majorFont:"+mn-lt"===d?o=f.minorFont:d.startsWith("+")||(o=d)}}}}var p,g=[],m=_createForOfIteratorHelper(e.getElementsByTagName("a:r"));try{for(m.s();!(p=m.n()).done;){var y=p.value,v=this.extractTextRun(y,a,t,n,i,o);v&&g.push(v)}}catch(e){m.e(e)}finally{m.f()}if(0===g.length){var b,x=_createForOfIteratorHelper(e.getElementsByTagName("a:t"));try{for(x.s();!(b=x.n()).done;){var _=b.value;_.textContent&&_.textContent.trim()&&g.push({text:_.textContent,color:i||this.themeExtractor.getDefaultTextColor(),bold:!1,italic:!1,underline:!1,strikethrough:!1,superscript:!1,subscript:!1,textTransform:"none",fontSize:n,fontFamily:o||(t?this.themeExtractor.getTitleFont():this.themeExtractor.getBodyFont()),align:a,highlight:null,shadow:null})}}catch(e){x.e(e)}finally{x.f()}}return g}},{key:"extractTextRun",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=e.getElementsByTagName("a:t")[0];if(!o||!o.textContent)return null;var s=o.textContent,l=e.getElementsByTagName("a:rPr")[0],c=null,u=!1,h=!1,d=!1,f=!1,p=null,g=null,m=null,y=!1,v=!1,b="none",x=null;if(l){u="1"===l.getAttribute("b"),h="1"===l.getAttribute("i"),d=l.getAttribute("u")&&"none"!==l.getAttribute("u"),f=l.getAttribute("strike")&&"noStrike"!==l.getAttribute("strike");var _=l.getAttribute("baseline");if(_){var E=parseInt(_,10);Number.isNaN(E)||(y=E>0,v=E<0)}var w=l.getAttribute("cap");"small"===w?b="small-caps":"all"===w&&(b="uppercase");var k=l.getAttribute("sz");k&&(p=parseInt(k)/100),g=this.extractFontFamily(l);var T=l.getElementsByTagName("a:solidFill")[0];c=this.backgroundExtractor.extractColor(T);var S=l.getElementsByTagName("a:highlight")[0];S&&(m=this.backgroundExtractor.extractColor(S)||"#ffff00");var A=l.getElementsByTagName("a:outerShdw")[0];if(A){var I=parseInt(A.getAttribute("dist")||"0",10),C=parseInt(A.getAttribute("dir")||"2700000",10),B=parseInt(A.getAttribute("blur")||"0",10),N=C*Math.PI/108e5,P=I/12700*Math.cos(N),F=I/12700*Math.sin(N),M=A.getElementsByTagName("a:srgbClr")[0],L=M?M.getAttribute("val"):"000000",z=A.getElementsByTagName("a:alpha")[0],D=z?parseInt(z.getAttribute("val")||"100000",10)/1e5:1;x={offsetX:P,offsetY:F,blur:B/12700,color:"#".concat(L),opacity:D}}}return!p&&a&&(p=a),!c&&n&&(c=n),!g&&i&&(g=i),c||(c=this.themeExtractor.getDefaultTextColor()),g||(g=r?this.themeExtractor.getTitleFont():this.themeExtractor.getBodyFont()),{text:s,color:c,bold:u,italic:h,underline:d,strikethrough:f,superscript:y,subscript:v,textTransform:b,fontSize:p,fontFamily:g,align:t,highlight:m,shadow:x}}},{key:"extractFontFamily",value:function(e){var t=this.themeExtractor.getFonts(),r=e.getElementsByTagName("a:latin")[0];if(r){var a=r.getAttribute("typeface");if(a)return"+mj-lt"===a?t.majorFont:"+mn-lt"===a?t.minorFont:a}var n=e.getElementsByTagName("a:ea")[0];if(n){var i=n.getAttribute("typeface");if(i&&!i.startsWith("+"))return i}var o=e.getElementsByTagName("a:cs")[0];if(o){var s=o.getAttribute("typeface");if(s&&!s.startsWith("+"))return s}return null}}])}();window.TextExtractor=TextExtractor,function(e){"use strict";var t=function(){var e=_asyncToGenerator(_regenerator().m(function e(t){return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(!(t instanceof Blob)){e.n=1;break}return e.a(2,t);case 1:if(!(t instanceof ArrayBuffer)){e.n=2;break}return e.a(2,new Blob([t]));case 2:if(!(t&&t.buffer instanceof ArrayBuffer)){e.n=3;break}return e.a(2,new Blob([t.buffer]));case 3:throw new Error("Unsupported input type for EMF conversion");case 4:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),r=function(e){return{width:400,height:200,svgText:'<svg xmlns="http://www.w3.org/2000/svg" width="400" height="200" viewBox="0 0 400 200" role="img" aria-label="'+(e||"EMF image").replace(/</g,"&lt;").replace(/>/g,"&gt;")+' unsupported"><rect width="400" height="200" fill="#f3f4f6" stroke="#d1d5db"/><text x="200" y="80" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" fill="#4b5563">EMF not rendered</text><text x="200" y="120" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="#6b7280">Unsupported content</text></svg>'}},a=function(e,t,r){return 2===r?e.getUint16(t,!0):e.getUint32(t,!0)},n=function(e){var t=0,r=0,a=e>>>0;if(0===a)return{shift:0,bits:0,scale:0};for(;!(1&a);)t++,a>>>=1;for(;!(1&~a);)r++,a>>>=1;return{shift:t,bits:r,scale:r?255/((1<<r)-1):0}},i=function(e,t,r,i){var o=a(e,t,4);if(o<40)return null;var s=e.getInt32(t+4,!0),l=e.getInt32(t+8,!0),c=a(e,t+12,2),u=a(e,t+14,2),h=a(e,t+16,4),d=a(e,t+32,4);if(1!==c)return null;var f=l<0,p=Math.abs(l);if(s<=0||p<=0)return null;var g=0;u<=8&&3!==h&&(g=d&&d>0?d:1<<u);var m=g>0?function(e,t,r){for(var a=[],n=0;n<r;n++){var i=e.getUint8(t+4*n+0),o=e.getUint8(t+4*n+1),s=e.getUint8(t+4*n+2);a.push({r:s,g:o,b:i,a:255})}return a}(e,t+o,g):null,y=0,v=0,b=0,x=0;if(3===h){var _=t+o;y=e.getUint32(_+0,!0),v=e.getUint32(_+4,!0),b=e.getUint32(_+8,!0),x=e.getUint32(_+12,!0)}var E=1===u?s+31>>3&-4:4===u?4*(s+7>>3)+3&-4:8===u?s+3&-4:16===u||15===u?2*s+3&-4:24===u?3*s+3&-4:32===u?4*s:null;if(!E)return null;if(E*p>Math.min(i,e.byteLength-r))return null;var w=new Uint8ClampedArray(s*p*4),k=function(e,t,r,a,n){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:255,o=4*(e*s+t);w[o]=r,w[o+1]=a,w[o+2]=n,w[o+3]=i},T=r,S=function(e){for(var t=0;t<p;t++)e(t,T+(f?t:p-1-t)*E)};if(24===u||32===u)return S(function(t,r){for(var a=0;a<s;a++){var n=e.getUint8(r+a*(u/8)+0),i=e.getUint8(r+a*(u/8)+1),o=e.getUint8(r+a*(u/8)+2),l=32===u?e.getUint8(r+4*a+3):255;k(t,a,o,i,n,l)}}),{width:s,height:p,pixels:w};if(16===u||15===u){var A=n(y||31744),I=n(v||992),C=n(b||31),B=n(x);return S(function(t,r){for(var a=0;a<s;a++){var n=e.getUint16(r+2*a,!0),i=A.bits?((n&y)>>>A.shift)*A.scale:0,o=I.bits?((n&v)>>>I.shift)*I.scale:0,l=C.bits?((n&b)>>>C.shift)*C.scale:0,c=B.bits?((n&x)>>>B.shift)*B.scale:255;k(t,a,i,o,l,c)}}),{width:s,height:p,pixels:w}}if(8===u||4===u||1===u){if(!m||0===m.length)return null;var N=(1<<u)-1;return S(function(t,r){for(var a=0,n=0;n<s;n++){var i=Math.floor(a/8),o=8-u-a%8,l=e.getUint8(r+i)>>o&N,c=m[l]||{r:0,g:0,b:0,a:255};k(t,n,c.r,c.g,c.b,c.a),a+=u}}),{width:s,height:p,pixels:w}}return null},o=function(e,t,r){var n=a(e,t+80,4),o=a(e,t+84,4),s=a(e,t+88,4),l=a(e,t+92,4);return n&&s&&o&&l?t+n+o>e.byteLength||t+s+l>e.byteLength?null:i(e,t+n,t+s,l):null},s=function(e,t,r){var n=a(e,t+80,4),o=a(e,t+84,4),s=a(e,t+88,4),l=a(e,t+92,4);if(!(n&&s&&o&&l))return null;if(t+n+o>e.byteLength)return null;if(t+s+l>e.byteLength)return null;var c=i(e,t+n,t+s,l);if(!c)return null;var u=e.getInt32(t+96,!0),h=e.getInt32(t+100,!0);return u>0&&h>0&&(c.width=u,c.height=h),c},l=function(e){var t=new DataView(e);if(t.byteLength<80)return null;if(1179469088!==t.getUint32(40,!0))return null;for(var r=0;r+8<=t.byteLength;){var a=t.getUint32(r,!0),n=t.getUint32(r+4,!0);if(n<8||r+n>t.byteLength)break;if(81===a){var i=o(t,r);if(i)return i}else if(74===a){var l=s(t,r);if(l)return l}r+=n}return null},c=function(e,t){var a=e.width,n=e.height,i=e.pixels,o=document.createElement("canvas");o.width=a,o.height=n;var s=o.getContext("2d");if(!s)return r(t);var l=s.createImageData(a,n);return l.data.set(i),s.putImageData(l,0,0),{width:a,height:n,svgText:'<svg xmlns="http://www.w3.org/2000/svg" width="'+a+'" height="'+n+'" viewBox="0 0 '+a+" "+n+'"><image href="'+o.toDataURL("image/png")+'" width="'+a+'" height="'+n+'"/></svg>'}},u=function(){var e=_asyncToGenerator(_regenerator().m(function e(a,n){var i,o,s,u;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,t(a);case 1:return i=e.v,e.n=2,i.arrayBuffer();case 2:if(o=e.v,s=l(o)){e.n=3;break}return e.a(2,r(n));case 3:return e.a(2,c(s,n));case 4:return e.p=4,u=e.v,console.warn("EMF conversion failed",u),e.a(2,r(n))}},e,null,[[0,4]])}));return function(t,r){return e.apply(this,arguments)}}(),h={emfToSvg:u};"undefined"!=typeof module&&module.exports?module.exports=h:e.EMFLiteConverter=h}("undefined"!=typeof window?window:globalThis);var ShapeParser=function(){function ShapeParser(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;_classCallCheck(this,ShapeParser),this.backgroundExtractor=e,this.images=t,this.themeExtractor=r}return _createClass(ShapeParser,[{key:"extractShapes",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=[],n=_createForOfIteratorHelper(e.getElementsByTagName("p:sp"));try{for(n.s();!(t=n.n()).done;){var i=t.value,o=this.parseShape(i,r);o&&a.push(o)}}catch(e){n.e(e)}finally{n.f()}return a}},{key:"parseShape",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n={type:"rect",x:null,y:null,width:null,height:null,fill:null,stroke:null,strokeWidth:1,rotation:0,text:null,shadow:null,cornerRadius:null},i=e.getElementsByTagName("p:cNvPr")[0],o=i?i.getAttribute("id"):null,s=e.getElementsByTagName("p:nvSpPr")[0];if(s){var l=s.getElementsByTagName("p:nvPr")[0];if(l){var c=l.getElementsByTagName("p:ph")[0];c&&(n.isPlaceholder=!0,n.placeholderType=c.getAttribute("type")||"body",n.placeholderIdx=c.getAttribute("idx"))}}var u=e.getElementsByTagName("p:spPr")[0];if(!u)return null;var h=u.getElementsByTagName("a:xfrm")[0];if(h){var d=h.getElementsByTagName("a:off")[0],f=h.getElementsByTagName("a:ext")[0];if(d){var p=parseInt(d.getAttribute("x")||"0"),g=parseInt(d.getAttribute("y")||"0");n.xEMU=p,n.yEMU=g,n.x=p/ShapeParser.SLIDE_WIDTH_EMU*100,n.y=g/ShapeParser.SLIDE_HEIGHT_EMU*100}if(f){var m=parseInt(f.getAttribute("cx")||"0"),y=parseInt(f.getAttribute("cy")||"0");n.cxEMU=m,n.cyEMU=y,n.width=m/ShapeParser.SLIDE_WIDTH_EMU*100,n.height=y/ShapeParser.SLIDE_HEIGHT_EMU*100}var v=h.getAttribute("rot");v&&(n.rotation=parseInt(v)/6e4)}var b=u.getElementsByTagName("a:prstGeom")[0];if(b){var x=b.getAttribute("prst");n.type=this.mapShapeType(x)}var _=u.getElementsByTagName("a:custGeom")[0];_&&(n.customGeometry=this.extractCustomGeometry(_),n.customGeometry&&(n.type="custom")),n.fill=this.extractFill(u,t),null===n.fill&&(n.fill=this.extractStyleFill(e));var E=u.getElementsByTagName("a:ln")[0];if(E){var w=E.getAttribute("w");w&&(n.strokeWidth=parseInt(w)/914400*96);var k=E.getElementsByTagName("a:solidFill")[0];E.getElementsByTagName("a:noFill")[0]?n.stroke="none":k&&(n.stroke=this.backgroundExtractor.extractColor(k))}if(null===n.stroke&&(n.stroke=this.extractStyleStroke(e)),n.shadow=this.extractShadow(u),n.cornerRadius=this.extractCornerRadius(u),o){var T=parseInt(o,10);Number.isNaN(T)||(n.shapeId=T)}var S=e.getElementsByTagName("p:txBody")[0];if(S){var A=this.getParagraphLevel(S),I=n.placeholderType||"body",C=r?r(I,A,n.placeholderIdx):null,B=this.extractShapeText(S,C,t,a);B&&(n.text=B);var N=S.getElementsByTagName("a:bodyPr")[0];if(N){var P=N.getAttribute("anchor");if("b"===P?n.textVAlign="bottom":"ctr"===P?n.textVAlign="middle":"t"===P&&(n.textVAlign="top"),N.hasAttribute("wrap")){var F=N.getAttribute("wrap");n.textWrap="none"!==F}N.getElementsByTagName("a:normAutofit")[0]?n.textAutoFit="norm":N.getElementsByTagName("a:noAutofit")[0]&&(n.textAutoFit="none");var M=N.getAttribute("lIns"),L=N.getAttribute("rIns"),z=N.getAttribute("tIns"),D=N.getAttribute("bIns"),O=91440,U=M?parseInt(M,10):O,R=L?parseInt(L,10):O,H=z?parseInt(z,10):O,j=D?parseInt(D,10):O;n.textInsetsEMU={left:U,right:R,top:H,bottom:j}}}return n}},{key:"extractFill",value:function(e,t){var r=this,a=e.getElementsByTagName("a:solidFill")[0],n=e.getElementsByTagName("a:gradFill")[0],i=e.getElementsByTagName("a:blipFill")[0];if(e.getElementsByTagName("a:noFill")[0])return"none";if(a){var o=this.backgroundExtractor.extractColorWithOpacity(a);return o?o.opacity<1?{type:"solid",color:o.color,opacity:o.opacity}:o.color:null}if(n)return{type:"gradient",gradient:this.backgroundExtractor.extractGradient(n)};if(i){var s=i.getElementsByTagName("a:blip")[0];if(s){var l=s.getElementsByTagName("asvg:svgBlip")[0],c=l?l.getAttribute("r:embed"):null,u=s.getAttribute("r:embed"),h=function(e){if(!e)return null;var a=t.find(function(t){return t.id===e});if(a){var n=a.target.split("/").pop();if(r.images[n])return r.images[n]}return null},d=h(c),f=h(u),p=d||f;if(p)return{type:"image",src:p}}}return null}},{key:"extractStyleFill",value:function(e){var t=e.getElementsByTagName("p:style")[0];if(!t)return null;var r=t.getElementsByTagName("a:fillRef")[0];if(!r)return null;var a=parseInt(r.getAttribute("idx")||"0",10),n=this.backgroundExtractor.extractColor(r);if(n)return n;if(a>0&&a<=6&&this.themeExtractor){var i=this.themeExtractor.getAccentColor(a);if(i)return i}if(this.themeExtractor&&"function"==typeof this.themeExtractor.getFillStyleNode){var o=this.themeExtractor.getFillStyleNode(a);if(o){var s=o.tagName;if("a:solidFill"===s)return this.backgroundExtractor.extractColor(o);if("a:gradFill"===s)return{type:"gradient",gradient:this.backgroundExtractor.extractGradient(o)};if("a:pattFill"===s){var l=o.getElementsByTagName("a:fgClr")[0],c=o.getElementsByTagName("a:bgClr")[0];return this.backgroundExtractor.extractColor(l)||this.backgroundExtractor.extractColor(c)}if("a:blipFill"===s){var u=o.getElementsByTagName("a:blip")[0],h=u?u.getAttribute("r:embed"):null;if(h&&this.themeExtractor&&"function"==typeof this.themeExtractor.resolveThemeImageUrl){var d=this.themeExtractor.resolveThemeImageUrl(h,this.images);if(d)return{type:"image",src:d}}}}}return null}},{key:"extractStyleStroke",value:function(e){var t=e.getElementsByTagName("p:style")[0];if(!t)return null;var r=t.getElementsByTagName("a:lnRef")[0];if(!r)return null;var a=this.backgroundExtractor.extractColor(r);if(a)return a;var n=parseInt(r.getAttribute("idx")||"0",10);return n>0&&n<=6&&this.themeExtractor?this.themeExtractor.getAccentColor(n):null}},{key:"extractShadow",value:function(e){var t=e.getElementsByTagName("a:effectLst")[0];if(!t)return null;var r=t.getElementsByTagName("a:outerShdw")[0];if(!r)return null;var a={},n=r.getAttribute("blurRad");if(n){var i=parseInt(n);a.blur=i/914400*96}var o=r.getAttribute("dist");if(o){var s=parseInt(o);a.distance=s/914400*96}var l=r.getAttribute("dir");l&&(a.angle=parseInt(l)/6e4);var c=r.getElementsByTagName("a:srgbClr")[0],u=r.getElementsByTagName("a:schemeClr")[0];if(c)a.color="#"+c.getAttribute("val");else if(u){var h=u.getAttribute("val");this.themeExtractor?a.color=this.themeExtractor.getSchemeColor(h)||"#000000":a.color="#000000"}else a.color="#000000";var d=r.getElementsByTagName("a:alpha")[0];if(d){var f=parseInt(d.getAttribute("val")||"100000");a.opacity=f/1e5}else a.opacity=1;return Object.keys(a).length>0?a:null}},{key:"extractCornerRadius",value:function(e){var t=e.getElementsByTagName("a:prstGeom")[0];if(!t)return null;var r=t.getAttribute("prst");if(!r)return null;var a={roundRect:.05,roundSquare:.05,round2SameRect:.1,round1Rect:.03,round2Rect:.1};if(!a[r])return null;var n=t.getElementsByTagName("a:adjLst")[0];if(n){var i=n.getElementsByTagName("a:adj")[0];if(i){var o=i.getAttribute("val");if(o)return parseInt(o)/1e5*.5}}return a[r]}},{key:"mapShapeType",value:function(e){var t={rect:"rect",square:"square",roundRect:"roundRect",roundSquare:"roundSquare",ellipse:"ellipse",circle:"circle",triangle:"triangle",isoscelesTriangle:"triangle",rtTriangle:"rightTriangle",parallelogram:"parallelogram",trapezoid:"trapezoid",diamond:"diamond",pentagon:"pentagon",hexagon:"hexagon",heptagon:"heptagon",octagon:"octagon",star4:"star4",star5:"star5",star6:"star6",arrow:"arrow",rightArrow:"rightArrow",leftArrow:"leftArrow",upArrow:"upArrow",downArrow:"downArrow",heart:"heart",lightningBolt:"lightning",sun:"sun",moon:"moon",cloud:"cloud",line:"line",straightConnector1:"line",speechBubble:"speechBubble",speechBubbleOval:"speechBubbleOval",calloutRectangle:"calloutRect",calloutRoundRect:"calloutRoundRect",calloutOval:"calloutOval",flowChartProcess:"flowChartProcess",flowChartDecision:"flowChartDecision",flowChartInputOutput:"flowChartInputOutput",flowChartTerminator:"flowChartTerminator",flowChartData:"flowChartData",flowChartDocument:"flowChartDocument",flowChartMultidocument:"flowChartMultidocument",flowChartPredefinedProcess:"flowChartPredefinedProcess",flowChartOffPageConnector:"flowChartOffPage",flowChartMerge:"flowChartMerge",flowChartExtract:"flowChartExtract",flowChartOr:"flowChartOr",flowChartSum:"flowChartSum",flowChartSort:"flowChartSort",flowChartManualInput:"flowChartManualInput",flowChartDelay:"flowChartDelay",cube:"cube",cylinder:"cylinder",sphere:"sphere",cone:"cone",pyramid:"pyramid",tetrahedron:"tetrahedron",octahedron:"octahedron",blockArcRight:"blockArcRight",blockArcLeft:"blockArcLeft",blockArcUp:"blockArcUp",blockArcDown:"blockArcDown",quadArrow:"quadArrow",leftRightArrow:"leftRightArrow",upDownArrow:"upDownArrow",ribbon:"ribbon",ribbon2:"ribbon2",doubleWave:"doubleWave",chevron:"chevron",chevronRight:"chevronRight",curvedUpArrow:"curvedUpArrow",curvedDownArrow:"curvedDownArrow",curvedLeftArrow:"curvedLeftArrow",curvedRightArrow:"curvedRightArrow",actionButtonHome:"actionHome",actionButtonHelp:"actionHelp",actionButtonInformation:"actionInfo",actionButtonSound:"actionSound",actionButtonMovie:"actionMovie",actionButtonDocument:"actionDocument",actionButtonReturn:"actionReturn",actionButtonForward:"actionForward",explosion1:"explosion16",explosion2:"explosion32",star7:"star7",star8:"star8",star10:"star10",star12:"star12",star16:"star16",star24:"star24",star32:"star32"}[e];return t||console.warn("[PPTX] Unmapped preset shape '".concat(e,"', defaulting to rect")),t||"rect"}},{key:"extractShapeText",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=e.getElementsByTagName("a:p"),o=[],s=12700,l=1e5,c=this.themeExtractor?this.themeExtractor.getDefaultTextColor():"#000000",u=this.themeExtractor?this.themeExtractor.getBodyFont():"Calibri",h=(null==r?void 0:r.color)||c,d=(null==r?void 0:r.fontFamily)||u,f=(null==r?void 0:r.fontSize)||null,p=(null==r?void 0:r.bold)||!1,g=(null==r?void 0:r.italic)||!1,m=(null==r?void 0:r.align)||"left",y=_createForOfIteratorHelper(i);try{for(y.s();!(t=y.n()).done;){var v=t.value,b=v.getElementsByTagName("a:pPr")[0],x=m,_=f,E=null,w=null,k=null,T=null,S=null,A=0,I=null,C=null,B=null;if(b){var N=b.getAttribute("algn");"ctr"===N?x="center":"r"===N?x="right":"just"===N?x="justify":"l"===N&&(x="left");var P=b.getAttribute("lvl");if(null!==P){var F=parseInt(P,10);Number.isNaN(F)||(A=Math.max(0,F))}var M=b.getAttribute("marL");if(null!==M){var L=parseInt(M,10);Number.isNaN(L)||(C=L/s/18)}var z=b.getAttribute("indent");if(null!==z){var D=parseInt(z,10);Number.isNaN(D)||(B=D/s/18)}if(b.getElementsByTagName("a:buNone")[0])I={type:"none"};else{var O=b.getElementsByTagName("a:buAutoNum")[0],U=b.getElementsByTagName("a:buChar")[0];O?I={type:"auto",numType:O.getAttribute("type")||null,startAt:O.getAttribute("startAt")?parseInt(O.getAttribute("startAt"),10):null}:U?I={type:"char",char:U.getAttribute("char")||""}:null!==P&&(I={type:"char",char:"",inferred:!0})}var R=b.getElementsByTagName("a:defRPr")[0];if(R){var H=R.getAttribute("sz");H&&(_=parseInt(H)/100);var j=R.getElementsByTagName("a:solidFill")[0];E=this.backgroundExtractor.extractColor(j);var W=R.getElementsByTagName("a:latin")[0];if(W){var G=W.getAttribute("typeface");G&&("+mj-lt"===G&&this.themeExtractor?w=this.themeExtractor.getTitleFont():"+mn-lt"===G&&this.themeExtractor?w=this.themeExtractor.getBodyFont():G.startsWith("+")||(w=G))}}var Z=function(e){if(!e)return null;var t=e.getElementsByTagName("a:spcPts")[0];if(t){var r=parseInt(t.getAttribute("val")||"0",10);if(!Number.isNaN(r))return r/1e3/18}var a=e.getElementsByTagName("a:spcPct")[0];if(a){var n=parseInt(a.getAttribute("val")||"0",10);if(!Number.isNaN(n))return n/l}return null};k=Z(b.getElementsByTagName("a:spcBef")[0]),T=Z(b.getElementsByTagName("a:spcAft")[0]);var X=b.getElementsByTagName("a:lnSpc")[0];if(X){var V=X.getElementsByTagName("a:spcPts")[0];if(V){var q=parseInt(V.getAttribute("val")||"0",10);Number.isNaN(q)||(S=q/1e3/18)}var K=X.getElementsByTagName("a:spcPct")[0];if(K){var Y=parseInt(K.getAttribute("val")||"0",10);Number.isNaN(Y)||(S=Y/l)}}}var Q,J=[],$=_createForOfIteratorHelper(Array.from(v.childNodes).filter(function(e){return e&&1===e.nodeType&&("a:r"===e.tagName||"a:fld"===e.tagName)}));try{for($.s();!(Q=$.n()).done;){var ee=Q.value,te="a:fld"===ee.tagName,re=ee.getElementsByTagName("a:t")[0],ae=re?re.textContent:"";if(te&&(ee.getAttribute("type")||"").toLowerCase().includes("slidenum")&&null!=n&&(ae=String(n)),ae){var ne=ee.getElementsByTagName("a:rPr")[0],ie=null,oe=!1,se=null,le=null,ce=p,ue=g,he=!1,de=!1,fe=!1,pe=!1,ge="none",me=null,ye=null,ve=null;if(ne){var be=ne.getElementsByTagName("a:solidFill")[0];oe=!!(ie=this.backgroundExtractor.extractColor(be));var xe=ne.getAttribute("sz");xe&&(se=parseInt(xe)/100);var _e=ne.getElementsByTagName("a:latin")[0];if(_e){var Ee=_e.getAttribute("typeface");Ee&&("+mj-lt"===Ee&&this.themeExtractor?le=this.themeExtractor.getTitleFont():"+mn-lt"===Ee&&this.themeExtractor?le=this.themeExtractor.getBodyFont():Ee.startsWith("+")||(le=Ee))}ne.hasAttribute("b")&&(ce="1"===ne.getAttribute("b")),ne.hasAttribute("i")&&(ue="1"===ne.getAttribute("i")),he=ne.getAttribute("u")&&"none"!==ne.getAttribute("u"),de=ne.getAttribute("strike")&&"noStrike"!==ne.getAttribute("strike");var we=ne.getAttribute("baseline");if(we){var ke=parseInt(we,10);Number.isNaN(ke)||(fe=ke>0,pe=ke<0)}var Te=ne.getAttribute("cap");"small"===Te?ge="small-caps":"all"===Te&&(ge="uppercase");var Se=ne.getElementsByTagName("a:highlight")[0];Se&&(me=this.backgroundExtractor.extractColor(Se)||"#ffff00");var Ae=ne.getElementsByTagName("a:outerShdw")[0];if(Ae){var Ie=parseInt(Ae.getAttribute("dist")||"0",10),Ce=parseInt(Ae.getAttribute("dir")||"2700000",10),Be=parseInt(Ae.getAttribute("blur")||"0",10),Ne=Ce*Math.PI/108e5,Pe=Ie/s*Math.cos(Ne),Fe=Ie/s*Math.sin(Ne),Me=Ae.getElementsByTagName("a:srgbClr")[0],Le=Me?Me.getAttribute("val"):"000000",ze=Ae.getElementsByTagName("a:alpha")[0],De=ze?parseInt(ze.getAttribute("val")||"100000",10)/1e5:1;ye={offsetX:Pe,offsetY:Fe,blur:Be/s,color:"#".concat(Le),opacity:De}}var Oe=ne.getElementsByTagName("a:hlinkClick")[0];if(Oe){var Ue=Oe.getAttribute("r:id")||Oe.getAttribute("id");Ue&&Array.isArray(a)&&(ve=this.resolveHyperlink(a,Ue))}}se||(se=_||f),ie||(ie=E||h),ve&&!oe&&!E&&this.themeExtractor&&(ie=this.themeExtractor.getHyperlinkColor()),le||(le=w||d),J.push({text:ae,color:ie,fontSize:se,fontFamily:le,bold:ce,italic:ue,underline:he,strikethrough:de,superscript:fe,subscript:pe,textTransform:ge,highlight:me,shadow:ye,link:ve,align:x})}}}catch(e){$.e(e)}finally{$.f()}if(0===J.length){var Re,He=_createForOfIteratorHelper(v.getElementsByTagName("a:t"));try{for(He.s();!(Re=He.n()).done;){var je=Re.value,We=null==je?void 0:je.textContent;We&&We.trim()&&J.push({text:We,color:E||h,fontSize:_||f,fontFamily:w||d,bold:p,italic:g,underline:!1,strikethrough:!1,superscript:!1,subscript:!1,textTransform:"none",highlight:null,shadow:null,link:null,align:x})}}catch(e){He.e(e)}finally{He.f()}}J.length>0&&(null===C&&r&&"number"==typeof r.marLEm&&(C=r.marLEm),null===B&&r&&"number"==typeof r.indentEm&&(B=r.indentEm),null===k&&r&&"number"==typeof r.spaceBeforeEm&&(k=r.spaceBeforeEm),null===T&&r&&"number"==typeof r.spaceAfterEm&&(T=r.spaceAfterEm),null===S&&r&&"number"==typeof r.lineHeight&&(S=r.lineHeight),J[0].lvl=A,I&&(J[0].bullet=I),"number"==typeof C&&(J[0].marLEm=C),"number"==typeof B&&(J[0].indentEm=B),"number"==typeof k&&(J[0].spaceBeforeEm=k),"number"==typeof T&&(J[0].spaceAfterEm=T),"number"==typeof S&&(J[0].lineHeight=S),o.push(J))}}catch(e){y.e(e)}finally{y.f()}return o.length>0?o:null}},{key:"resolveHyperlink",value:function(e,t){if(!Array.isArray(e)||!t)return null;var r=e.find(function(e){return e&&e.getAttribute&&e.getAttribute("Id")===t});if(!r)return null;var a=r.getAttribute("Target")||"";if("external"===(r.getAttribute("TargetMode")||"").toLowerCase()||/^https?:\/\//i.test(a)||/^mailto:/i.test(a))return{kind:"url",href:a};var n=a.match(/slide(\d+)\.xml$/i);return n?{kind:"slide",slideIndex:Math.max(0,parseInt(n[1],10)-1)}:{kind:"internal",target:a}}},{key:"getParagraphLevel",value:function(e){var t=e.getElementsByTagName("a:p")[0];if(t){var r=t.getElementsByTagName("a:pPr")[0];if(r){var a=r.getAttribute("lvl"),n=null!==a?parseInt(a,10):NaN;if(!Number.isNaN(n))return Math.min(9,Math.max(1,n+1))}}return 1}},{key:"extractCustomGeometry",value:function(e){if(!e)return null;var t={paths:[],bounds:{x:0,y:0,w:21600,h:21600},guides:[]},r=e.getAttribute("bbox");if(r){var a=r.split(" ");4===a.length&&(t.bounds={x:parseInt(a[0]),y:parseInt(a[1]),w:parseInt(a[2]),h:parseInt(a[3])})}var n=e.getElementsByTagName("a:gdLst")[0];if(n){var i,o=_createForOfIteratorHelper(n.getElementsByTagName("a:gd"));try{for(o.s();!(i=o.n()).done;){var s=i.value,l=s.getAttribute("name"),c=s.getAttribute("fmla");t.guides.push({name:l,fmla:c})}}catch(e){o.e(e)}finally{o.f()}}var u=e.getElementsByTagName("a:pathLst")[0];if(u){var h,d=_createForOfIteratorHelper(u.getElementsByTagName("a:path"));try{for(d.s();!(h=d.n()).done;){var f=h.value,p=parseInt(f.getAttribute("w")||t.bounds.w),g=parseInt(f.getAttribute("h")||t.bounds.h),m=f.getAttribute("fill")||"norm",y="false"!==f.getAttribute("stroke"),v=this.extractPathData(f,p,g);t.paths.push({data:v,w:p,h:g,fill:m,stroke:y})}}catch(e){d.e(e)}finally{d.f()}}return t.paths.length>0?t:null}},{key:"extractPathData",value:function(e,t,r){var a,n=[],i=_createForOfIteratorHelper(Array.from(e.childNodes).filter(function(e){return 1===e.nodeType}));try{for(i.s();!(a=i.n()).done;){var o=a.value,s=o.tagName;if("a:moveTo"===s){var l=o.getElementsByTagName("a:pt")[0];if(l){var c=parseInt(l.getAttribute("x")||"0")/t*100,u=parseInt(l.getAttribute("y")||"0")/r*100;n.push("M ".concat(c," ").concat(u))}}else if("a:lnTo"===s){var h=o.getElementsByTagName("a:pt")[0];if(h){var d=parseInt(h.getAttribute("x")||"0")/t*100,f=parseInt(h.getAttribute("y")||"0")/r*100;n.push("L ".concat(d," ").concat(f))}}else if("a:cubicBezTo"===s){var p=o.getElementsByTagName("a:pt");if(p.length>=3){var g=parseInt(p[0].getAttribute("x")||"0")/t*100,m=parseInt(p[0].getAttribute("y")||"0")/r*100,y=parseInt(p[1].getAttribute("x")||"0")/t*100,v=parseInt(p[1].getAttribute("y")||"0")/r*100,b=parseInt(p[2].getAttribute("x")||"0")/t*100,x=parseInt(p[2].getAttribute("y")||"0")/r*100;n.push("C ".concat(g," ").concat(m," ").concat(y," ").concat(v," ").concat(b," ").concat(x))}}else if("a:arcTo"===s){var _=o.getElementsByTagName("a:pt")[0];if(_){var E=parseInt(_.getAttribute("x")||"0")/t*100,w=parseInt(_.getAttribute("y")||"0")/r*100;n.push("L ".concat(E," ").concat(w))}}else"a:close"===s&&n.push("Z")}}catch(e){i.e(e)}finally{i.f()}return n.join(" ")}}])}();_defineProperty(ShapeParser,"SLIDE_WIDTH_EMU",9144e3),_defineProperty(ShapeParser,"SLIDE_HEIGHT_EMU",5143500),window.ShapeParser=ShapeParser;var LayoutTextStyleParser=function(){function e(t,r){_classCallCheck(this,e),this.backgroundExtractor=t,this.themeExtractor=r,this.textStylesCache=new Map}return _createClass(e,[{key:"parseTextStyles",value:function(e){var t=e.getElementsByTagName("p:txStyles")[0];if(!t)return null;var r={titleStyle:null,bodyStyle:null,otherStyle:null},a=t.getElementsByTagName("p:titleStyle")[0];a&&(r.titleStyle=this.parseLevelStyles(a));var n=t.getElementsByTagName("p:bodyStyle")[0];n&&(r.bodyStyle=this.parseLevelStyles(n));var i=t.getElementsByTagName("p:otherStyle")[0];return i&&(r.otherStyle=this.parseLevelStyles(i)),r}},{key:"parseLevelStyles",value:function(e){for(var t={},r=1;r<=9;r++){var a=e.getElementsByTagName("a:lvl".concat(r,"pPr"))[0];a&&(t[r]=this.parseLevelFormatting(a))}var n=e.getElementsByTagName("a:defPPr")[0];return n&&(t.default=this.parseLevelFormatting(n)),t}},{key:"parseLevelFormatting",value:function(t){var r={fontSize:null,fontFamily:null,color:null,bold:null,italic:null,align:null,marLEm:null,indentEm:null,spaceBeforeEm:null,spaceAfterEm:null,lineHeight:null},a=t.getAttribute("algn");"ctr"===a?r.align="center":"r"===a?r.align="right":"just"===a?r.align="justify":"l"===a&&(r.align="left");var n=t.getElementsByTagName("a:defRPr")[0];if(n){var i=n.getAttribute("sz");i&&(r.fontSize=parseInt(i)/100),"1"===n.getAttribute("b")&&(r.bold=!0),"1"===n.getAttribute("i")&&(r.italic=!0);var o=n.getElementsByTagName("a:latin")[0];if(o){var s=o.getAttribute("typeface");s&&("+mj-lt"===s&&this.themeExtractor?r.fontFamily=this.themeExtractor.getTitleFont():"+mn-lt"===s&&this.themeExtractor?r.fontFamily=this.themeExtractor.getBodyFont():s.startsWith("+")||(r.fontFamily=s))}var l=n.getElementsByTagName("a:solidFill")[0];l&&(r.color=this.backgroundExtractor.extractColor(l))}var c=t.getAttribute("marL");if(null!==c){var u=parseInt(c,10);Number.isNaN(u)||(r.marLEm=u/e.EMU_PER_POINT/e.BASE_FONT_SIZE_PT)}var h=t.getAttribute("indent");if(null!==h){var d=parseInt(h,10);Number.isNaN(d)||(r.indentEm=d/e.EMU_PER_POINT/e.BASE_FONT_SIZE_PT)}var f=function(t){if(!t)return null;var r=t.getElementsByTagName("a:spcPts")[0];if(r){var a=parseInt(r.getAttribute("val")||"0",10);if(!Number.isNaN(a))return a/1e3/e.BASE_FONT_SIZE_PT}var n=t.getElementsByTagName("a:spcPct")[0];if(n){var i=parseInt(n.getAttribute("val")||"0",10);if(!Number.isNaN(i))return i/e.PERCENT_DENOM}return null};r.spaceBeforeEm=f(t.getElementsByTagName("a:spcBef")[0]),r.spaceAfterEm=f(t.getElementsByTagName("a:spcAft")[0]);var p=t.getElementsByTagName("a:lnSpc")[0];if(p){var g=p.getElementsByTagName("a:spcPts")[0];if(g){var m=parseInt(g.getAttribute("val")||"0",10);Number.isNaN(m)||(r.lineHeight=m/1e3/e.BASE_FONT_SIZE_PT)}var y=p.getElementsByTagName("a:spcPct")[0];if(y){var v=parseInt(y.getAttribute("val")||"0",10);Number.isNaN(v)||(r.lineHeight=v/e.PERCENT_DENOM)}}return r}},{key:"cacheTextStyles",value:function(e,t){t&&this.textStylesCache.set(e,t)}},{key:"getTextStyleForPlaceholder",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=this.textStylesCache.get(e);if(!a)return null;var n;return(n="title"===t||"ctrTitle"===t||"subTitle"===t?a.titleStyle:"body"===t||"obj"===t||"content"===t?a.bodyStyle:a.otherStyle||a.bodyStyle)&&(n[r]||n[1]||n.default)||null}},{key:"getTextDefaults",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a={fontSize:null,fontFamily:this.themeExtractor?this.themeExtractor.getBodyFont():"Calibri",color:this.themeExtractor?this.themeExtractor.getDefaultTextColor():"#000000",bold:!1,italic:!1,align:"left",marLEm:null,indentEm:null,spaceBeforeEm:null,spaceAfterEm:null,lineHeight:null};"title"!==t&&"ctrTitle"!==t&&"subTitle"!==t||(a.fontFamily=this.themeExtractor?this.themeExtractor.getTitleFont():"Calibri Light");var n=this.getTextStyleForPlaceholder(e,t,r);return n&&(n.fontSize&&(a.fontSize=n.fontSize),n.fontFamily&&(a.fontFamily=n.fontFamily),n.color&&(a.color=n.color),null!==n.bold&&(a.bold=n.bold),null!==n.italic&&(a.italic=n.italic),n.align&&(a.align=n.align),null!==n.marLEm&&void 0!==n.marLEm&&(a.marLEm=n.marLEm),null!==n.indentEm&&void 0!==n.indentEm&&(a.indentEm=n.indentEm),null!==n.spaceBeforeEm&&void 0!==n.spaceBeforeEm&&(a.spaceBeforeEm=n.spaceBeforeEm),null!==n.spaceAfterEm&&void 0!==n.spaceAfterEm&&(a.spaceAfterEm=n.spaceAfterEm),null!==n.lineHeight&&void 0!==n.lineHeight&&(a.lineHeight=n.lineHeight)),a}},{key:"extractShapeText",value:function(e){var t,r=e.getElementsByTagName("a:p"),a=[],n=this.themeExtractor?this.themeExtractor.getDefaultTextColor():"#000000",i=this.themeExtractor?this.themeExtractor.getBodyFont():"Calibri",o=_createForOfIteratorHelper(r);try{for(o.s();!(t=o.n()).done;){var s=t.value,l=s.getElementsByTagName("a:pPr")[0],c="left",u=null,h=null,d=null,f=!1,p=!1;if(l){var g=l.getAttribute("algn");"ctr"===g?c="center":"r"===g?c="right":"just"===g?c="justify":"l"===g&&(c="left");var m=l.getElementsByTagName("a:defRPr")[0];if(m){var y=m.getAttribute("sz");y&&(u=parseInt(y)/100);var v=m.getElementsByTagName("a:solidFill")[0];h=this.backgroundExtractor.extractColor(v);var b=m.getElementsByTagName("a:latin")[0];if(b){var x=b.getAttribute("typeface");x&&("+mj-lt"===x&&this.themeExtractor?d=this.themeExtractor.getTitleFont():"+mn-lt"===x&&this.themeExtractor?d=this.themeExtractor.getBodyFont():x.startsWith("+")||(d=x))}"1"===m.getAttribute("b")&&(f=!0),"1"===m.getAttribute("i")&&(p=!0)}}var _,E=s.getElementsByTagName("a:r"),w=[],k=_createForOfIteratorHelper(E);try{for(k.s();!(_=k.n()).done;){var T=_.value,S=T.getElementsByTagName("a:t")[0];if(S&&S.textContent){var A=T.getElementsByTagName("a:rPr")[0],I=null,C=null,B=null,N=f,P=p;if(A){var F=A.getElementsByTagName("a:solidFill")[0];I=this.backgroundExtractor.extractColor(F);var M=A.getAttribute("sz");M&&(C=parseInt(M)/100);var L=A.getElementsByTagName("a:latin")[0];if(L){var z=L.getAttribute("typeface");z&&("+mj-lt"===z&&this.themeExtractor?B=this.themeExtractor.getTitleFont():"+mn-lt"===z&&this.themeExtractor?B=this.themeExtractor.getBodyFont():z.startsWith("+")||(B=z))}A.hasAttribute("b")&&(N="1"===A.getAttribute("b")),A.hasAttribute("i")&&(P="1"===A.getAttribute("i"))}C||(C=u),I||(I=h||n),B||(B=d||i),w.push({text:S.textContent,color:I,fontSize:C,fontFamily:B,bold:N,italic:P,align:c})}}}catch(e){k.e(e)}finally{k.f()}w.length>0&&a.push(w)}}catch(e){o.e(e)}finally{o.f()}return a.length>0?a:null}},{key:"clearCache",value:function(){this.textStylesCache.clear()}},{key:"parseLayoutPlaceholderStyles",value:function(e){var t;if(!e)return null;var r=new Map,a=null===(t=e.getElementsByTagName("p:cSld")[0])||void 0===t?void 0:t.getElementsByTagName("p:spTree")[0];if(!a)return null;for(var n=0,i=Array.from(a.getElementsByTagName("p:sp"));n<i.length;n++){var o=i[n],s=o.getElementsByTagName("p:ph")[0],l=(null==s?void 0:s.getAttribute("type"))||null,c=(null==s?void 0:s.getAttribute("idx"))||null;if(l){var u=o.getElementsByTagName("p:txBody")[0],h=null==u?void 0:u.getElementsByTagName("a:lstStyle")[0];if(h){for(var d={},f=1;f<=9;f++){var p=h.getElementsByTagName("a:lvl".concat(f,"pPr"))[0];p&&(d[f]=this.parseLevelFormatting(p))}var g=h.getElementsByTagName("a:defPPr")[0];g&&(d.default=this.parseLevelFormatting(g)),Object.keys(d).length>0&&null!==c&&r.set("".concat(l,":").concat(c),d)}}}return r.size>0?r:null}}])}();_defineProperty(LayoutTextStyleParser,"EMU_PER_POINT",12700),_defineProperty(LayoutTextStyleParser,"BASE_FONT_SIZE_PT",18),_defineProperty(LayoutTextStyleParser,"PERCENT_DENOM",1e5),window.LayoutTextStyleParser=LayoutTextStyleParser;var LayoutShapeParser=function(){function e(t,r,a){_classCallCheck(this,e),this.backgroundExtractor=t,this.themeExtractor=r,this.images=a}return _createClass(e,[{key:"parseLayoutShape",value:function(t,r){var a=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=t.getElementsByTagName("p:cNvPr")[0],o=i?i.getAttribute("id"):null,s={type:"rect",x:0,y:0,width:100,height:100,fill:null,stroke:null,strokeWidth:1,rotation:0,text:null,isPlaceholder:!1,placeholderType:null,placeholderIdx:null,fromLayout:!0,shadow:null,cornerRadius:null,customGeometry:null,shapeId:o?parseInt(o,10):null},l=t.getElementsByTagName("p:nvSpPr")[0];if(l){var c=l.getElementsByTagName("p:nvPr")[0];if(c){var u=c.getElementsByTagName("p:ph")[0];u&&(s.isPlaceholder=!0,s.placeholderType=u.getAttribute("type")||"body",s.placeholderIdx=u.getAttribute("idx"))}}var h=t.getElementsByTagName("p:spPr")[0];if(!h)return s;var d=h.getElementsByTagName("a:xfrm")[0];if(d){var f=d.getElementsByTagName("a:off")[0],p=d.getElementsByTagName("a:ext")[0];f&&(s.x=parseInt(f.getAttribute("x")||"0")/e.SLIDE_WIDTH_EMU*100,s.y=parseInt(f.getAttribute("y")||"0")/e.SLIDE_HEIGHT_EMU*100),p&&(s.width=parseInt(p.getAttribute("cx")||"0")/e.SLIDE_WIDTH_EMU*100,s.height=parseInt(p.getAttribute("cy")||"0")/e.SLIDE_HEIGHT_EMU*100);var g=d.getAttribute("rot");g&&(s.rotation=parseInt(g,10)/6e4)}var m=h.getElementsByTagName("a:prstGeom")[0];if(m){var y=m.getAttribute("prst")||"rect";s.type=this.mapShapeType(y)}var v=h.getElementsByTagName("a:custGeom")[0];v&&(s.customGeometry=this.extractCustomGeometry(v),s.customGeometry&&(s.type="custom")),s.shadow=this.extractShadow(h),s.cornerRadius=this.extractCornerRadius(h);var b=h.getElementsByTagName("a:solidFill")[0],x=h.getElementsByTagName("a:gradFill")[0],_=h.getElementsByTagName("a:blipFill")[0];if(h.getElementsByTagName("a:noFill")[0])s.fill="none";else if(b){var E=this.backgroundExtractor.extractColorWithOpacity(b);E&&(E.opacity<1?s.fill={type:"solid",color:E.color,opacity:E.opacity}:s.fill=E.color)}else if(x)s.fill={type:"gradient",gradient:this.backgroundExtractor.extractGradient(x)};else if(_){var w=_.getElementsByTagName("a:blip")[0];if(w){var k=w.getElementsByTagName("asvg:svgBlip")[0],T=k?k.getAttribute("r:embed"):null,S=w.getAttribute("r:embed"),A=function(e){if(!e)return null;var t=r.find(function(t){return t.getAttribute("Id")===e});if(t){var n=t.getAttribute("Target").split("/").pop();return a.images[n]||null}return null},I=A(T),C=A(S),B=I||C;B&&(s.fill={type:"image",src:B})}}s.fill||(s.fill=this.extractStyleFill(t));var N=h.getElementsByTagName("a:ln")[0];if(N){var P=N.getAttribute("w");P&&(s.strokeWidth=parseInt(P)/914400*96);var F=N.getElementsByTagName("a:solidFill")[0];N.getElementsByTagName("a:noFill")[0]?s.stroke="none":F&&(s.stroke=this.backgroundExtractor.extractColor(F))}null===s.stroke&&(s.stroke=this.extractStyleStroke(t));var M=t.getElementsByTagName("p:txBody")[0];if(!s.isPlaceholder&&M&&n&&(s.text=n.extractShapeText(M)),M){var L=M.getElementsByTagName("a:bodyPr")[0];if(L){var z=L.getAttribute("anchor");"b"===z?s.textVAlign="bottom":"ctr"===z?s.textVAlign="middle":"t"===z&&(s.textVAlign="top");var D=L.getAttribute("wrap");s.textWrap="none"!==D,L.getElementsByTagName("a:normAutofit")[0]?s.textAutoFit="norm":L.getElementsByTagName("a:noAutofit")[0]&&(s.textAutoFit="none");var O=91440,U=L.getAttribute("lIns")?parseInt(L.getAttribute("lIns"),10):O,R=L.getAttribute("rIns")?parseInt(L.getAttribute("rIns"),10):O,H=L.getAttribute("tIns")?parseInt(L.getAttribute("tIns"),10):O,j=L.getAttribute("bIns")?parseInt(L.getAttribute("bIns"),10):O;s.textInsetsEMU={left:U,right:R,top:H,bottom:j}}}return s}},{key:"mapShapeType",value:function(e){return{rect:"rect",square:"square",roundRect:"roundRect",roundSquare:"roundSquare",ellipse:"ellipse",circle:"circle",triangle:"triangle",isoscelesTriangle:"triangle",rtTriangle:"rightTriangle",parallelogram:"parallelogram",trapezoid:"trapezoid",diamond:"diamond",pentagon:"pentagon",hexagon:"hexagon",heptagon:"heptagon",octagon:"octagon",star4:"star4",star5:"star5",star6:"star6",arrow:"arrow",rightArrow:"rightArrow",leftArrow:"leftArrow",upArrow:"upArrow",downArrow:"downArrow",heart:"heart",lightningBolt:"lightning",sun:"sun",moon:"moon",cloud:"cloud",line:"line",straightConnector1:"line",speechBubble:"speechBubble",speechBubbleOval:"speechBubbleOval",calloutRectangle:"calloutRect",calloutRoundRect:"calloutRoundRect",calloutOval:"calloutOval",flowChartProcess:"flowChartProcess",flowChartDecision:"flowChartDecision",flowChartInputOutput:"flowChartInputOutput",flowChartTerminator:"flowChartTerminator",flowChartData:"flowChartData",flowChartDocument:"flowChartDocument",flowChartMultidocument:"flowChartMultidocument",flowChartPredefinedProcess:"flowChartPredefinedProcess",flowChartOffPageConnector:"flowChartOffPage",flowChartMerge:"flowChartMerge",flowChartExtract:"flowChartExtract",flowChartOr:"flowChartOr",flowChartSum:"flowChartSum",flowChartSort:"flowChartSort",flowChartManualInput:"flowChartManualInput",flowChartDelay:"flowChartDelay",cube:"cube",cylinder:"cylinder",sphere:"sphere",cone:"cone",pyramid:"pyramid",tetrahedron:"tetrahedron",octahedron:"octahedron",blockArcRight:"blockArcRight",blockArcLeft:"blockArcLeft",blockArcUp:"blockArcUp",blockArcDown:"blockArcDown",quadArrow:"quadArrow",leftRightArrow:"leftRightArrow",upDownArrow:"upDownArrow",ribbon:"ribbon",ribbon2:"ribbon2",doubleWave:"doubleWave",chevron:"chevron",chevronRight:"chevronRight",curvedUpArrow:"curvedUpArrow",curvedDownArrow:"curvedDownArrow",curvedLeftArrow:"curvedLeftArrow",curvedRightArrow:"curvedRightArrow",actionButtonHome:"actionHome",actionButtonHelp:"actionHelp",actionButtonInformation:"actionInfo",actionButtonSound:"actionSound",actionButtonMovie:"actionMovie",actionButtonDocument:"actionDocument",actionButtonReturn:"actionReturn",actionButtonForward:"actionForward",explosion1:"explosion16",explosion2:"explosion32",star7:"star7",star8:"star8",star10:"star10",star12:"star12",star16:"star16",star24:"star24",star32:"star32"}[e]||e||"rect"}},{key:"extractStyleFill",value:function(e){var t=e.getElementsByTagName("p:style")[0];if(!t)return null;var r=t.getElementsByTagName("a:fillRef")[0];if(!r)return null;var a=parseInt(r.getAttribute("idx")||"0",10),n=this.backgroundExtractor.extractColor(r);if(n)return n;if(a>0&&a<=6&&this.themeExtractor){var i=this.themeExtractor.getAccentColor(a);if(i)return i}if(this.themeExtractor&&"function"==typeof this.themeExtractor.getFillStyleNode){var o=this.themeExtractor.getFillStyleNode(a);if(o){var s=o.tagName;if("a:solidFill"===s)return this.backgroundExtractor.extractColor(o);if("a:gradFill"===s)return{type:"gradient",gradient:this.backgroundExtractor.extractGradient(o)};if("a:pattFill"===s){var l=o.getElementsByTagName("a:fgClr")[0],c=o.getElementsByTagName("a:bgClr")[0];return this.backgroundExtractor.extractColor(l)||this.backgroundExtractor.extractColor(c)}if("a:blipFill"===s){var u=o.getElementsByTagName("a:blip")[0],h=u?u.getAttribute("r:embed"):null;if(h&&this.themeExtractor&&"function"==typeof this.themeExtractor.resolveThemeImageUrl){var d=this.themeExtractor.resolveThemeImageUrl(h,this.images);if(d)return{type:"image",src:d}}}}}return null}},{key:"extractStyleStroke",value:function(e){var t=e.getElementsByTagName("p:style")[0];if(!t)return null;var r=t.getElementsByTagName("a:lnRef")[0];if(!r)return null;var a=this.backgroundExtractor.extractColor(r);if(a)return a;var n=parseInt(r.getAttribute("idx")||"0",10);return n>0&&n<=6&&this.themeExtractor?this.themeExtractor.getAccentColor(n):null}},{key:"parseLayoutPicture",value:function(t,r){var a={type:"picture",x:0,y:0,width:100,height:100,src:null,fromLayout:!0};try{var n=t.getElementsByTagName("p:blipFill")[0];if(n){var i=n.getElementsByTagName("a:blip")[0];if(i){var o=i.getAttribute("r:embed");if(o){var s=r.find(function(e){return e.getAttribute("Id")===o});if(s){var l=s.getAttribute("Target").split("/").pop();this.images[l]&&(a.src=this.images[l])}}}}var c=t.getElementsByTagName("p:spPr")[0];if(c){var u=c.getElementsByTagName("a:xfrm")[0];if(u){var h=u.getElementsByTagName("a:off")[0],d=u.getElementsByTagName("a:ext")[0];h&&(a.x=parseInt(h.getAttribute("x")||"0")/e.SLIDE_WIDTH_EMU*100,a.y=parseInt(h.getAttribute("y")||"0")/e.SLIDE_HEIGHT_EMU*100),d&&(a.width=parseInt(d.getAttribute("cx")||"0")/e.SLIDE_WIDTH_EMU*100,a.height=parseInt(d.getAttribute("cy")||"0")/e.SLIDE_HEIGHT_EMU*100)}}return a.src?a:null}catch(e){return null}}},{key:"parseGroupShape",value:function(t,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=[],i=t.getElementsByTagName("p:grpSpPr")[0],o=0,s=0,l=1,c=1;if(i){var u=i.getElementsByTagName("a:xfrm")[0];if(u){var h=u.getElementsByTagName("a:off")[0],d=u.getElementsByTagName("a:chOff")[0],f=u.getElementsByTagName("a:ext")[0],p=u.getElementsByTagName("a:chExt")[0];if(h&&d&&(o=(parseInt(h.getAttribute("x")||"0")-parseInt(d.getAttribute("x")||"0"))/e.SLIDE_WIDTH_EMU*100,s=(parseInt(h.getAttribute("y")||"0")-parseInt(d.getAttribute("y")||"0"))/e.SLIDE_HEIGHT_EMU*100),f&&p){var g=parseInt(f.getAttribute("cx")||"1"),m=parseInt(p.getAttribute("cx")||"1"),y=parseInt(f.getAttribute("cy")||"1"),v=parseInt(p.getAttribute("cy")||"1");m>0&&(l=g/m),v>0&&(c=y/v)}}}var b,x=_createForOfIteratorHelper(t.children);try{for(x.s();!(b=x.n()).done;){var _=b.value,E=_.tagName,w=null;if("p:sp"===E)w=this.parseLayoutShape(_,r,a);else if("p:pic"===E)w=this.parseLayoutPicture(_,r);else if("p:cxnSp"===E)w=this.parseConnectionShape(_,r);else if("p:grpSp"===E){var k,T=_createForOfIteratorHelper(this.parseGroupShape(_,r,a));try{for(T.s();!(k=T.n()).done;){var S=k.value;S.x=S.x*l+o,S.y=S.y*c+s,S.width=S.width*l,S.height=S.height*c,n.push(S)}}catch(e){T.e(e)}finally{T.f()}continue}w&&!w.isPlaceholder&&(w.x=w.x*l+o,w.y=w.y*c+s,w.width=w.width*l,w.height=w.height*c,n.push(w))}}catch(e){x.e(e)}finally{x.f()}return n}},{key:"parseConnectionShape",value:function(t,r){var a=t.getElementsByTagName("p:cNvPr")[0],n=a?a.getAttribute("id"):null,i=t.getElementsByTagName("p:cNvCxnSpPr")[0],o=null==i?void 0:i.getElementsByTagName("a:stCxn")[0],s=null==i?void 0:i.getElementsByTagName("a:endCxn")[0],l={type:"line",x:0,y:0,width:0,height:0,fill:"none",stroke:null,strokeWidth:1,rotation:0,fromLayout:!0,shapeId:n?parseInt(n,10):null,startCxn:o?{shapeId:parseInt(o.getAttribute("id")||"-1",10),idx:parseInt(o.getAttribute("idx")||"-1",10)}:null,endCxn:s?{shapeId:parseInt(s.getAttribute("id")||"-1",10),idx:parseInt(s.getAttribute("idx")||"-1",10)}:null},c=t.getElementsByTagName("p:spPr")[0];if(!c)return null;var u=c.getElementsByTagName("a:xfrm")[0];if(u){var h=u.getElementsByTagName("a:off")[0],d=u.getElementsByTagName("a:ext")[0];h&&(l.x=parseInt(h.getAttribute("x")||"0")/e.SLIDE_WIDTH_EMU*100,l.y=parseInt(h.getAttribute("y")||"0")/e.SLIDE_HEIGHT_EMU*100),d&&(l.width=parseInt(d.getAttribute("cx")||"0")/e.SLIDE_WIDTH_EMU*100,l.height=parseInt(d.getAttribute("cy")||"0")/e.SLIDE_HEIGHT_EMU*100);var f=u.getAttribute("rot");f&&(l.rotation=parseInt(f)/6e4),"1"===u.getAttribute("flipH")&&(l.flipH=!0),"1"===u.getAttribute("flipV")&&(l.flipV=!0)}var p=c.getElementsByTagName("a:prstGeom")[0];p&&(l.type=p.getAttribute("prst")||"line");var g=c.getElementsByTagName("a:ln")[0];if(g){var m=g.getAttribute("w");m&&(l.strokeWidth=parseInt(m)/914400*96);var y=g.getElementsByTagName("a:solidFill")[0];y&&(l.stroke=this.backgroundExtractor.extractColor(y));var v=g.getElementsByTagName("a:headEnd")[0];v&&v.getAttribute("type")&&"none"!==v.getAttribute("type")&&(l.arrowHead=v.getAttribute("type"));var b=g.getElementsByTagName("a:tailEnd")[0];b&&b.getAttribute("type")&&"none"!==b.getAttribute("type")&&(l.arrowTail=b.getAttribute("type"))}return l.stroke||(l.stroke=this.themeExtractor?this.themeExtractor.getDefaultTextColor():"#000000"),l}},{key:"extractShadow",value:function(e){var t=e.getElementsByTagName("a:effectLst")[0];if(!t)return null;var r=t.getElementsByTagName("a:outerShdw")[0];if(!r)return null;var a={},n=r.getAttribute("blurRad");if(n){var i=parseInt(n);a.blur=i/914400*96}var o=r.getAttribute("dist");if(o){var s=parseInt(o);a.distance=s/914400*96}var l=r.getAttribute("dir");l&&(a.angle=parseInt(l)/6e4);var c=r.getElementsByTagName("a:srgbClr")[0],u=r.getElementsByTagName("a:schemeClr")[0];if(c)a.color="#"+c.getAttribute("val");else if(u){var h=u.getAttribute("val");this.themeExtractor?a.color=this.themeExtractor.getSchemeColor(h)||"#000000":a.color="#000000"}else a.color="#000000";var d=r.getElementsByTagName("a:alpha")[0];if(d){var f=parseInt(d.getAttribute("val")||"100000");a.opacity=f/1e5}else a.opacity=1;return Object.keys(a).length>0?a:null}},{key:"extractCornerRadius",value:function(e){var t=e.getElementsByTagName("a:prstGeom")[0];if(!t)return null;var r=t.getAttribute("prst");if(!r)return null;var a={roundRect:.05,roundSquare:.05,round2SameRect:.1,round1Rect:.03,round2Rect:.1};if(!a[r])return null;var n=t.getElementsByTagName("a:adjLst")[0];if(n){var i=n.getElementsByTagName("a:adj")[0];if(i){var o=i.getAttribute("val");if(o)return parseInt(o)/1e5*.5}}return a[r]}},{key:"extractCustomGeometry",value:function(e){if(!e)return null;var t={paths:[],bounds:{x:0,y:0,w:21600,h:21600},guides:[]},r=e.getAttribute("bbox");if(r){var a=r.split(" ");4===a.length&&(t.bounds={x:parseInt(a[0]),y:parseInt(a[1]),w:parseInt(a[2]),h:parseInt(a[3])})}var n=e.getElementsByTagName("a:gdLst")[0];if(n){var i,o=_createForOfIteratorHelper(n.getElementsByTagName("a:gd"));try{for(o.s();!(i=o.n()).done;){var s=i.value,l=s.getAttribute("name"),c=s.getAttribute("fmla");t.guides.push({name:l,fmla:c})}}catch(e){o.e(e)}finally{o.f()}}var u=e.getElementsByTagName("a:pathLst")[0];if(u){var h,d=_createForOfIteratorHelper(u.getElementsByTagName("a:path"));try{for(d.s();!(h=d.n()).done;){var f=h.value,p=parseInt(f.getAttribute("w")||t.bounds.w),g=parseInt(f.getAttribute("h")||t.bounds.h),m=f.getAttribute("fill")||"norm",y="false"!==f.getAttribute("stroke"),v=this.extractPathData(f,p,g);t.paths.push({data:v,w:p,h:g,fill:m,stroke:y})}}catch(e){d.e(e)}finally{d.f()}}return t.paths.length>0?t:null}},{key:"extractPathData",value:function(e,t,r){var a,n=[],i=_createForOfIteratorHelper(Array.from(e.childNodes).filter(function(e){return 1===e.nodeType}));try{for(i.s();!(a=i.n()).done;){var o=a.value,s=o.tagName;if("a:moveTo"===s){var l=o.getElementsByTagName("a:pt")[0];if(l){var c=parseInt(l.getAttribute("x")||"0")/t*100,u=parseInt(l.getAttribute("y")||"0")/r*100;n.push("M ".concat(c," ").concat(u))}}else if("a:lnTo"===s){var h=o.getElementsByTagName("a:pt")[0];if(h){var d=parseInt(h.getAttribute("x")||"0")/t*100,f=parseInt(h.getAttribute("y")||"0")/r*100;n.push("L ".concat(d," ").concat(f))}}else if("a:cubicBezTo"===s){var p=o.getElementsByTagName("a:pt");if(p.length>=3){var g=parseInt(p[0].getAttribute("x")||"0")/t*100,m=parseInt(p[0].getAttribute("y")||"0")/r*100,y=parseInt(p[1].getAttribute("x")||"0")/t*100,v=parseInt(p[1].getAttribute("y")||"0")/r*100,b=parseInt(p[2].getAttribute("x")||"0")/t*100,x=parseInt(p[2].getAttribute("y")||"0")/r*100;n.push("C ".concat(g," ").concat(m," ").concat(y," ").concat(v," ").concat(b," ").concat(x))}}else if("a:arcTo"===s){var _=o.getElementsByTagName("a:pt")[0];if(_){var E=parseInt(_.getAttribute("x")||"0")/t*100,w=parseInt(_.getAttribute("y")||"0")/r*100;n.push("L ".concat(E," ").concat(w))}}else"a:close"===s&&n.push("Z")}}catch(e){i.e(e)}finally{i.f()}return n.join(" ")}}])}();_defineProperty(LayoutShapeParser,"SLIDE_WIDTH_EMU",9144e3),_defineProperty(LayoutShapeParser,"SLIDE_HEIGHT_EMU",5143500),window.LayoutShapeParser=LayoutShapeParser;var LayoutParser=function(){function e(t,r,a,n,i){_classCallCheck(this,e),this.zip=t,this.xmlParser=r,this.backgroundExtractor=a,this.themeExtractor=n,this.images=i,this.textStyleParser=new LayoutTextStyleParser(a,n),this.shapeParser=new LayoutShapeParser(a,n,i),this.layoutCache=new Map,this.masterCache=new Map}return _createClass(e,[{key:"parseLayout",value:(a=_asyncToGenerator(_regenerator().m(function t(r){var a,n,i,o,s,l,c,u,h,d,f,p,g,m;return _regenerator().w(function(t){for(;;)switch(t.p=t.n){case 0:if(!this.layoutCache.has(r)){t.n=1;break}return t.a(2,this.layoutCache.get(r));case 1:if(a={shapes:[],placeholders:new Map,textStyles:new Map,masterPath:null,_placeholderMaxOrder:-1},t.p=2,i=this.zip.file(r)){t.n=3;break}return t.a(2,a);case 3:return t.n=4,i.async("string");case 4:if(o=t.v,s=this.xmlParser.parseFromString(o,"text/xml"),l=r.replace("ppt/slideLayouts/","ppt/slideLayouts/_rels/").replace(".xml",".xml.rels"),c=[],t.p=5,!(u=this.zip.file(l))){t.n=7;break}return t.n=6,u.async("string");case 6:h=t.v,d=this.xmlParser.parseFromString(h,"text/xml"),c=Array.from(d.getElementsByTagName("Relationship")),(f=c.find(function(e){return(e.getAttribute("Type")||"").includes("slideMaster")}))&&(a.masterPath=e.resolveTarget(r,f.getAttribute("Target")));case 7:t.n=9;break;case 8:t.p=8,t.v;case 9:return(p=null===(n=s.getElementsByTagName("p:cSld")[0])||void 0===n?void 0:n.getElementsByTagName("p:spTree")[0])&&this.parseShapeTree(p,c,a),(g=this.textStyleParser.parseLayoutPlaceholderStyles(s))&&(a.textStyles=g),this.layoutCache.set(r,a),t.a(2,a);case 10:return t.p=10,m=t.v,console.warn("Error parsing layout:",m),t.a(2,a)}},t,this,[[5,8],[2,10]])})),function(e){return a.apply(this,arguments)})},{key:"parseMaster",value:(r=_asyncToGenerator(_regenerator().m(function e(t){var r,a,n,i,o,s,l,c,u,h,d,f,p;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!this.masterCache.has(t)){e.n=1;break}return e.a(2,this.masterCache.get(t));case 1:if(r={shapes:[],placeholders:new Map,_placeholderMaxOrder:-1},e.p=2,n=this.zip.file(t)){e.n=3;break}return e.a(2,r);case 3:return e.n=4,n.async("string");case 4:if(i=e.v,o=this.xmlParser.parseFromString(i,"text/xml"),s=t.replace("ppt/slideMasters/","ppt/slideMasters/_rels/").replace(".xml",".xml.rels"),l=[],e.p=5,!(c=this.zip.file(s))){e.n=7;break}return e.n=6,c.async("string");case 6:u=e.v,h=this.xmlParser.parseFromString(u,"text/xml"),l=Array.from(h.getElementsByTagName("Relationship"));case 7:e.n=9;break;case 8:e.p=8,e.v;case 9:return(d=null===(a=o.getElementsByTagName("p:cSld")[0])||void 0===a?void 0:a.getElementsByTagName("p:spTree")[0])&&this.parseShapeTree(d,l,r),(f=this.textStyleParser.parseTextStyles(o))&&(r.textStyles=f,this.textStyleParser.cacheTextStyles(t,f)),this.masterCache.set(t,r),e.a(2,r);case 10:return e.p=10,p=e.v,console.warn("Error parsing master:",p),e.a(2,r)}},e,this,[[5,8],[2,10]])})),function(e){return r.apply(this,arguments)})},{key:"parseShapeTree",value:function(t,r,a){for(var n=Array.from(t.children),i=function(e){var t=e.placeholderType||"body",r=a.placeholders.get(t);Array.isArray(r)?(r.push(e),a.placeholders.set(t,r)):r?a.placeholders.set(t,[r,e]):a.placeholders.set(t,[e])},o=function(t){var r=null==t?void 0:t.getElementsByTagName("p:grpSpPr")[0],a=null==r?void 0:r.getElementsByTagName("a:xfrm")[0];if(!a)return!1;var n=a.getElementsByTagName("a:off")[0],i=a.getElementsByTagName("a:ext")[0];if(!n||!i)return!1;var o=parseInt(n.getAttribute("x")||"0",10)/e.SLIDE_WIDTH_EMU*100,s=parseInt(n.getAttribute("y")||"0",10)/e.SLIDE_HEIGHT_EMU*100,l=parseInt(i.getAttribute("cx")||"0",10)/e.SLIDE_WIDTH_EMU*100,c=parseInt(i.getAttribute("cy")||"0",10)/e.SLIDE_HEIGHT_EMU*100,u=function(e){return Math.abs(e)<=1};return u(o)&&u(s)&&l>=98&&c>=98},s=0;s<n.length;s++){var l=n[s],c=l.tagName;if("p:sp"===c){var u,h=this.shapeParser.parseLayoutShape(l,r,this.textStyleParser);h&&(h.isPlaceholder?(i(h),a._placeholderMaxOrder=Math.max(null!==(u=a._placeholderMaxOrder)&&void 0!==u?u:-1,s)):(h._treeOrder=s,a.shapes.push(h)))}else if("p:pic"===c){var d=this.shapeParser.parseLayoutPicture(l,r);d&&(d._treeOrder=s,a.shapes.push(d))}else if("p:grpSp"===c){for(var f,p=o(l),g=this.shapeParser.parseGroupShape(l,r,this.textStyleParser),m=0;m<g.length;m++)g[m]._treeOrder=s+m/1e3,p&&(g[m]._groupIsBackground=!0);(f=a.shapes).push.apply(f,_toConsumableArray(g))}else if("p:cxnSp"===c){var y=this.shapeParser.parseConnectionShape(l,r);y&&(y._treeOrder=s,a.shapes.push(y))}}}},{key:"getMergedShapes",value:(t=_asyncToGenerator(_regenerator().m(function e(t){var r,a,n,i,o,s,l,c,u,h,d,f,p,g,m,y,v,b,x,_,E,w,k,T,S,A,I,C,B,N,P,F,M,L,z,D,O,U,R,H,j=arguments;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(r=j.length>1&&void 0!==j[1]?j[1]:[],a=[],n=0,i=null,o=null,s=null,l=null,c=function(e){return!(!e||e.isPlaceholder||!0!==e._groupIsBackground&&"background"!==e.type)},u=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).slice().sort(function(e,t){var r="number"==typeof(null==e?void 0:e._treeOrder)?e._treeOrder:Number.POSITIVE_INFINITY,a="number"==typeof(null==t?void 0:t._treeOrder)?t._treeOrder:Number.POSITIVE_INFINITY;return r!==a?r-a:0})},h=function(e){var t,r=[],a=[],n=_createForOfIteratorHelper(e||[]);try{for(n.s();!(t=n.n()).done;){var i=t.value;c(i)?r.push(i):a.push(i)}}catch(e){n.e(e)}finally{n.f()}return{bg:u(r),fg:u(a)}},d=function(e){var t=(null==e?void 0:e.shapes)||[],r="number"==typeof(null==e?void 0:e._placeholderMaxOrder)?e._placeholderMaxOrder:-1;if(r<0)return{bg:t.slice(),fg:[]};var a,n=[],i=[],o=_createForOfIteratorHelper(t);try{for(o.s();!(a=o.n()).done;){var s=a.value;c(s)?n.push(s):("number"==typeof s._treeOrder?s._treeOrder:-1)>r?i.push(s):n.push(s)}}catch(e){o.e(e)}finally{o.f()}return{bg:u(n),fg:u(i)}},f=[],p=[],g=[],m=[],!t){e.n=4;break}return e.n=1,this.parseLayout(t);case 1:if(!(s=e.v).masterPath){e.n=3;break}return o=s.masterPath,e.n=2,this.parseMaster(s.masterPath);case 2:l=e.v,i=l.textStyles||null,y=d(l),f=y.bg,p=y.fg;case 3:v=d(s),g=v.bg,m=v.fg;case 4:b=u(f),x=u(p),_=u(g),E=u(m),w=_createForOfIteratorHelper(b);try{for(w.s();!(k=w.n()).done;)(T=k.value).zIndex=n++,T.layer="master-bg",a.push(T)}catch(e){w.e(e)}finally{w.f()}S=_createForOfIteratorHelper(_);try{for(S.s();!(A=S.n()).done;)(I=A.value).zIndex=n++,I.layer="layout-bg",a.push(I)}catch(e){S.e(e)}finally{S.f()}C=h(r),B=_createForOfIteratorHelper(C.bg);try{for(B.s();!(N=B.n()).done;)P=N.value,this.applyPlaceholderDefaults(P,s,l),P.zIndex=n++,P.layer="slide-bg",a.push(P)}catch(e){B.e(e)}finally{B.f()}F=_createForOfIteratorHelper(C.fg);try{for(F.s();!(M=F.n()).done;)L=M.value,this.applyPlaceholderDefaults(L,s,l),L.zIndex=n++,L.layer="slide",a.push(L)}catch(e){F.e(e)}finally{F.f()}z=_createForOfIteratorHelper(E);try{for(z.s();!(D=z.n()).done;)(O=D.value).zIndex=n++,O.layer="layout-fg",a.push(O)}catch(e){z.e(e)}finally{z.f()}U=_createForOfIteratorHelper(x);try{for(U.s();!(R=U.n()).done;)(H=R.value).zIndex=n++,H.layer="master-fg",a.push(H)}catch(e){U.e(e)}finally{U.f()}return e.a(2,{shapes:a,textStyles:i,masterPath:o})}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"getTextStyleForPlaceholder",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return this.textStyleParser.getTextStyleForPlaceholder(e,t,r)}},{key:"getTextDefaults",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=this.textStyleParser.getTextDefaults(e,t,r)||{};if(a){var o=this.layoutCache.get(a),s=null==o?void 0:o.textStyles,l=null!=n?"".concat(t,":").concat(n):t,c=(null==s?void 0:s.get(l))||(null==s?void 0:s.get(t))||null,u=c&&(c[r]||c[1]||c.default)||null;u&&(u.fontSize&&(i.fontSize=u.fontSize),u.fontFamily&&(i.fontFamily=u.fontFamily),u.color&&(i.color=u.color),null!==u.bold&&void 0!==u.bold&&(i.bold=u.bold),null!==u.italic&&void 0!==u.italic&&(i.italic=u.italic),u.align&&(i.align=u.align),null!==u.marLEm&&void 0!==u.marLEm&&(i.marLEm=u.marLEm),null!==u.indentEm&&void 0!==u.indentEm&&(i.indentEm=u.indentEm),null!==u.spaceBeforeEm&&void 0!==u.spaceBeforeEm&&(i.spaceBeforeEm=u.spaceBeforeEm),null!==u.spaceAfterEm&&void 0!==u.spaceAfterEm&&(i.spaceAfterEm=u.spaceAfterEm),null!==u.lineHeight&&void 0!==u.lineHeight&&(i.lineHeight=u.lineHeight))}return i}},{key:"clearCache",value:function(){this.layoutCache.clear(),this.masterCache.clear(),this.textStyleParser.clearCache()}},{key:"applyPlaceholderDefaults",value:function(e,t,r){if(e&&e.isPlaceholder){var a=this.findPlaceholderDefinition(e,t,r);if(a){var n=Number.isFinite(e.xEMU)||Number.isFinite(e.x),i=Number.isFinite(e.yEMU)||Number.isFinite(e.y),o="number"==typeof e.cxEMU&&e.cxEMU>0||"number"==typeof e.width&&e.width>0,s="number"==typeof e.cyEMU&&e.cyEMU>0||"number"==typeof e.height&&e.height>0;n&&i&&o&&s||!a||("number"!=typeof e.xEMU&&"number"==typeof a.x&&(e.x=a.x,void 0!==ShapeParser&&ShapeParser.SLIDE_WIDTH_EMU&&(e.xEMU=Math.round(a.x/100*ShapeParser.SLIDE_WIDTH_EMU))),"number"!=typeof e.yEMU&&"number"==typeof a.y&&(e.y=a.y,void 0!==ShapeParser&&ShapeParser.SLIDE_HEIGHT_EMU&&(e.yEMU=Math.round(a.y/100*ShapeParser.SLIDE_HEIGHT_EMU))),"number"!=typeof e.cxEMU&&"number"==typeof a.width&&(e.width=a.width,void 0!==ShapeParser&&ShapeParser.SLIDE_WIDTH_EMU&&(e.cxEMU=Math.round(a.width/100*ShapeParser.SLIDE_WIDTH_EMU))),"number"!=typeof e.cyEMU&&"number"==typeof a.height&&(e.height=a.height,void 0!==ShapeParser&&ShapeParser.SLIDE_HEIGHT_EMU&&(e.cyEMU=Math.round(a.height/100*ShapeParser.SLIDE_HEIGHT_EMU)))),!e.fill&&a.fill&&(e.fill=a.fill),null!==e.stroke&&void 0!==e.stroke||!a.stroke||(e.stroke=a.stroke),e.strokeWidth&&1!==e.strokeWidth||!a.strokeWidth||(e.strokeWidth=a.strokeWidth),!e.textVAlign&&a.textVAlign&&(e.textVAlign=a.textVAlign),void 0===e.textWrap&&void 0!==a.textWrap&&(e.textWrap=a.textWrap),!e.textInsetsEMU&&a.textInsetsEMU&&(e.textInsetsEMU={left:a.textInsetsEMU.left,right:a.textInsetsEMU.right,top:a.textInsetsEMU.top,bottom:a.textInsetsEMU.bottom})}}}},{key:"findPlaceholderDefinition",value:function(e,t,r){var a=function(e){return e?Array.isArray(e)?e:[e]:[]},n=function(t){if(!t)return null;var r=a(t.get(e.placeholderType));if(e.placeholderIdx){var n=r.find(function(t){return t&&t.placeholderIdx&&t.placeholderIdx===e.placeholderIdx});if(n)return n}if(r.length>0)return r[0];if(e.placeholderIdx){var i,o=_createForOfIteratorHelper(t.values());try{for(o.s();!(i=o.n()).done;){var s=i.value,l=a(s).find(function(t){return t&&t.placeholderIdx&&t.placeholderIdx===e.placeholderIdx});if(l)return l}}catch(e){o.e(e)}finally{o.f()}}return null};return n(null==t?void 0:t.placeholders)||n(null==r?void 0:r.placeholders)||null}}],[{key:"resolveTarget",value:function(e,t){if(!e||!t)return null;if(t.startsWith("/"))return t.replace(/^\/+/,"");if(!t.startsWith("..")&&!t.startsWith("/"))return(e.substring(0,e.lastIndexOf("/")+1)+t).replace(/\/+/g,"/");var r=e.split("/");r.pop();var a,n=_createForOfIteratorHelper(t.split("/"));try{for(n.s();!(a=n.n()).done;){var i=a.value;if(".."===i)r.pop();else{if("."===i||""===i)continue;r.push(i)}}}catch(e){n.e(e)}finally{n.f()}return r.join("/")}}]);var t,r,a}();_defineProperty(LayoutParser,"SLIDE_WIDTH_EMU",9144e3),_defineProperty(LayoutParser,"SLIDE_HEIGHT_EMU",5143500),window.LayoutParser=LayoutParser;var ChartParser=function(){return _createClass(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;_classCallCheck(this,e),this.COLOR_PALETTE=["#4e79a7","#f28e2b","#e15759","#76b7b2","#59a14f","#edc949","#af7aa1","#ff9da7","#9c755f","#bab0ab"],this.backgroundExtractor=t,this.themeExtractor=r},[{key:"parseChart",value:(e=_asyncToGenerator(_regenerator().m(function e(t,r){var a,n,i,o,s,l,c,u,h,d,f,p,g,m,y;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(t&&r){e.n=1;break}return e.a(2,null);case 1:if(a=t.file(r.replace(/^\//,""))){e.n=2;break}return e.a(2,null);case 2:return e.n=3,a.async("string");case 3:if(n=e.v,i=(new DOMParser).parseFromString(n,"text/xml"),o=i.getElementsByTagName("c:chartSpace")[0]){e.n=4;break}return e.a(2,null);case 4:if(s=o.getElementsByTagName("c:plotArea")[0]){e.n=5;break}return e.a(2,null);case 5:if(l=this.detectChartType(s)){e.n=6;break}return e.a(2,null);case 6:return c=this.extractCategories(l.catRef,l.catLit),u=this.extractSeries(l.seriesNodes,c),h=this.extractHoleSize(s),d=l.stacking||"none",f=l.barDir||"column",p=l.gapWidth,g=l.overlap,m=this.extractLegend(o),y=this.extractAxes(s),e.a(2,{chartType:l.kind,categories:c,series:u,holeSize:h,stacking:d,barDir:f,gapWidth:p,overlap:g,legend:m,axes:y})}},e,this)})),function(t,r){return e.apply(this,arguments)})},{key:"detectChartType",value:function(e){for(var t=0,r=[{tag:"c:barChart",kind:"column"},{tag:"c:lineChart",kind:"line"},{tag:"c:areaChart",kind:"area"},{tag:"c:pieChart",kind:"pie"},{tag:"c:doughnutChart",kind:"doughnut"}];t<r.length;t++){var a=r[t],n=e.getElementsByTagName(a.tag)[0];if(n){var i,o,s=Array.from(n.getElementsByTagName("c:ser")),l=null===(i=n.getElementsByTagName("c:cat")[0])||void 0===i?void 0:i.getElementsByTagName("c:strRef")[0],c=null===(o=n.getElementsByTagName("c:cat")[0])||void 0===o?void 0:o.getElementsByTagName("c:strLit")[0],u=this.detectStacking(a.kind,n),h=this.detectBarDir(a.kind,n),d=this.detectGapWidth(n),f=this.detectOverlap(n);return{kind:a.kind,node:n,seriesNodes:s,catRef:l,catLit:c,stacking:u,barDir:h,gapWidth:d,overlap:f}}}return null}},{key:"detectStacking",value:function(e,t){var r;if("column"!==e)return"none";var a=(null===(r=t.getElementsByTagName("c:grouping")[0])||void 0===r?void 0:r.getAttribute("val"))||"clustered";return"stacked"===a?"stacked":"percentStacked"===a?"percent":"none"}},{key:"detectBarDir",value:function(e,t){var r;return"column"!==e?"column":"bar"===((null===(r=t.getElementsByTagName("c:barDir")[0])||void 0===r?void 0:r.getAttribute("val"))||"col")?"bar":"column"}},{key:"detectGapWidth",value:function(e){var t=e.getElementsByTagName("c:gapWidth")[0];if(!t)return null;var r=parseInt(t.getAttribute("val")||"0",10);return Number.isNaN(r)?null:r}},{key:"detectOverlap",value:function(e){var t=e.getElementsByTagName("c:overlap")[0];if(!t)return null;var r=parseInt(t.getAttribute("val")||"0",10);return Number.isNaN(r)?null:Math.max(-100,Math.min(100,r))}},{key:"extractCategories",value:function(e,t){var r=function(e){var t;if(!e)return[];var r=e.getElementsByTagName("c:strCache")[0],a=r?r.getElementsByTagName("c:pt"):e.getElementsByTagName("c:pt");if(!a||0===a.length)return[];var n=null===(t=e.getElementsByTagName("c:ptCount")[0])||void 0===t?void 0:t.getAttribute("val"),i=n?parseInt(n,10):a.length,o=new Array(Number.isFinite(i)?i:a.length).fill("");return Array.from(a).forEach(function(e,t){var r,a=e.getAttribute("idx"),n=null!==a?parseInt(a,10):t,i=(null===(r=e.getElementsByTagName("c:v")[0])||void 0===r?void 0:r.textContent)||"";Number.isFinite(n)&&n>=0&&n<o.length&&(o[n]=i)}),o},a=r(e);return a.length>0?a:r(t)}},{key:"extractSeries",value:function(e,t){var r=this,a=[];return e.forEach(function(e,n){var i=r.extractSeriesName(e)||"Series ".concat(n+1),o=r.extractSeriesValues(e,t.length),s=r.extractSeriesColor(e);if(!s&&r.themeExtractor){var l=n%6+1,c=r.themeExtractor.getSchemeColor("accent".concat(l));c&&(s=c)}s||(s=r.COLOR_PALETTE[n%r.COLOR_PALETTE.length]),a.push({name:i,values:o,color:s})}),a}},{key:"extractSeriesName",value:function(e){var t=e.getElementsByTagName("c:tx")[0];if(!t)return null;var r=t.getElementsByTagName("c:strRef")[0];if(r){var a,n=r.getElementsByTagName("c:strCache")[0],i=null==n?void 0:n.getElementsByTagName("c:pt")[0];return(null==i||null===(a=i.getElementsByTagName("c:v")[0])||void 0===a?void 0:a.textContent)||null}var o=t.getElementsByTagName("c:v")[0];return o?o.textContent:null}},{key:"extractSeriesValues",value:function(e,t){var r=e.getElementsByTagName("c:val")[0];if(!r)return new Array(t).fill(0);var a=r.getElementsByTagName("c:numRef")[0],n=r.getElementsByTagName("c:numLit")[0],i=function(e){if(!e)return null;var r=e.getElementsByTagName("c:numCache")[0],a=r?r.getElementsByTagName("c:pt"):e.getElementsByTagName("c:pt");if(!a||0===a.length)return null;var n=new Array(t).fill(0);return Array.from(a).forEach(function(e,t){var r,a=e.getAttribute("idx"),i=null!==a?parseInt(a,10):t,o=parseFloat((null===(r=e.getElementsByTagName("c:v")[0])||void 0===r?void 0:r.textContent)||"0");Number.isFinite(i)&&i>=0&&i<n.length&&(n[i]=Number.isFinite(o)?o:0)}),n};return i(a)||i(n)||new Array(t).fill(0)}},{key:"extractSeriesColor",value:function(e){var t=e.getElementsByTagName("c:spPr")[0]||e.getElementsByTagName("a:spPr")[0];if(!t)return null;var r=t.getElementsByTagName("a:solidFill")[0];if(r&&this.backgroundExtractor&&"function"==typeof this.backgroundExtractor.extractColor){var a=this.backgroundExtractor.extractColor(r);if(a)return a}var n=t.getElementsByTagName("a:gradFill")[0];if(n&&this.backgroundExtractor&&"function"==typeof this.backgroundExtractor.extractGradient){var i,o=this.backgroundExtractor.extractGradient(n);if(o&&Array.isArray(o.stops)&&null!==(i=o.stops[0])&&void 0!==i&&i.color)return o.stops[0].color}var s=t.getElementsByTagName("a:ln")[0];if(s&&this.backgroundExtractor&&"function"==typeof this.backgroundExtractor.extractColor){var l=this.backgroundExtractor.extractColor(s);if(l)return l}return null}},{key:"extractHoleSize",value:function(e){var t=e.getElementsByTagName("c:doughnutChart")[0];if(!t)return 0;var r=t.getElementsByTagName("c:holeSize")[0];if(r&&r.getAttribute("val")){var a=parseInt(r.getAttribute("val"),10);if(!Number.isNaN(a))return Math.min(90,Math.max(0,a))}return 50}},{key:"extractLegend",value:function(e){var t,r,a=e.getElementsByTagName("c:legend")[0];if(!a)return{position:"r",overlay:!1};var n=(null===(t=a.getElementsByTagName("c:legendPos")[0])||void 0===t?void 0:t.getAttribute("val"))||"r",i=null===(r=a.getElementsByTagName("c:overlay")[0])||void 0===r?void 0:r.getAttribute("val");return{position:n,overlay:"1"===i||"true"===i}}},{key:"extractAxes",value:function(e){var t=e.getElementsByTagName("c:valAx")[0],r={value:{}};if(t){var a=t.getElementsByTagName("c:scaling")[0];if(a){var n=a.getElementsByTagName("c:min")[0],i=a.getElementsByTagName("c:max")[0],o=n?parseFloat(n.getAttribute("val")):null,s=i?parseFloat(i.getAttribute("val")):null;Number.isNaN(o)||(r.value.min=o),Number.isNaN(s)||(r.value.max=s)}var l=t.getElementsByTagName("c:numFmt")[0],c=l?l.getAttribute("formatCode"):null;c&&(r.value.formatCode=c)}return r}}]);var e}();window.ChartParser=ChartParser;var PPTXParser=function(){return _createClass(function PPTXParser(){_classCallCheck(this,PPTXParser),this.zip=null,this.xmlParser=new DOMParser,this.themeExtractor=null,this.backgroundExtractor=null,this.shapeParser=null,this.textExtractor=null,this.layoutParser=null,this.tableParser=null,this.chartParser=null,this._chartDataCache=new Map,this.slides=[],this.slideLayouts=[],this.slideMasters=[],this.theme=null,this.images={},this.presentation=null},[{key:"parse",value:(e=_asyncToGenerator(_regenerator().m(function e(t){var r;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,this.reset(),e.n=1,JSZip.loadAsync(t);case 1:return this.zip=e.v,e.n=2,this.loadImages();case 2:return e.n=3,this.parsePresentation();case 3:return e.n=4,this.parseTheme();case 4:return e.n=5,this.parseSlides();case 5:return e.a(2,{slides:this.slides,theme:this.theme,images:this.images,presentation:this.presentation});case 6:throw e.p=6,r=e.v,console.error("Error parsing PPTX:",r),r;case 7:return e.a(2)}},e,this,[[0,6]])})),function(t){return e.apply(this,arguments)})},{key:"reset",value:function(){Object.values(this.images).forEach(function(e){try{URL.revokeObjectURL(e)}catch(e){}}),this.layoutParser&&this.layoutParser.clearCache(),this.zip=null,this.themeExtractor=null,this.backgroundExtractor=null,this.shapeParser=null,this.textExtractor=null,this.layoutParser=null,this.tableParser=null,this.chartParser=null,this._chartDataCache=new Map,this.slides=[],this.slideLayouts=[],this.slideMasters=[],this.theme=null,this.images={},this.presentation=null}},{key:"getSlides",value:function(){return this.slides}},{key:"getTheme",value:function(){return this.theme}},{key:"getImages",value:function(){return this.images}}]);var e}();PPTXParser.SLIDE_WIDTH_EMU=9144e3,PPTXParser.SLIDE_HEIGHT_EMU=5143500,PPTXParser.resolveTarget=function(e,t){if(!e||!t)return null;if(t.startsWith("/"))return t.replace(/^\/+/,"");var r=e.split("/");r.pop();var a,n=_createForOfIteratorHelper(t.split("/"));try{for(n.s();!(a=n.n()).done;){var i=a.value;if(".."===i)r.pop();else{if("."===i||""===i)continue;r.push(i)}}}catch(e){n.e(e)}finally{n.f()}return r.join("/")},window.PPTXParser=PPTXParser,PPTXParser.prototype.loadImages=_asyncToGenerator(_regenerator().m(function e(){var t,r,a,n,i,o,s,l,c,u,h,d,f,p,g;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=this.zip.folder("ppt/media")){e.n=1;break}return e.a(2);case 1:r=function(e){var t=(e||"EMF image").replace(/</g,"&lt;").replace(/>/g,"&gt;"),r='<svg xmlns="http://www.w3.org/2000/svg" width="400" height="200" viewBox="0 0 400 200" role="img" aria-label="'.concat(t,' unsupported"><rect width="400" height="200" fill="#f3f4f6" stroke="#d1d5db"/><text x="200" y="80" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" fill="#4b5563">EMF not rendered</text><text x="200" y="120" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="#6b7280">Converter unavailable</text></svg>'),a=new Blob([r],{type:"image/svg+xml"});return URL.createObjectURL(a)},a=new(globalThis.EMFConverter||function(){return _createClass(function e(){_classCallCheck(this,e)},[{key:"convertToObjectUrl",value:(e=_asyncToGenerator(_regenerator().m(function e(){return _regenerator().w(function(e){for(;;)if(0===e.n)return e.a(2,r())},e)})),function(){return e.apply(this,arguments)})}]);var e}()),n=function(){var e=_asyncToGenerator(_regenerator().m(function e(t){var n,i,o,s=arguments;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:null,e.p=1,e.n=2,a.convertToObjectUrl(t,n||null);case 2:return i=e.v,e.a(2,i||r(n));case 3:return e.p=3,o=e.v,console.warn("EMF to SVG conversion failed, using placeholder",o),e.a(2,r(n))}},e,null,[[1,3]])}));return function(t){return e.apply(this,arguments)}}(),i=Object.keys(t.files),o=0,s=i;case 2:if(!(o<s.length)){e.n=10;break}if(l=s[o],(c=t.files[l]).dir){e.n=9;break}return e.p=3,e.n=4,c.async("blob");case 4:if(u=e.v,h=c.name.split("/").pop(),"emf"!==(d=(h.split(".").pop()||"").toLowerCase())&&"wmf"!==d){e.n=6;break}return e.n=5,n(u,h);case 5:f=e.v,this.images[h]=f,e.n=7;break;case 6:p=URL.createObjectURL(u),this.images[h]=p;case 7:e.n=9;break;case 8:e.p=8,g=e.v,console.warn("Failed to load image: ".concat(l),g);case 9:o++,e.n=2;break;case 10:return e.a(2)}},e,this,[[3,8]])})),PPTXParser.prototype.loadTableStyles=_asyncToGenerator(_regenerator().m(function e(){var t,r,a;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:if(this.zip&&this.tableParser&&"function"==typeof this.tableParser.setTableStyles){e.n=1;break}return e.a(2);case 1:if(e.p=1,t=this.zip.file("ppt/tableStyles.xml")){e.n=2;break}return e.a(2);case 2:return e.n=3,t.async("string");case 3:r=e.v,this.tableParser.setTableStyles(r,this.xmlParser),e.n=5;break;case 4:e.p=4,a=e.v,console.warn("Unable to load tableStyles.xml",a);case 5:return e.a(2)}},e,this,[[1,4]])})),PPTXParser.prototype.parsePresentation=_asyncToGenerator(_regenerator().m(function e(){var t,r,a,n,i,o,s,l,c,u,h,d=this;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,this.zip.file("ppt/presentation.xml").async("string");case 1:return t=e.v,r=this.xmlParser.parseFromString(t,"text/xml"),a=r.getElementsByTagName("p:sldSz")[0],n=null,a&&(i=parseInt(a.getAttribute("cx")||"0",10),o=parseInt(a.getAttribute("cy")||"0",10),i>0&&o>0&&(n={cx:i,cy:o,ratio:i/o,invRatio:o/i},PPTXParser.SLIDE_WIDTH_EMU=i,PPTXParser.SLIDE_HEIGHT_EMU=o,window.ShapeParser&&(ShapeParser.SLIDE_WIDTH_EMU=i,ShapeParser.SLIDE_HEIGHT_EMU=o),window.LayoutParser&&(LayoutParser.SLIDE_WIDTH_EMU=i,LayoutParser.SLIDE_HEIGHT_EMU=o),window.LayoutShapeParser&&(LayoutShapeParser.SLIDE_WIDTH_EMU=i,LayoutShapeParser.SLIDE_HEIGHT_EMU=o))),s=r.getElementsByTagName("p:sldIdLst")[0],l=Array.from(s.getElementsByTagName("p:sldId")).map(function(e){return{id:e.getAttribute("id"),rId:e.getAttribute("r:id")}}),e.n=2,this.zip.file("ppt/_rels/presentation.xml.rels").async("string");case 2:c=e.v,u=this.xmlParser.parseFromString(c,"text/xml"),this.slideRelationships=new Map,Array.from(u.getElementsByTagName("Relationship")).forEach(function(e){d.slideRelationships.set(e.getAttribute("Id"),e.getAttribute("Target"))}),this.presentation={slideCount:l.length,slideIds:l,slideSize:n},e.n=4;break;case 3:throw e.p=3,h=e.v,console.error("Error parsing presentation structure:",h),h;case 4:return e.a(2)}},e,this,[[0,3]])})),PPTXParser.prototype.parseTheme=_asyncToGenerator(_regenerator().m(function e(){var t,r,a,n,i,o,s,l,c;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,t=this.zip.file("ppt/theme/theme1.xml")){e.n=1;break}throw new Error("Theme file not found");case 1:return e.n=2,t.async("string");case 2:return r=e.v,a=this.xmlParser.parseFromString(r,"text/xml"),this.themeExtractor=new ThemeExtractor,e.p=3,e.n=4,null===(n=this.zip.file("ppt/theme/_rels/theme1.xml.rels"))||void 0===n?void 0:n.async("string");case 4:i=e.v,o=window.XMLUtils?XMLUtils.parseRelationships(i):[],"function"==typeof this.themeExtractor.setThemeRelationships&&this.themeExtractor.setThemeRelationships(o),e.n=6;break;case 5:e.p=5,e.v,"function"==typeof this.themeExtractor.setThemeRelationships&&this.themeExtractor.setThemeRelationships([]);case 6:return e.n=7,this.themeExtractor.extract(a);case 7:if(this.theme=e.v,this.backgroundExtractor=new BackgroundExtractor(this.themeExtractor,this.images),this.shapeParser=new ShapeParser(this.backgroundExtractor,this.images,this.themeExtractor),this.textExtractor=new TextExtractor(this.themeExtractor,this.backgroundExtractor),!(s="undefined"!=typeof globalThis&&globalThis.TableParser?globalThis.TableParser:null)){e.n=9;break}return this.tableParser=new s(this.backgroundExtractor,this.themeExtractor,this.shapeParser),e.n=8,this.loadTableStyles();case 8:e.n=10;break;case 9:console.warn("TableParser not available; tables will not be styled");case 10:this.chartParser=new ChartParser(this.backgroundExtractor,this.themeExtractor),this.layoutParser=new LayoutParser(this.zip,this.xmlParser,this.backgroundExtractor,this.themeExtractor,this.images),e.n=16;break;case 11:return e.p=11,c=e.v,console.error("Error parsing theme:",c),this.themeExtractor=new ThemeExtractor,"function"==typeof this.themeExtractor.setThemeRelationships&&this.themeExtractor.setThemeRelationships([]),e.n=12,this.themeExtractor.extract(null);case 12:if(this.theme=e.v,this.backgroundExtractor=new BackgroundExtractor(this.themeExtractor,this.images),this.shapeParser=new ShapeParser(this.backgroundExtractor,this.images,this.themeExtractor),this.textExtractor=new TextExtractor(this.themeExtractor,this.backgroundExtractor),!(l="undefined"!=typeof globalThis&&globalThis.TableParser?globalThis.TableParser:null)){e.n=14;break}return this.tableParser=new l(this.backgroundExtractor,this.themeExtractor,this.shapeParser),e.n=13,this.loadTableStyles();case 13:e.n=15;break;case 14:console.warn("TableParser not available; tables will not be styled");case 15:this.chartParser=new ChartParser(this.backgroundExtractor,this.themeExtractor),this.layoutParser=new LayoutParser(this.zip,this.xmlParser,this.backgroundExtractor,this.themeExtractor,this.images);case 16:return e.a(2)}},e,this,[[3,5],[0,11]])})),PPTXParser.prototype.parseSlides=_asyncToGenerator(_regenerator().m(function e(){var t,r,a,n,i;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,this.presentation&&this.presentation.slideIds){e.n=1;break}throw new Error("Presentation not initialized");case 1:t=0;case 2:if(!(t<this.presentation.slideIds.length)){e.n=6;break}if(r=this.presentation.slideIds[t],a=this.slideRelationships.get(r.rId)){e.n=3;break}return e.a(3,5);case 3:return e.n=4,this.parseSlide("ppt/".concat(a),t+1);case 4:(n=e.v)&&this.slides.push(n);case 5:t++,e.n=2;break;case 6:e.n=8;break;case 7:throw e.p=7,i=e.v,console.error("Error parsing slides:",i),i;case 8:return e.a(2)}},e,this,[[0,7]])})),PPTXParser.prototype.parseSlide=function(){var e=_asyncToGenerator(_regenerator().m(function e(t){var r,a,n,i,o,s,l,c,u,h,d,f,p,g,m,y,v,b,x,_,E,w,k,T,S,A,I=this,C=arguments;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:return r=C.length>1&&void 0!==C[1]?C[1]:null,e.p=1,e.n=2,this.zip.file(t).async("string");case 2:return i=e.v,o=this.xmlParser.parseFromString(i,"text/xml"),s=t.replace("ppt/slides/","ppt/slides/_rels/").replace(".xml",".xml.rels"),l=[],c=null,e.p=3,e.n=4,this.zip.file(s).async("string");case 4:u=e.v,h=this.xmlParser.parseFromString(u,"text/xml"),l=Array.from(h.getElementsByTagName("Relationship")),(d=l.find(function(e){return(e.getAttribute("Type")||"").includes("slideLayout")}))&&(c=PPTXParser.resolveTarget(t,d.getAttribute("Target"))),e.n=6;break;case 5:e.p=5,e.v;case 6:if(f=null,!this.layoutParser||!c){e.n=8;break}return e.n=7,this.layoutParser.parseLayout(c);case 7:if(p=e.v,!(f=p.masterPath||null)){e.n=8;break}return e.n=8,this.layoutParser.parseMaster(f);case 8:if((g=this.backgroundExtractor.extract(o,l))||!c){e.n=10;break}return e.n=9,this.parseLayoutBackground(c);case 9:g=e.v;case 10:if(g){e.n=12;break}return e.n=11,this.parseMasterBackground(c);case 11:g=e.v;case 12:if(m=[],y=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return I.layoutParser?I.layoutParser.getTextDefaults(f,e,t,c,r):null},v=null===(a=o.getElementsByTagName("p:cSld")[0])||void 0===a?void 0:a.getElementsByTagName("p:spTree")[0])for(b=Array.from(v.children).filter(function(e){return"p:sp"===e.tagName||"p:pic"===e.tagName||"p:grpSp"===e.tagName||"p:cxnSp"===e.tagName||"p:graphicFrame"===e.tagName}),x=0;x<b.length;x++)if(_=b[x],E=this.parseShape(_,l,y,r,t))if(Array.isArray(E))for(w=0;w<E.length;w++)E[w]&&"number"!=typeof E[w]._treeOrder&&(E[w]._treeOrder=x+w/1e3),m.push(E[w]);else"number"!=typeof E._treeOrder&&(E._treeOrder=x),m.push(E);if(!(m.length>0)){e.n=13;break}return e.n=13,this.attachChartData(m);case 13:if(k=m,T=null,!this.layoutParser||!c){e.n=15;break}return e.n=14,this.layoutParser.getMergedShapes(c,m);case 14:S=e.v,k=S.shapes,T=S.textStyles,f=f||S.masterPath;case 15:if(!(k&&k.length>0)){e.n=17;break}return e.n=16,this.attachChartData(k);case 16:this.resolveConnectorEndpoints(k);case 17:return e.a(2,{background:g,shapes:k,layoutPath:c,textStyles:T,masterPath:f,slideSize:(null===(n=this.presentation)||void 0===n?void 0:n.slideSize)||null});case 18:return e.p=18,A=e.v,console.error("Error parsing slide ".concat(t,":"),A),e.a(2,null)}},e,this,[[3,5],[1,18]])}));return function(t){return e.apply(this,arguments)}}(),PPTXParser.prototype.attachChartData=function(){var e=_asyncToGenerator(_regenerator().m(function e(t){var r,a,n,i,o,s=this;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:if(this.chartParser&&Array.isArray(t)&&0!==t.length){e.n=1;break}return e.a(2);case 1:r=[],a=_createForOfIteratorHelper(t),e.p=2,i=_regenerator().m(function e(){var t,a,i,o;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if((t=n.value)&&"chart"===t.type&&t.chartTarget&&!t.chartData){e.n=1;break}return e.a(2,1);case 1:a=t.chartTarget,s._chartDataCache.has(a)||(i=s.chartParser.parseChart(s.zip,a).catch(function(e){return console.warn("Failed to parse chart ".concat(a,":"),e),null}),s._chartDataCache.set(a,i)),o=s._chartDataCache.get(a).then(function(e){e&&(t.chartData=e)}),r.push(o);case 2:return e.a(2)}},e)}),a.s();case 3:if((n=a.n()).done){e.n=6;break}return e.d(_regeneratorValues(i()),4);case 4:if(!e.v){e.n=5;break}return e.a(3,5);case 5:e.n=3;break;case 6:e.n=8;break;case 7:e.p=7,o=e.v,a.e(o);case 8:return e.p=8,a.f(),e.f(8);case 9:if(!(r.length>0)){e.n=10;break}return e.n=10,Promise.all(r);case 10:return e.a(2)}},e,this,[[2,7,8,9]])}));return function(t){return e.apply(this,arguments)}}(),PPTXParser.prototype.resolveConnectorEndpoints=function(e){if(Array.isArray(e)&&0!==e.length){var t,r=new Map,a=_createForOfIteratorHelper(e);try{for(a.s();!(t=a.n()).done;){var n=t.value;n&&"number"==typeof n.shapeId&&"line"!==n.type&&r.set(n.shapeId,n)}}catch(e){a.e(e)}finally{a.f()}var i,o=function(e,t){var r,a,n,i;if(!e)return null;var o=null!==(r=e.x)&&void 0!==r?r:0,s=null!==(a=e.y)&&void 0!==a?a:0,l=null!==(n=e.width)&&void 0!==n?n:0,c=null!==(i=e.height)&&void 0!==i?i:0;switch(t){case 0:return{x:o+.5*l,y:s};case 1:return{x:o+l,y:s+.5*c};case 2:return{x:o+.5*l,y:s+c};case 3:return{x:o,y:s+.5*c};default:return{x:o+.5*l,y:s+.5*c}}},s=_createForOfIteratorHelper(e);try{for(s.s();!(i=s.n()).done;){var l,c,u,h,d,f,p=i.value;if(p&&"line"===p.type){var g=p.startCxn?r.get(p.startCxn.shapeId):null,m=p.endCxn?r.get(p.endCxn.shapeId):null,y=g?o(g,p.startCxn.idx):null,v=m?o(m,p.endCxn.idx):null;if(y||v){var b={x1:null!==(l=p.x)&&void 0!==l?l:0,y1:null!==(c=p.y)&&void 0!==c?c:0,x2:(null!==(u=p.x)&&void 0!==u?u:0)+(null!==(h=p.width)&&void 0!==h?h:0),y2:(null!==(d=p.y)&&void 0!==d?d:0)+(null!==(f=p.height)&&void 0!==f?f:0)},x=y||{x:b.x1,y:b.y1},_=v||{x:b.x2,y:b.y2},E=Math.min(x.x,_.x),w=Math.min(x.y,_.y),k=Math.max(x.x,_.x),T=Math.max(x.y,_.y),S=Math.max(.1,k-E),A=Math.max(.1,T-w);p.x=E,p.y=w,p.width=S,p.height=A,p.linePoints={x1:(x.x-E)/S*100,y1:(x.y-w)/A*100,x2:(_.x-E)/S*100,y2:(_.y-w)/A*100},delete p.flipH,delete p.flipV}}}}catch(e){s.e(e)}finally{s.f()}}},PPTXParser.prototype.parseLayoutBackground=function(){var e=_asyncToGenerator(_regenerator().m(function e(t){var r,a,n,i,o,s,l,c;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,r=this.zip.file(t)){e.n=1;break}return e.a(2,null);case 1:return e.n=2,r.async("string");case 2:if(a=e.v,n=this.xmlParser.parseFromString(a,"text/xml"),i=t.replace("ppt/slideLayouts/","ppt/slideLayouts/_rels/").replace(".xml",".xml.rels"),o=[],e.p=3,!(s=this.zip.file(i))){e.n=5;break}return e.n=4,s.async("string");case 4:l=e.v,c=this.xmlParser.parseFromString(l,"text/xml"),o=Array.from(c.getElementsByTagName("Relationship"));case 5:e.n=7;break;case 6:e.p=6,e.v;case 7:return e.a(2,this.backgroundExtractor.extract(n,o));case 8:return e.p=8,e.v,e.a(2,null)}},e,this,[[3,6],[0,8]])}));return function(t){return e.apply(this,arguments)}}(),PPTXParser.prototype.parseMasterBackground=function(){var e=_asyncToGenerator(_regenerator().m(function e(t){var r,a,n,i,o,s,l,c,u,h,d,f,p,g;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,r="ppt/slideMasters/slideMaster1.xml",!t){e.n=5;break}if(a=t.replace("ppt/slideLayouts/","ppt/slideLayouts/_rels/").replace(".xml",".xml.rels"),e.p=1,!(n=this.zip.file(a))){e.n=3;break}return e.n=2,n.async("string");case 2:i=e.v,o=this.xmlParser.parseFromString(i,"text/xml"),(s=Array.from(o.getElementsByTagName("Relationship")).find(function(e){return(e.getAttribute("Type")||"").includes("slideMaster")}))&&(r=(r="ppt/slideLayouts/"+s.getAttribute("Target")).replace(/[^/]+\/\.\.\//g,""));case 3:e.n=5;break;case 4:e.p=4,e.v;case 5:if(l=this.zip.file(r)){e.n=6;break}return e.a(2,null);case 6:return e.n=7,l.async("string");case 7:if(c=e.v,u=this.xmlParser.parseFromString(c,"text/xml"),h=r.replace("ppt/slideMasters/","ppt/slideMasters/_rels/").replace(".xml",".xml.rels"),d=[],e.p=8,!(f=this.zip.file(h))){e.n=10;break}return e.n=9,f.async("string");case 9:p=e.v,g=this.xmlParser.parseFromString(p,"text/xml"),d=Array.from(g.getElementsByTagName("Relationship"));case 10:e.n=12;break;case 11:e.p=11,e.v;case 12:return e.a(2,this.backgroundExtractor.extract(u,d));case 13:return e.p=13,e.v,e.a(2,null)}},e,this,[[8,11],[1,4],[0,13]])}));return function(t){return e.apply(this,arguments)}}(),PPTXParser.prototype.parseShape=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=e.tagName;return"p:sp"===i?this.shapeParser.parseShape(e,t,r,a):"p:pic"===i?this.parsePicture(e,t):"p:cxnSp"===i?this.parseConnectionShape(e,t):"p:grpSp"===i?this.parseGroupShape(e,t,r,a,n):"p:graphicFrame"===i?this.parseGraphicFrame(e,t,r,n):null},PPTXParser.prototype.parseGraphicFrame=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(e.getElementsByTagName("a:tbl")[0]&&this.tableParser)return this.tableParser.parseTable(e,t,r);var n=e.getElementsByTagName("a:graphicData")[0],i=n?n.getElementsByTagName("c:chart")[0]:null;if(i){var o,s=i.getAttribute("r:id"),l=null;if(s&&Array.isArray(t)){var c=t.find(function(e){return e.getAttribute("Id")===s});if(c){var u=a||"ppt/slides/slide1.xml";l=PPTXParser.resolveTarget(u,c.getAttribute("Target"))||c.getAttribute("Target")}}var h=0,d=0,f=50,p=30,g=e.getElementsByTagName("p:xfrm")[0]||e.getElementsByTagName("a:xfrm")[0];if(g){var m=g.getElementsByTagName("a:off")[0],y=g.getElementsByTagName("a:ext")[0];m&&(h=parseInt(m.getAttribute("x")||"0",10)/PPTXParser.SLIDE_WIDTH_EMU*100,d=parseInt(m.getAttribute("y")||"0",10)/PPTXParser.SLIDE_HEIGHT_EMU*100),y&&(f=parseInt(y.getAttribute("cx")||"0",10)/PPTXParser.SLIDE_WIDTH_EMU*100,p=parseInt(y.getAttribute("cy")||"0",10)/PPTXParser.SLIDE_HEIGHT_EMU*100)}var v=(null===(o=e.getElementsByTagName("p:cNvPr")[0])||void 0===o?void 0:o.getAttribute("name"))||"Chart";return{type:"chart",x:h,y:d,width:f,height:p,chartRelId:s||null,chartTarget:l,name:v,layer:"slide"}}return null},PPTXParser.prototype.parseConnectionShape=function(e,t){var r=e.getElementsByTagName("p:cNvPr")[0],a=r?r.getAttribute("id"):null,n=e.getElementsByTagName("p:cNvCxnSpPr")[0],i=null==n?void 0:n.getElementsByTagName("a:stCxn")[0],o=null==n?void 0:n.getElementsByTagName("a:endCxn")[0],s={type:"line",x:0,y:0,width:0,height:0,fill:"none",stroke:null,strokeWidth:1,rotation:0,shapeId:a?parseInt(a,10):null,startCxn:i?{shapeId:parseInt(i.getAttribute("id")||"-1",10),idx:parseInt(i.getAttribute("idx")||"-1",10)}:null,endCxn:o?{shapeId:parseInt(o.getAttribute("id")||"-1",10),idx:parseInt(o.getAttribute("idx")||"-1",10)}:null},l=e.getElementsByTagName("p:spPr")[0];if(!l)return null;var c=l.getElementsByTagName("a:xfrm")[0];if(c){var u=c.getElementsByTagName("a:off")[0],h=c.getElementsByTagName("a:ext")[0];u&&(s.x=parseInt(u.getAttribute("x")||"0")/PPTXParser.SLIDE_WIDTH_EMU*100,s.y=parseInt(u.getAttribute("y")||"0")/PPTXParser.SLIDE_HEIGHT_EMU*100),h&&(s.width=parseInt(h.getAttribute("cx")||"0")/PPTXParser.SLIDE_WIDTH_EMU*100,s.height=parseInt(h.getAttribute("cy")||"0")/PPTXParser.SLIDE_HEIGHT_EMU*100);var d=c.getAttribute("rot");d&&(s.rotation=parseInt(d)/6e4),"1"===c.getAttribute("flipH")&&(s.flipH=!0),"1"===c.getAttribute("flipV")&&(s.flipV=!0)}var f=l.getElementsByTagName("a:prstGeom")[0];f&&(s.type=f.getAttribute("prst")||"line");var p=l.getElementsByTagName("a:ln")[0];if(p){var g=p.getAttribute("w");g&&(s.strokeWidth=parseInt(g)/914400*96);var m=p.getElementsByTagName("a:solidFill")[0];m&&(s.stroke=this.backgroundExtractor.extractColor(m));var y=p.getElementsByTagName("a:headEnd")[0];y&&y.getAttribute("type")&&"none"!==y.getAttribute("type")&&(s.arrowHead=y.getAttribute("type"));var v=p.getElementsByTagName("a:tailEnd")[0];v&&v.getAttribute("type")&&"none"!==v.getAttribute("type")&&(s.arrowTail=v.getAttribute("type"))}return s.stroke||(s.stroke=this.themeExtractor?this.themeExtractor.getDefaultTextColor():"#000000"),s},PPTXParser.prototype.parseGroupShape=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=[],o=e.getElementsByTagName("p:grpSpPr")[0],s=0,l=0,c=0,u=0,h=1,d=1,f=!1;if(o){var p=o.getElementsByTagName("a:xfrm")[0];if(p){var g=p.getElementsByTagName("a:off")[0],m=p.getElementsByTagName("a:chOff")[0],y=p.getElementsByTagName("a:ext")[0],v=p.getElementsByTagName("a:chExt")[0];if(g&&m&&(c=parseInt(g.getAttribute("x")||"0")-parseInt(m.getAttribute("x")||"0"),u=parseInt(g.getAttribute("y")||"0")-parseInt(m.getAttribute("y")||"0"),s=c/PPTXParser.SLIDE_WIDTH_EMU*100,l=u/PPTXParser.SLIDE_HEIGHT_EMU*100),g&&y){var b=parseInt(g.getAttribute("x")||"0",10)/PPTXParser.SLIDE_WIDTH_EMU*100,x=parseInt(g.getAttribute("y")||"0",10)/PPTXParser.SLIDE_HEIGHT_EMU*100,_=parseInt(y.getAttribute("cx")||"0",10)/PPTXParser.SLIDE_WIDTH_EMU*100,E=parseInt(y.getAttribute("cy")||"0",10)/PPTXParser.SLIDE_HEIGHT_EMU*100,w=function(e){return Math.abs(e)<=1};f=w(b)&&w(x)&&_>=98&&E>=98}if(y&&v){var k=parseInt(y.getAttribute("cx")||"1"),T=parseInt(v.getAttribute("cx")||"1"),S=parseInt(y.getAttribute("cy")||"1"),A=parseInt(v.getAttribute("cy")||"1");T>0&&(h=k/T),A>0&&(d=S/A)}}}var I,C=_createForOfIteratorHelper(e.children);try{for(C.s();!(I=C.n()).done;){var B=I.value,N=B.tagName,P=null;if("p:sp"===N)P=this.shapeParser.parseShape(B,t,r,a,n);else if("p:pic"===N)P=this.parsePicture(B,t);else if("p:cxnSp"===N)P=this.parseConnectionShape(B,t);else if("p:grpSp"===N){var F,M=_createForOfIteratorHelper(this.parseGroupShape(B,t,r,a,n));try{for(M.s();!(F=M.n()).done;){var L=F.value;L.x=L.x*h+s,L.y=L.y*d+l,L.width=L.width*h,L.height=L.height*d,"number"==typeof L.xEMU&&(L.xEMU=L.xEMU*h+c),"number"==typeof L.yEMU&&(L.yEMU=L.yEMU*d+u),"number"==typeof L.cxEMU&&(L.cxEMU=L.cxEMU*h),"number"==typeof L.cyEMU&&(L.cyEMU=L.cyEMU*d),i.push(L)}}catch(e){M.e(e)}finally{M.f()}continue}P&&(P.x=P.x*h+s,P.y=P.y*d+l,P.width=P.width*h,P.height=P.height*d,"number"==typeof P.xEMU&&(P.xEMU=P.xEMU*h+c),"number"==typeof P.yEMU&&(P.yEMU=P.yEMU*d+u),"number"==typeof P.cxEMU&&(P.cxEMU=P.cxEMU*h),"number"==typeof P.cyEMU&&(P.cyEMU=P.cyEMU*d),f&&(P._groupIsBackground=!0),i.push(P))}}catch(e){C.e(e)}finally{C.f()}return i},PPTXParser.prototype.parsePicture=function(e,t){var r=this,a={type:"picture",x:0,y:0,width:100,height:100,src:null};try{var n=e.getElementsByTagName("p:nvPicPr")[0];n&&n.getElementsByTagName("p:cNvPr")[0];var i=e.getElementsByTagName("p:blipFill")[0];if(i){var o=i.getElementsByTagName("a:blip")[0];if(o){var s=o.getElementsByTagName("asvg:svgBlip")[0],l=s?s.getAttribute("r:embed"):null,c=o.getAttribute("r:embed"),u=function(e){if(!e)return null;var a=t.find(function(t){return t.getAttribute("Id")===e});if(a){var n=a.getAttribute("Target").split("/").pop();return r.images[n]||null}return null},h=u(l),d=u(c);a.src=h||d||a.src}}var f=e.getElementsByTagName("p:spPr")[0];if(f){var p=f.getElementsByTagName("a:xfrm")[0];if(p){var g=p.getElementsByTagName("a:off")[0],m=p.getElementsByTagName("a:ext")[0];if(g){var y=parseInt(g.getAttribute("x")||"0"),v=parseInt(g.getAttribute("y")||"0");a.xEMU=y,a.yEMU=v,a.x=y/PPTXParser.SLIDE_WIDTH_EMU*100,a.y=v/PPTXParser.SLIDE_HEIGHT_EMU*100}if(m){var b=parseInt(m.getAttribute("cx")||"0"),x=parseInt(m.getAttribute("cy")||"0");a.cxEMU=b,a.cyEMU=x,a.width=b/PPTXParser.SLIDE_WIDTH_EMU*100,a.height=x/PPTXParser.SLIDE_HEIGHT_EMU*100}}}return a}catch(e){return console.warn("Error parsing picture:",e),null}};var ChartRenderer=function(){return _createClass(function e(){_classCallCheck(this,e),this.viewBoxWidth=1e3,this.viewBoxHeight=620,this.margins={top:40,right:24,bottom:96,left:96}},[{key:"render",value:function(e){if(!e)return"";var t=e.x||0,r=e.y||0,a=Math.max(1,e.width||10),n=Math.max(1,e.height||10),i="number"==typeof e.zIndex?"z-index: ".concat(e.zIndex,";"):"",o="position: absolute; left: ".concat(t,"%; top: ").concat(r,"%; width: ").concat(a,"%; height: ").concat(n,"%; box-sizing: border-box; background: #ffffff; border: 1px solid #dcdcdc; border-radius: 6px; overflow: hidden; ").concat(i);if(!e.chartData||!e.chartData.series||0===e.chartData.series.length)return this.renderPlaceholder(o,e.name||"Chart","No chart data found");var s=this.renderChart(e.chartData);return'<div class="slide-shape chart" style="'.concat(o,'">').concat(s,"</div>")}},{key:"renderChart",value:function(e){var t=(e.chartType||"column").toLowerCase();if(["column","line","area"].includes(t))return this.renderCartesian(t,e);if("pie"===t||"doughnut"===t){var r="doughnut"===t?e.holeSize||50:0;return this.renderPie(e,r)}return this.renderPlaceholder("width: 100%; height: calc(100% - 32px);","Chart","Unsupported chart type: ".concat(t))}},{key:"renderCartesian",value:function(e,t){var r,a,n=this,i=t.categories&&t.categories.length>0?t.categories:(null===(r=t.series[0])||void 0===r?void 0:r.values.map(function(e,t){return"Category ".concat(t+1)}))||[],o=t.series||[],s=t.stacking||"none",l=t.barDir||"column",c=t.legend||{position:"r",overlay:!1},u=t.axes||{},h=this.layoutLegend(o,c),d=this.applyLegendToMargins(_objectSpread({},{top:32,right:32,bottom:96,left:96}),h,c.overlay),f=this.viewBoxWidth-d.left-d.right,p=this.viewBoxHeight-d.top-d.bottom,g=this.computeDomain(o,s,i.length,u.value||{}),m=this.buildTicks(g.min,g.max,"percent"===s?100:null),y=function(e){var t=m.max-m.min||1;return d.top+p-(e-m.min)/t*p},v=function(e){var t=m.max-m.min||1;return d.left+(e-m.min)/t*f},b=i.length>0?f/i.length:f,x=i.length>0?p/i.length:p,_=.18*b,E=.18*x,w=o.length>0?(b-2*_)/o.length:b,k=o.length>0?(x-2*E)/o.length:x,T=[];"column"===e&&("column"===l?"none"===s?i.forEach(function(e,t){o.forEach(function(e,r){var a,n=(null===(a=e.values)||void 0===a?void 0:a[t])||0,i=d.left+t*b+_+r*w,o=y(0),s=y(n),l=Math.min(o,s),c=Math.abs(s-o);T.push('<rect x="'.concat(i.toFixed(2),'" y="').concat(l.toFixed(2),'" width="').concat(Math.max(4,w-4).toFixed(2),'" height="').concat(Math.max(0,c).toFixed(2),'" rx="3" fill="').concat(e.color||"#4e79a7",'" />'))})}):i.forEach(function(e,t){var r="percent"===s?o.reduce(function(e,r){var a;return e+((null===(a=r.values)||void 0===a?void 0:a[t])||0)},0):null,a=0,n=0,i=.55*b,l=d.left+t*b+(b-i)/2;o.forEach(function(e){var o,c=(null===(o=e.values)||void 0===o?void 0:o[t])||0,u="percent"===s?r>0?c/r*100:0:c;if(u>=0){var h=y(a+u),d=y(a);T.push('<rect x="'.concat(l.toFixed(2),'" y="').concat(Math.min(h,d).toFixed(2),'" width="').concat(Math.max(6,i-4).toFixed(2),'" height="').concat(Math.abs(d-h).toFixed(2),'" rx="3" fill="').concat(e.color||"#4e79a7",'" />')),a+=u}else{var f=y(n),p=y(n+u);T.push('<rect x="'.concat(l.toFixed(2),'" y="').concat(Math.min(f,p).toFixed(2),'" width="').concat(Math.max(6,i-4).toFixed(2),'" height="').concat(Math.abs(p-f).toFixed(2),'" rx="3" fill="').concat(e.color||"#4e79a7",'" />')),n+=u}})}):"none"===s?i.forEach(function(e,t){o.forEach(function(e,r){var a,n=(null===(a=e.values)||void 0===a?void 0:a[t])||0,i=d.top+t*x+E+r*k,o=v(0),s=v(n),l=Math.min(o,s),c=Math.abs(s-o);T.push('<rect x="'.concat(l.toFixed(2),'" y="').concat(i.toFixed(2),'" width="').concat(Math.max(4,c).toFixed(2),'" height="').concat(Math.max(4,k-4).toFixed(2),'" rx="3" fill="').concat(e.color||"#4e79a7",'" />'))})}):i.forEach(function(e,t){var r="percent"===s?o.reduce(function(e,r){var a;return e+((null===(a=r.values)||void 0===a?void 0:a[t])||0)},0):null,a=0,n=0,i=.55*x,l=d.top+t*x+(x-i)/2;o.forEach(function(e){var o,c=(null===(o=e.values)||void 0===o?void 0:o[t])||0,u="percent"===s?r>0?c/r*100:0:c;if(u>=0){var h=v(a),d=v(a+u);T.push('<rect x="'.concat(Math.min(h,d).toFixed(2),'" y="').concat(l.toFixed(2),'" width="').concat(Math.abs(d-h).toFixed(2),'" height="').concat(Math.max(6,i-4).toFixed(2),'" rx="3" fill="').concat(e.color||"#4e79a7",'" />')),a+=u}else{var f=v(n),p=v(n+u);T.push('<rect x="'.concat(Math.min(f,p).toFixed(2),'" y="').concat(l.toFixed(2),'" width="').concat(Math.abs(p-f).toFixed(2),'" height="').concat(Math.max(6,i-4).toFixed(2),'" rx="3" fill="').concat(e.color||"#4e79a7",'" />')),n+=u}})}));var S=[],A=[];"line"!==e&&"area"!==e||o.forEach(function(t){var r=[];if(i.forEach(function(e,a){var n,i=d.left+a*b+b/2,o=y((null===(n=t.values)||void 0===n?void 0:n[a])||0);r.push({x:i,y:o})}),0!==r.length){var a=r.map(function(e,t){return"".concat(0===t?"M":"L"," ").concat(e.x.toFixed(2)," ").concat(e.y.toFixed(2))}).join(" ");if(S.push('<path d="'.concat(a,'" fill="none" stroke="').concat(t.color||"#4e79a7",'" stroke-width="3" stroke-linejoin="round" stroke-linecap="round" />')),"area"===e){var o="".concat(a," L ").concat(r[r.length-1].x.toFixed(2)," ").concat((d.top+p).toFixed(2)," L ").concat(r[0].x.toFixed(2)," ").concat((d.top+p).toFixed(2)," Z");A.push('<path d="'.concat(o,'" fill="').concat(n.addAlpha(t.color||"#4e79a7",.2),'" stroke="none" />'))}r.forEach(function(e){S.push('<circle cx="'.concat(e.x.toFixed(2),'" cy="').concat(e.y.toFixed(2),'" r="5" fill="#ffffff" stroke="').concat(t.color||"#4e79a7",'" stroke-width="3" />'))})}});var I="bar"===l?'<line x1="'.concat(d.left,'" y1="').concat(d.top+p,'" x2="').concat(d.left,'" y2="').concat(d.top,'" stroke="#555" stroke-width="2" />'):'<line x1="'.concat(d.left,'" y1="').concat(d.top+p,'" x2="').concat(d.left+f,'" y2="').concat(d.top+p,'" stroke="#555" stroke-width="2" />'),C="bar"===l?'<line x1="'.concat(d.left,'" y1="').concat(d.top+p,'" x2="').concat(d.left+f,'" y2="').concat(d.top+p,'" stroke="#555" stroke-width="2" />'):'<line x1="'.concat(d.left,'" y1="').concat(d.top,'" x2="').concat(d.left,'" y2="').concat(d.top+p,'" stroke="#555" stroke-width="2" />'),B=(null==u||null===(a=u.value)||void 0===a?void 0:a.formatCode)||null,N=m.ticks.map(function(e){if("bar"===l){var t=v(e);return'<g>\n                    <line x1="'.concat(t.toFixed(2),'" y1="').concat((d.top+p).toFixed(2),'" x2="').concat(t.toFixed(2),'" y2="').concat((d.top+p+6).toFixed(2),'" stroke="#777" stroke-width="1" />\n                    <text x="').concat(t.toFixed(2),'" y="').concat((d.top+p+28).toFixed(2),'" text-anchor="middle" font-size="28" fill="#555">').concat(n.formatNumber(e,B),"</text>\n                </g>")}var r=y(e);return'<g>\n                <line x1="'.concat((d.left-6).toFixed(2),'" y1="').concat(r.toFixed(2),'" x2="').concat(d.left.toFixed(2),'" y2="').concat(r.toFixed(2),'" stroke="#777" stroke-width="1" />\n                <text x="').concat((d.left-10).toFixed(2),'" y="').concat((r+4).toFixed(2),'" text-anchor="end" font-size="28" fill="#555">').concat(n.formatNumber(e,B),"</text>\n            </g>")}).join(""),P=i.map(function(e,t){if("bar"===l){var r=d.top+t*x+x/2,a=d.left-12;return'<text x="'.concat(a.toFixed(2),'" y="').concat(r.toFixed(2),'" text-anchor="end" dominant-baseline="middle" font-size="28" fill="#555">').concat(n.escapeHtml(e),"</text>")}var i=d.left+t*b+b/2,o=d.top+p+42;return'<text x="'.concat(i.toFixed(2),'" y="').concat(o.toFixed(2),'" text-anchor="middle" font-size="28" fill="#555">').concat(n.escapeHtml(e),"</text>")}).join(""),F=h.svg||"";return'<svg viewBox="0 0 '.concat(this.viewBoxWidth," ").concat(this.viewBoxHeight,'" preserveAspectRatio="none" style="width: 100%; height: 100%;">\n            <rect x="0" y="0" width="').concat(this.viewBoxWidth,'" height="').concat(this.viewBoxHeight,'" fill="#ffffff" />\n            ').concat(F,"\n            ").concat(A.join(""),"\n            ").concat(I).concat(C,"\n            ").concat(N,"\n            ").concat(P,"\n            ").concat(T.join(""),"\n            ").concat(S.join(""),"\n        </svg>")}},{key:"renderPie",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=e.series&&e.series.length>0?e.series[0]:null;if(!a||!a.values||0===a.values.length)return this.renderPlaceholder("width: 100%; height: calc(100% - 32px);","Chart","No chart data found");var n=a.values.map(function(e){return Math.max(0,e)}),i=n.reduce(function(e,t){return e+t},0);if(0===i)return this.renderPlaceholder("width: 100%; height: calc(100% - 32px);","Chart","No chart values to display");var o=e.categories&&e.categories.length>0?e.categories:n.map(function(e,t){return"Slice ".concat(t+1)}),s=this.viewBoxWidth/2,l=this.viewBoxHeight/2+10,c=.32*Math.min(this.viewBoxWidth,this.viewBoxHeight),u=r>0?c*(r/100):0,h=-Math.PI/2,d=n.map(function(e,r){var a=e/i*Math.PI*2,n=h,o=h+a;h=o;var d=t.describeArc(s,l,c,n,o,u),f=t.defaultColor(r);return'<path d="'.concat(d,'" fill="').concat(f,'" stroke="#ffffff" stroke-width="2" />')}).join(""),f=o.map(function(e,r){var a=t.defaultColor(r),i=n[r];return'<g transform="translate('.concat(t.margins.left,", ").concat((t.margins.top+34*r).toFixed(2),')">\n                <rect x="0" y="0" width="24" height="24" rx="4" fill="').concat(a,'" />\n                <text x="34" y="18" font-size="26" fill="#444">').concat(t.escapeHtml(e)," (").concat(t.formatNumber(i),")</text>\n            </g>")}).join("");return'<svg viewBox="0 0 '.concat(this.viewBoxWidth," ").concat(this.viewBoxHeight,'" preserveAspectRatio="none" style="width: 100%; height: 100%;">\n            <rect x="0" y="0" width="').concat(this.viewBoxWidth,'" height="').concat(this.viewBoxHeight,'" fill="#ffffff" />\n            ').concat(d,"\n            ").concat(u>0?'<circle cx="'.concat(s,'" cy="').concat(l,'" r="').concat(u,'" fill="#ffffff" />'):"","\n            ").concat(f,"\n        </svg>")}},{key:"renderPlaceholder",value:function(e,t,r){var a=e.includes("position")?e:"position: absolute; left: 0; top: 0; ".concat(e);return'<div class="slide-shape chart-placeholder" style="'.concat(a,'; display: flex; align-items: center; justify-content: center; color: #555; font-size: 12px; text-align: center; padding: 12px; height: 100%;">\n            <div>').concat(this.escapeHtml(t),"<br><small>").concat(this.escapeHtml(r),"</small></div>\n        </div>")}},{key:"layoutLegend",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{position:"r",overlay:!1};if(!t||0===t.length)return{svg:"",width:0,height:0,position:r.position||"r"};var a=r.position||"r",n="t"===a||"b"===a||"tr"===a,i=180*t.length,o=this.viewBoxWidth-48,s=Math.min(i,o),l=n?52:42*t.length-10,c=24,u=16;"t"===a?(c=(this.viewBoxWidth-s)/2,u=16):"b"===a?(c=(this.viewBoxWidth-s)/2,u=this.viewBoxHeight-l-16):"l"===a?(c=24,u=(this.viewBoxHeight-l)/2):"r"===a?(c=this.viewBoxWidth-s-24,u=(this.viewBoxHeight-l)/2):"tr"===a&&(c=this.viewBoxWidth-s-24,u=16);var h="";return n?t.forEach(function(t,r){var a=c+180*r,n=t.color||e.defaultColor(r);h+='<g transform="translate('.concat(a,", ").concat(u,')">\n                    <rect x="0" y="0" width="26" height="26" rx="5" fill="').concat(n,'" />\n                    <text x="34" y="20" font-size="26" fill="#444">').concat(e.escapeHtml(t.name||"Series ".concat(r+1)),"</text>\n                </g>")}):t.forEach(function(t,r){var a=u+42*r,n=t.color||e.defaultColor(r);h+='<g transform="translate('.concat(c,", ").concat(a,')">\n                    <rect x="0" y="0" width="26" height="26" rx="5" fill="').concat(n,'" />\n                    <text x="34" y="20" font-size="26" fill="#444">').concat(e.escapeHtml(t.name||"Series ".concat(r+1)),"</text>\n                </g>")}),{svg:"<g>".concat(h,"</g>"),width:s,height:l,position:a}}},{key:"applyLegendToMargins",value:function(e,t){if(!t||arguments.length>2&&void 0!==arguments[2]&&arguments[2]||!t.width||!t.height)return e;switch(t.position){case"t":case"tr":e.top+=t.height+12;break;case"b":e.bottom+=t.height+12;break;case"l":e.left+=t.width+12;break;default:e.right+=t.width+12}return e}},{key:"buildTicks",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(null!==r)return{ticks:[0,25,50,75,100],min:0,max:r};var a="number"==typeof e?e:0,n="number"==typeof t?t:1;a===n&&(a-=1,n+=1);for(var i=n-a,o=this.niceNumber(i,!1),s=this.niceNumber(o/4,!0),l=Math.floor(a/s)*s,c=Math.ceil(n/s)*s,u=[],h=l;h<=c+1e-6;h+=s)u.push(parseFloat(h.toFixed(6)));return{ticks:u,min:l,max:c}}},{key:"niceNumber",value:function(e,t){var r=Math.floor(Math.log10(e)),a=e/Math.pow(10,r);return(t?a<1.5?1:a<3?2:a<7?5:10:a<=1?1:a<=2?2:a<=5?5:10)*Math.pow(10,r)}},{key:"computeDomain",value:function(e,t,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=0,i=0;if("percent"===t)n=0,i=100;else if("stacked"===t)for(var o=function(t){var r=0,a=0;e.forEach(function(e){var n,i=(null===(n=e.values)||void 0===n?void 0:n[t])||0;i>=0?r+=i:a+=i}),i=Math.max(i,r),n=Math.min(n,a)},s=0;s<r;s++)o(s);else e.forEach(function(e){(e.values||[]).forEach(function(e){"number"==typeof e&&(e>i&&(i=e),e<n&&(n=e))})});return"number"==typeof a.min&&(n=a.min),"number"==typeof a.max&&(i=a.max),n===i&&(n-=1,i+=1),{min:n,max:i}}},{key:"describeArc",value:function(e,t,r,a,n){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=n-a>Math.PI?1:0,s={x:e+r*Math.cos(a),y:t+r*Math.sin(a)},l={x:e+r*Math.cos(n),y:t+r*Math.sin(n)};if(i>0){var c={x:e+i*Math.cos(n),y:t+i*Math.sin(n)},u={x:e+i*Math.cos(a),y:t+i*Math.sin(a)};return"M ".concat(s.x," ").concat(s.y," A ").concat(r," ").concat(r," 0 ").concat(o," 1 ").concat(l.x," ").concat(l.y," L ").concat(c.x," ").concat(c.y," A ").concat(i," ").concat(i," 0 ").concat(o," 0 ").concat(u.x," ").concat(u.y," Z")}return"M ".concat(e," ").concat(t," L ").concat(s.x," ").concat(s.y," A ").concat(r," ").concat(r," 0 ").concat(o," 1 ").concat(l.x," ").concat(l.y," Z")}},{key:"addAlpha",value:function(e,t){var r=document.createElement("canvas").getContext("2d");r.fillStyle=e||"#4e79a7";var a=r.fillStyle;if(a.startsWith("#")){var n=a.replace("#",""),i=parseInt(3===n.length?n.split("").map(function(e){return e+e}).join(""):n,16),o=i>>8&255,s=255&i;return"rgba(".concat(i>>16&255,", ").concat(o,", ").concat(s,", ").concat(t,")")}return a}},{key:"formatNumber",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r="string"==typeof t&&t.includes("$"),a="string"==typeof t&&/0\.0/.test(t);if(r){var n=a?1:0,i=Math.abs(e)>=1?e.toFixed(n):e.toFixed(Math.max(2,n+1));return"$".concat(i)}return Math.abs(e)>=1e3?"".concat((e/1e3).toFixed(1),"k"):Math.abs(e)>=1?"".concat(e.toFixed(0)):e.toFixed(2)}},{key:"defaultColor",value:function(e){var t=["#4e79a7","#f28e2b","#e15759","#76b7b2","#59a14f","#edc949","#af7aa1","#ff9da7","#9c755f","#bab0ab"];return t[e%t.length]}},{key:"escapeHtml",value:function(e){var t=document.createElement("div");return t.textContent=e||"",t.innerHTML}}])}();window.ChartRenderer=ChartRenderer;var StyleBuilder=function(){return _createClass(function StyleBuilder(){_classCallCheck(this,StyleBuilder)},[{key:"createBackgroundStyle",value:function(e){if(!e)return"";switch(e.type){case"solid":case"pattern":return e.color?"background-color: ".concat(e.color,";"):"";case"gradient":return this.createGradientStyle(e.gradient);case"image":return e.image?"background-image: url('".concat(e.image,"'); background-size: cover; background-position: center;"):"";default:return""}}},{key:"createGradientStyle",value:function(e){var t=this;if(!e||!e.stops||0===e.stops.length)return"";var r=e.stops.map(function(e){var r=e.color;return void 0!==e.opacity&&e.opacity<1&&(r=t.hexToRgbaForGradient(e.color,e.opacity)),"".concat(r," ").concat(e.position,"%")}).join(", ");if("linear"===e.type||!e.type){var a=(e.angle+90)%360;return"background: linear-gradient(".concat(a,"deg, ").concat(r,");")}return"circle"===e.type||"rect"===e.type?"background: radial-gradient(circle, ".concat(r,");"):""}},{key:"hexToRgbaForGradient",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;e=e.replace("#","");var r=parseInt(e.substring(0,2),16),a=parseInt(e.substring(2,4),16),n=parseInt(e.substring(4,6),16);return"rgba(".concat(r,", ").concat(a,", ").concat(n,", ").concat(t,")")}},{key:"applyBackgroundToElement",value:function(e,t){if(t)switch(t.type){case"solid":case"pattern":t.color&&(e.style.backgroundColor=t.color);break;case"gradient":t.gradient&&(e.style.background=this.createGradientStyle(t.gradient).replace("background: ","").replace(";",""));break;case"image":t.image&&(e.style.backgroundImage="url('".concat(t.image,"')"),e.style.backgroundSize="cover",e.style.backgroundPosition="center")}}},{key:"buildImageStyle",value:function(e){var t="";return void 0!==e.x&&void 0!==e.y&&(t+="position: absolute; left: ".concat(e.x,"px; top: ").concat(e.y,"px;")),e.width&&(t+="width: ".concat(e.width,"px;")),e.height&&(t+="height: ".concat(e.height,"px;")),t}}])}();window.StyleBuilder=StyleBuilder;var TextFormatter=function(){function TextFormatter(){_classCallCheck(this,TextFormatter)}return _createClass(TextFormatter,[{key:"formatTextElement",value:function(e){var t=this;return e?"string"==typeof e?this.escapeHtml(e):e.paragraphs?e.paragraphs.map(function(e){return e.map(function(e){var r=t.escapeHtml(e.text);e.bold&&(r="<strong>".concat(r,"</strong>")),e.italic&&(r="<em>".concat(r,"</em>")),e.underline&&(r="<u>".concat(r,"</u>")),e.strikethrough&&(r="<s>".concat(r,"</s>")),e.superscript&&(r="<sup>".concat(r,"</sup>")),e.subscript&&(r="<sub>".concat(r,"</sub>"));var a="";if(e.color&&(a+="color: ".concat(e.color,";")),e.fontSize&&(a+="font-size: ".concat(e.fontSize,"pt;")),e.fontFamily){var n=t.buildFontStack(e.fontFamily);a+="font-family: ".concat(n,";")}if(e.highlight&&(a+="background-color: ".concat(e.highlight,";")),e.textTransform&&"none"!==e.textTransform&&("small-caps"===e.textTransform?a+="font-variant: small-caps;":"uppercase"===e.textTransform&&(a+="text-transform: uppercase;")),e.shadow){var i=e.shadow,o=void 0!==i.opacity?Math.min(1,Math.max(0,i.opacity)):1;a+="text-shadow: ".concat(i.offsetX||0,"px ").concat(i.offsetY||0,"px ").concat(i.blur||0,"px ").concat(i.color||"#000").concat(o<1?"".concat(Math.round(100*o)/100):"",";")}return a&&(r='<span style="'.concat(a,'">').concat(r,"</span>")),r}).join("")}).join("<br>"):"":""}},{key:"buildFontStack",value:function(e){if(!e)return"inherit";if(TextFormatter.FONT_MAP[e])return TextFormatter.FONT_MAP[e];var t=e.toLowerCase();return t.includes("sans")||t.includes("gothic")||t.includes("arial")?'"'.concat(e,'", Arial, sans-serif'):t.includes("serif")||t.includes("roman")||t.includes("times")?'"'.concat(e,'", "Times New Roman", serif'):t.includes("mono")||t.includes("courier")||t.includes("console")?'"'.concat(e,'", "Courier New", monospace'):'"'.concat(e,'", Arial, sans-serif')}},{key:"getPlainText",value:function(e){return e?"string"==typeof e?e:e.paragraphs?e.paragraphs.map(function(e){return e.map(function(e){return e.text}).join("")}).join(" "):"":""}},{key:"getTextColor",value:function(e){return e&&"string"!=typeof e&&e.paragraphs&&e.paragraphs[0]&&e.paragraphs[0][0]?e.paragraphs[0][0].color:null}},{key:"truncateText",value:function(e,t){return e.length<=t?e:e.substring(0,t)+"..."}},{key:"escapeHtml",value:function(e){if(!e)return"";var t=document.createElement("div");return t.textContent=e,t.innerHTML}}])}();_defineProperty(TextFormatter,"FONT_MAP",{Calibri:'"Calibri", "Segoe UI", Arial, sans-serif',"Calibri Light":'"Calibri Light", "Calibri", "Segoe UI Light", Arial, sans-serif',Arial:"Arial, Helvetica, sans-serif","Arial Black":'"Arial Black", Arial, sans-serif',Helvetica:"Helvetica, Arial, sans-serif",Tahoma:"Tahoma, Geneva, sans-serif",Verdana:"Verdana, Geneva, sans-serif","Trebuchet MS":'"Trebuchet MS", Helvetica, sans-serif',"Segoe UI":'"Segoe UI", Tahoma, Geneva, sans-serif',"Century Gothic":'"Century Gothic", Arial, sans-serif',"Gill Sans MT":'"Gill Sans MT", "Gill Sans", Arial, sans-serif',"Franklin Gothic Medium":'"Franklin Gothic Medium", "Franklin Gothic", Arial, sans-serif',"Times New Roman":'"Times New Roman", Times, serif',Georgia:'Georgia, "Times New Roman", serif',"Palatino Linotype":'"Palatino Linotype", Palatino, Georgia, serif',"Book Antiqua":'"Book Antiqua", Palatino, Georgia, serif',Garamond:'Garamond, "Times New Roman", serif',Cambria:"Cambria, Georgia, serif","Courier New":'"Courier New", Courier, monospace',Consolas:'Consolas, Monaco, "Courier New", monospace',"Lucida Console":'"Lucida Console", Monaco, monospace',Impact:'Impact, "Arial Black", sans-serif',"Comic Sans MS":'"Comic Sans MS", cursive, sans-serif',"Brush Script MT":'"Brush Script MT", cursive',Aptos:"Aptos, Calibri, Arial, sans-serif","Aptos Display":'"Aptos Display", Aptos, Calibri, Arial, sans-serif'}),window.TextFormatter=TextFormatter;var ShapeRenderer=function(){return _createClass(function ShapeRenderer(e,t){_classCallCheck(this,ShapeRenderer),this.styleBuilder=e,this.textFormatter=t,this.chartRenderer=new ChartRenderer},[{key:"renderShapes",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(t.some(function(e){return"number"==typeof(null==e?void 0:e.zIndex)})?_toConsumableArray(t).map(function(e,t){return{shape:e,originalIndex:t}}).sort(function(e,t){var r="number"==typeof e.shape.zIndex?e.shape.zIndex:Number.POSITIVE_INFINITY,a="number"==typeof t.shape.zIndex?t.shape.zIndex:Number.POSITIVE_INFINITY;return r!==a?r-a:e.originalIndex-t.originalIndex}).map(function(e){return e.shape}):t).map(function(t){return e.renderShape(t)}).join("")}},{key:"renderShape",value:function(e){if(!e)return"";if("group"===e.type&&Array.isArray(e.shapes))return this.renderShapes(e.shapes);var t=this.buildShapeStyle(e),r=this.getShapeClipPath(e.type),a=e.rotation?"transform: rotate(".concat(e.rotation,"deg);"):"";if(e.flipH||e.flipV){var n=e.flipH?-1:1,i=e.flipV?-1:1;a=a?a.replace("transform:","transform: scale(".concat(n,", ").concat(i,")")):"transform: scale(".concat(n,", ").concat(i,");")}if("picture"===e.type&&e.src){var o="".concat(t).concat(a);return'<div class="slide-shape picture" style="'.concat(o,'"><img src="').concat(e.src,'" alt="" /></div>')}if("custom"===e.type&&e.customGeometry)return this.renderCustomGeometry(e);if(this.isLineShape(e.type))return this.renderLineShape(e);if("table"===e.type)return this.renderTableShape(e);if("chart"===e.type)return this.chartRenderer.render(e);var s="",l=!1;if(e.text){var c=this.buildTextBoxStyle(e);s='<div class="shape-text-box" style="'.concat(c,'">').concat(this.formatShapeText(e.text),"</div>"),l=!0}var u="".concat(t).concat(r).concat(a);return'<div class="'.concat(l?"slide-shape with-text":"slide-shape",'" style="').concat(u,'">').concat(s,"</div>")}},{key:"isLineShape",value:function(e){return["line","straightConnector1","bentConnector2","bentConnector3","bentConnector4","bentConnector5","curvedConnector2","curvedConnector3","curvedConnector4","curvedConnector5"].includes(e)}},{key:"buildTextBoxStyle",value:function(e){var t="number"==typeof e.cxEMU&&e.cxEMU>0?e.cxEMU:null,r="number"==typeof e.cyEMU&&e.cyEMU>0?e.cyEMU:null,a=0,n=0,i=0,o=0;e.textInsetsEMU&&t&&r&&(a=e.textInsetsEMU.left/t*100,n=e.textInsetsEMU.right/t*100,i=e.textInsetsEMU.top/r*100,o=e.textInsetsEMU.bottom/r*100);var s=e.textAutoFit||null,l="norm"===s?"visible":"hidden",c="position: absolute; left: ".concat(a,"%; top: ").concat(i,"%; right: ").concat(n,"%; bottom: ").concat(o,"%; box-sizing: border-box; overflow: ").concat(l,"; display: flex; flex-direction: column; align-items: stretch;");return"norm"===s&&(c+="font-size: 0.9em; line-height: 1.12; height: auto; min-height: 100%; bottom: auto;"),"bottom"===e.textVAlign?c+="justify-content: flex-end;":"middle"===e.textVAlign?c+="justify-content: center;":c+="justify-content: flex-start;",!1===e.textWrap?c+="white-space: nowrap;":c+="white-space: normal;",c}},{key:"renderLineShape",value:function(e){var t=e.stroke||"#000000",r=Math.max(1,e.strokeWidth||1),a=e.x,n=e.y,i=Math.max(.1,e.width),o=Math.max(.1,e.height),s=0,l=0,c="100%",u="100%";if(e.linePoints)s="".concat(e.linePoints.x1,"%"),l="".concat(e.linePoints.y1,"%"),c="".concat(e.linePoints.x2,"%"),u="".concat(e.linePoints.y2,"%");else{if(o<=.2*i?(l="50%",u="50%",s=0,c="100%"):i<=.2*o&&(s="50%",c="50%",l=0,u="100%"),e.flipH){var h=s;s=c,c=h}if(e.flipV){var d=l;l=u,u=d}}var f="number"==typeof e.zIndex?"z-index: ".concat(e.zIndex,";"):"",p="position: absolute; left: ".concat(a,"%; top: ").concat(n,"%; width: ").concat(i,"%; height: ").concat(o,"%; overflow: visible; ").concat(f),g=Math.random().toString(36).slice(2,9),m=e.startCxn&&e.arrowTail||e.arrowTail&&!e.startCxn?"arrow-start-".concat(g):null,y=e.endCxn&&e.arrowHead||e.arrowHead&&!e.endCxn?"arrow-end-".concat(g):null,v=m?'\n            <marker id="'.concat(m,'" viewBox="0 0 10 10" refX="2" refY="5" markerWidth="6" markerHeight="6" orient="auto">\n                <path d="M0 0 L10 5 L0 10 Z" fill="').concat(t,'" />\n            </marker>'):"",b=y?'\n            <marker id="'.concat(y,'" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto">\n                <path d="M0 0 L10 5 L0 10 Z" fill="').concat(t,'" />\n            </marker>'):"",x=m?'marker-start="url(#'.concat(m,')"'):"",_=y?'marker-end="url(#'.concat(y,')"'):"";return'<div class="slide-shape line-shape" style="'.concat(p,'">\n            <svg width="100%" height="100%" preserveAspectRatio="none" style="overflow: visible;">\n                <defs>').concat(v).concat(b,'</defs>\n                <line x1="').concat(s,'" y1="').concat(l,'" x2="').concat(c,'" y2="').concat(u,'" \n                      stroke="').concat(t,'" stroke-width="').concat(r,'" stroke-linecap="round" ').concat(x," ").concat(_,"/>\n            </svg>\n        </div>")}},{key:"renderCustomGeometry",value:function(e){if(!e.customGeometry||!e.customGeometry.paths||0===e.customGeometry.paths.length)return this.renderShape(_objectSpread(_objectSpread({},e),{},{type:"rect"}));var t,r=e.x,a=e.y,n=Math.max(.1,e.width),i=Math.max(.1,e.height),o="",s=_createForOfIteratorHelper(e.customGeometry.paths);try{for(s.s();!(t=s.n()).done;){var l=t.value,c="none"===e.fill?"none":"string"==typeof e.fill?e.fill:"#ffffff",u=e.stroke&&"none"!==e.stroke?e.stroke:"none",h=e.strokeWidth||1;o+='<path d="'.concat(l.data,'" \n                            fill="').concat(c,'" \n                            stroke="').concat(u,'" \n                            stroke-width="').concat(h,'"\n                            vector-effect="non-scaling-stroke"/>')}}catch(e){s.e(e)}finally{s.f()}var d="number"==typeof e.zIndex?"z-index: ".concat(e.zIndex,";"):"",f=e.rotation?"transform: rotate(".concat(e.rotation,"deg);"):"",p="position: absolute; left: ".concat(r,"%; top: ").concat(a,"%; width: ").concat(n,"%; height: ").concat(i,"%; overflow: visible; ").concat(f).concat(d),g="";if(e.text){var m=this.buildTextBoxStyle(e);g='<div class="shape-text-box" style="'.concat(m,'">').concat(this.formatShapeText(e.text),"</div>")}return'<div class="slide-shape custom-geometry" style="'.concat(p,'">\n            <svg width="100%" height="100%" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid meet" style="overflow: visible;">\n                ').concat(o,"\n            </svg>\n            ").concat(g,"\n        </div>")}},{key:"renderTableShape",value:function(e){var t,r,a=e.columnWidths||[],n=e.rows||[],i=e.rowHeights||[],o=Math.max(1,e.width||10),s=Math.max(1,e.height||10),l=e.x||0,c=e.y||0,u=a.length>0?a.map(function(e){return"".concat(e.toFixed(2),"%")}).join(" "):"repeat(".concat((null===(t=n[0])||void 0===t||null===(t=t.cells)||void 0===t?void 0:t.length)||1,", 1fr)"),h=i.length>0?i.map(function(e){return"".concat(e.toFixed(2),"%")}).join(" "):"repeat(".concat(n.length||1,", 1fr)"),d="number"==typeof e.zIndex?"z-index: ".concat(e.zIndex,";"):"",f=e.rotation?"transform: rotate(".concat(e.rotation,"deg);"):"",p="position: absolute; left: ".concat(l,"%; top: ").concat(c,"%; width: ").concat(o,"%; height: ").concat(s,"%; display: grid; grid-template-columns: ").concat(u,"; grid-template-rows: ").concat(h,"; ").concat(d).concat(f,"box-sizing: border-box;"),g="",m=_createForOfIteratorHelper(n);try{for(m.s();!(r=m.n()).done;){var y,v=r.value,b=_createForOfIteratorHelper(v.cells||[]);try{for(b.s();!(y=b.n()).done;){var x=y.value,_=Math.max(1,x.colSpan||1),E=Math.max(1,x.rowSpan||1),w="";if(x.fill&&"none"!==x.fill)if("string"==typeof x.fill)w="background-color: ".concat(x.fill,";");else if("gradient"===x.fill.type&&x.fill.gradient&&Array.isArray(x.fill.gradient.stops)){var k=x.fill.gradient.stops[0],T=(null==k?void 0:k.color)||"#ffffff";w="background-color: ".concat(T,";")}var S=x.margins||{l:8,r:8,t:4,b:4},A="padding: ".concat(S.t/4,"px ").concat(S.r/4,"px ").concat(S.b/4,"px ").concat(S.l/4,"px;"),I="border: 1px solid #ddd;";if(x.borders){var C=[];x.borders.top&&C.push("border-top: ".concat(x.borders.top.width,"px solid ").concat(x.borders.top.color,";")),x.borders.bottom&&C.push("border-bottom: ".concat(x.borders.bottom.width,"px solid ").concat(x.borders.bottom.color,";")),x.borders.left&&C.push("border-left: ".concat(x.borders.left.width,"px solid ").concat(x.borders.left.color,";")),x.borders.right&&C.push("border-right: ".concat(x.borders.right.width,"px solid ").concat(x.borders.right.color,";")),C.length>0?I=C.join(""):x.stroke&&(I="border: ".concat(x.strokeWidth||1,"px solid ").concat(x.stroke,";"))}var B="";(x.isHeader||v.isHeader)&&(B="font-weight: 700; text-align: center; vertical-align: middle;");var N=_>1?"grid-column: span ".concat(_,";"):"",P=E>1?"grid-row: span ".concat(E,";"):"",F=x.text?'<div class="table-text-box">'.concat(this.formatShapeText(x.text),"</div>"):"";g+='<div class="table-cell" style="box-sizing: border-box; overflow: hidden; '.concat(I).concat(w).concat(A).concat(B).concat(N).concat(P,'">').concat(F,"</div>")}}catch(e){b.e(e)}finally{b.f()}}}catch(e){m.e(e)}finally{m.f()}return'<div class="slide-shape table-shape" style="'.concat(p,'">').concat(g,"</div>")}},{key:"buildShapeStyle",value:function(e){var t=void 0!==ShapeParser&&ShapeParser.SLIDE_WIDTH_EMU?ShapeParser.SLIDE_WIDTH_EMU:9144e3,r=void 0!==ShapeParser&&ShapeParser.SLIDE_HEIGHT_EMU?ShapeParser.SLIDE_HEIGHT_EMU:5143500,a="number"==typeof e.width?e.width:0,n="number"==typeof e.height?e.height:0;(0===a||!Number.isFinite(a))&&"number"==typeof e.cxEMU&&e.cxEMU>0&&(a=e.cxEMU/t*100),(0===n||!Number.isFinite(n))&&"number"==typeof e.cyEMU&&e.cyEMU>0&&(n=e.cyEMU/r*100),a=Math.max(.1,a),n=Math.max(.1,n);var i=e.x||0,o=e.y||0;!e.isPlaceholder||"sldNum"!==e.placeholderType&&"ftr"!==e.placeholderType&&"dt"!==e.placeholderType||(i=100-a-1,o=100-n-1);var s="position: absolute; left: ".concat(i,"%; top: ").concat(o,"%; width: ").concat(a,"%; height: ").concat(n,"%; box-sizing: border-box;");if("number"==typeof e.zIndex&&(s+="z-index: ".concat(e.zIndex,";")),e.fill)if("none"===e.fill)s+="background: transparent;";else if("string"==typeof e.fill)s+="background-color: ".concat(e.fill,";");else if("solid"===e.fill.type&&e.fill.color){var l=e.fill.color,c=void 0!==e.fill.opacity?e.fill.opacity:1;if(c<1){var u=this.hexToRgba(l,c);s+="background-color: ".concat(u,";")}else s+="background-color: ".concat(l,";")}else"gradient"===e.fill.type?s+=this.styleBuilder.createGradientStyle(e.fill.gradient):"image"===e.fill.type&&e.fill.src&&(s+="background-image: url('".concat(e.fill.src,"'); background-size: cover; background-position: center;"));if("picture"===e.type&&e.src&&(s+="background-image: url('".concat(e.src,"'); background-size: contain; background-repeat: no-repeat; background-position: center;")),e.stroke&&"none"!==e.stroke?s+="border: ".concat(Math.max(1,e.strokeWidth),"px solid ").concat(e.stroke,";"):"none"===e.stroke&&(s+="border: none;"),e.shadow){var h=e.shadow,d=(h.distance||0)*Math.cos((h.angle||0)*Math.PI/180),f=(h.distance||0)*Math.sin((h.angle||0)*Math.PI/180),p=h.blur||0,g=h.color||"#000000",m=void 0!==h.opacity?h.opacity:1,y=this.hexToRgba(g,m);s+="box-shadow: ".concat(d,"px ").concat(f,"px ").concat(p,"px ").concat(y,";")}if(null!==e.cornerRadius&&void 0!==e.cornerRadius){var v=100*e.cornerRadius;s+="border-radius: ".concat(v,"%;")}return this.apply3DEffects(e,s)}},{key:"apply3DEffects",value:function(e,t){var r=e.type;if("cube"===r)t+="filter: drop-shadow(-2px 2px 3px rgba(0,0,0,0.3)); transform: perspective(1000px) rotateX(5deg) rotateY(-5deg);",t+="box-shadow: inset -2px -2px 5px rgba(0,0,0,0.2), inset 2px 2px 5px rgba(255,255,255,0.3);";else if("cylinder"===r)t+="filter: drop-shadow(-2px 2px 3px rgba(0,0,0,0.3)); box-shadow: inset -3px 0 5px rgba(0,0,0,0.2);";else if("sphere"===r)t+="filter: drop-shadow(-3px 3px 5px rgba(0,0,0,0.3)); box-shadow: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.4), transparent), inset -2px -2px 5px rgba(0,0,0,0.2);";else if("cone"===r)t+="filter: drop-shadow(-2px 2px 3px rgba(0,0,0,0.3)); box-shadow: inset 2px 2px 5px rgba(0,0,0,0.15);";else if("pyramid"===r)t+="filter: drop-shadow(-2px 3px 4px rgba(0,0,0,0.3)); transform: perspective(1000px) rotateX(3deg);";else if("tetrahedron"===r)t+="filter: drop-shadow(-2px 2px 3px rgba(0,0,0,0.25)); box-shadow: inset 1px 1px 3px rgba(0,0,0,0.1);";else if("octahedron"===r)t+="filter: drop-shadow(-2px 2px 3px rgba(0,0,0,0.3)); box-shadow: inset -1px -1px 3px rgba(0,0,0,0.15);";else if("ribbon"===r||"ribbon2"===r){if(t+="filter: drop-shadow(2px 2px 3px rgba(0,0,0,0.2));",e.fill&&"string"==typeof e.fill){var a=e.fill;t=t.replace("background-color: ".concat(a),"background: linear-gradient(135deg, ".concat(a," 0%, ").concat(this.adjustBrightness(a,-20)," 100%)"))}}else r.includes("curved")||"doubleWave"===r?t+="filter: drop-shadow(1px 2px 2px rgba(0,0,0,0.15));":(r.includes("action")||r.includes("explosion")||r.includes("star"))&&(t+="filter: drop-shadow(1px 1px 2px rgba(0,0,0,0.15));");return t}},{key:"adjustBrightness",value:function(e,t){var r=e.replace("#",""),a=parseInt(r,16);return"#"+(16777216+65536*Math.min(255,Math.max(0,(a>>16)+t))+256*Math.min(255,Math.max(0,(a>>8&255)+t))+Math.min(255,Math.max(0,(255&a)+t))).toString(16).slice(1)}},{key:"hexToRgba",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;e=e.replace("#","");var r=parseInt(e.substring(0,2),16),a=parseInt(e.substring(2,4),16),n=parseInt(e.substring(4,6),16);return"rgba(".concat(r,", ").concat(a,", ").concat(n,", ").concat(t,")")}},{key:"getShapeClipPath",value:function(e){return{square:"",ellipse:"border-radius: 50%;",circle:"border-radius: 50%;",roundSquare:"border-radius: min(10px, 3%);",roundRect:"border-radius: min(10px, 3%);",triangle:"clip-path: polygon(50% 0%, 0% 100%, 100% 100%);",rightTriangle:"clip-path: polygon(0% 0%, 0% 100%, 100% 100%);",diamond:"clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%);",pentagon:"clip-path: polygon(50% 0%, 100% 38%, 82% 100%, 18% 100%, 0% 38%);",hexagon:"clip-path: polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%);",heptagon:"clip-path: polygon(50% 0%, 90% 20%, 100% 60%, 75% 100%, 25% 100%, 0% 60%, 10% 20%);",octagon:"clip-path: polygon(30% 0%, 70% 0%, 100% 30%, 100% 70%, 70% 100%, 30% 100%, 0% 70%, 0% 30%);",star5:"clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);",star4:"clip-path: polygon(50% 0%, 61% 39%, 100% 50%, 61% 61%, 50% 100%, 39% 61%, 0% 50%, 39% 39%);",star6:"clip-path: polygon(50% 0%, 61% 25%, 90% 10%, 75% 40%, 95% 60%, 60% 50%, 75% 90%, 50% 65%, 25% 90%, 40% 50%, 5% 60%, 25% 40%, 10% 10%);",parallelogram:"clip-path: polygon(20% 0%, 100% 0%, 80% 100%, 0% 100%);",trapezoid:"clip-path: polygon(20% 0%, 80% 0%, 100% 100%, 0% 100%);",arrow:"clip-path: polygon(0% 20%, 65% 20%, 65% 0%, 100% 50%, 65% 100%, 65% 80%, 0% 80%);",rightArrow:"clip-path: polygon(0% 20%, 60% 20%, 60% 0%, 100% 50%, 60% 100%, 60% 80%, 0% 80%);",leftArrow:"clip-path: polygon(40% 0%, 40% 20%, 100% 20%, 100% 80%, 40% 80%, 40% 100%, 0% 50%);",upArrow:"clip-path: polygon(50% 0%, 100% 40%, 80% 40%, 80% 100%, 20% 100%, 20% 40%, 0% 40%);",downArrow:"clip-path: polygon(20% 0%, 80% 0%, 80% 60%, 100% 60%, 50% 100%, 0% 60%, 20% 60%);",heart:"clip-path: polygon(50% 100%, 0% 30%, 25% 0%, 50% 15%, 75% 0%, 100% 30%);",speechBubble:"clip-path: polygon(0% 0%, 100% 0%, 100% 85%, 20% 85%, 10% 100%, 15% 85%, 0% 85%);",speechBubbleOval:"clip-path: ellipse(50% 45% at 50% 45%); position: relative;",calloutRect:"clip-path: polygon(0% 0%, 85% 0%, 100% 50%, 85% 100%, 0% 100%);",calloutRoundRect:"clip-path: polygon(5% 0%, 85% 0%, 100% 5%, 100% 50%, 100% 95%, 85% 100%, 5% 100%, 0% 95%, 0% 5%);",calloutOval:"border-radius: 50%;",flowChartProcess:"",flowChartDecision:"clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%);",flowChartInputOutput:"clip-path: polygon(20% 0%, 100% 0%, 80% 100%, 0% 100%);",flowChartTerminator:"clip-path: polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%);",flowChartData:"clip-path: polygon(0% 25%, 100% 0%, 100% 75%, 0% 100%);",flowChartDocument:"clip-path: polygon(0% 0%, 100% 0%, 100% 85%, 50% 100%, 0% 85%);",flowChartMultidocument:"clip-path: polygon(0% 10%, 100% 0%, 100% 90%, 10% 100%, 0% 85%);",flowChartPredefinedProcess:"clip-path: polygon(10% 0%, 90% 0%, 100% 50%, 90% 100%, 10% 100%, 0% 50%);",cube:"perspective(600px);",cylinder:"clip-path: ellipse(50% 30% at 50% 30%);",sphere:"border-radius: 50%;",cone:"clip-path: polygon(50% 0%, 100% 100%, 0% 100%);",pyramid:"clip-path: polygon(50% 0%, 100% 100%, 0% 100%);",blockArcRight:"clip-path: polygon(0% 25%, 75% 25%, 75% 0%, 100% 50%, 75% 100%, 75% 75%, 0% 75%);",blockArcLeft:"clip-path: polygon(25% 25%, 100% 25%, 100% 75%, 25% 75%, 25% 100%, 0% 50%, 25% 0%);",blockArcUp:"clip-path: polygon(25% 25%, 75% 25%, 100% 0%, 50% 25%, 0% 0%, 25% 25%, 25% 100%, 75% 100%, 75% 75%, 25% 75%);",blockArcDown:"clip-path: polygon(25% 0%, 75% 0%, 75% 25%, 100% 100%, 50% 75%, 0% 100%, 25% 25%, 25% 100%, 75% 100%, 75% 75%);",flowChartOffPage:"clip-path: polygon(0% 0%, 100% 0%, 100% 70%, 85% 85%, 85% 100%, 0% 100%);",flowChartMerge:"clip-path: polygon(0% 0%, 100% 0%, 50% 50%, 100% 100%, 0% 100%);",flowChartExtract:"clip-path: polygon(0% 50%, 50% 0%, 100% 50%, 50% 100%);",flowChartOr:"border-radius: 50%;",flowChartSum:"clip-path: polygon(50% 0%, 100% 30%, 75% 50%, 100% 70%, 50% 100%, 0% 70%, 25% 50%, 0% 30%);",flowChartSort:"clip-path: polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%);",flowChartManualInput:"clip-path: polygon(0% 20%, 100% 0%, 100% 100%, 0% 80%);",flowChartDelay:'clip-path: path("M 0,0 L 70,0 Q 100,0 100,30 Q 100,100 100,100 L 0,100 Q 0,50 0,0");',tetrahedron:"clip-path: polygon(50% 0%, 100% 85%, 0% 85%);",octahedron:"clip-path: polygon(50% 0%, 100% 37%, 75% 62%, 100% 100%, 50% 75%, 0% 100%, 25% 62%, 0% 37%);",quadArrow:"clip-path: polygon(35% 0%, 65% 0%, 65% 35%, 100% 35%, 100% 65%, 65% 65%, 65% 100%, 35% 100%, 35% 65%, 0% 65%, 0% 35%, 35% 35%);",leftRightArrow:"clip-path: polygon(0% 40%, 40% 40%, 40% 0%, 60% 0%, 60% 40%, 100% 40%, 100% 60%, 60% 60%, 60% 100%, 40% 100%, 40% 60%, 0% 60%);",upDownArrow:"clip-path: polygon(40% 0%, 60% 0%, 60% 40%, 100% 40%, 50% 60%, 0% 40%, 40% 40%, 40% 100%, 60% 100%, 60% 60%, 50% 40%);",ribbon:"clip-path: polygon(0% 0%, 100% 10%, 90% 50%, 100% 90%, 0% 100%, 10% 50%);",ribbon2:"clip-path: polygon(10% 0%, 100% 0%, 90% 50%, 100% 100%, 10% 100%, 0% 50%);",doubleWave:'clip-path: path("M 0,50 Q 25,20 50,50 T 100,50 L 100,100 Q 75,70 50,100 T 0,100");',chevron:"clip-path: polygon(0% 0%, 75% 0%, 100% 50%, 75% 100%, 0% 100%, 25% 50%);",chevronRight:"clip-path: polygon(0% 0%, 75% 0%, 100% 50%, 75% 100%, 0% 100%, 25% 50%);",curvedUpArrow:'clip-path: path("M 0,100 Q 50,0 100,100 L 85,80 Q 50,40 15,80");',curvedDownArrow:'clip-path: path("M 0,0 Q 50,100 100,0 L 85,20 Q 50,60 15,20");',curvedLeftArrow:'clip-path: path("M 100,0 Q 0,50 100,100 L 80,85 Q 40,50 80,15");',curvedRightArrow:'clip-path: path("M 0,0 Q 100,50 0,100 L 20,85 Q 60,50 20,15");'}[e]||""}},{key:"formatShapeText",value:function(e){var t=this;if(!e||!Array.isArray(e))return"";var r=new Array(10).fill(null);return e.map(function(e){var a=(null==e?void 0:e[0])||{},n=a.align||"left",i="number"==typeof a.lvl?a.lvl:0,o=a.bullet||null,s="number"==typeof a.spaceBeforeEm?a.spaceBeforeEm:null,l="number"==typeof a.spaceAfterEm?a.spaceAfterEm:null,c="number"==typeof a.lineHeight?a.lineHeight:null,u=e.map(function(e){var r=t.textFormatter.escapeHtml(e.text),a="";if(e.color&&(a+="color: ".concat(e.color,";")),e.highlight&&(a+="background-color: ".concat(e.highlight,";")),e.fontSize){var n=e.fontSize/18;a+="font-size: ".concat(n.toFixed(3),"em;")}e.fontFamily&&(a+="font-family: ".concat(e.fontFamily,";")),e.bold&&(a+="font-weight: 700;"),e.italic&&(a+="font-style: italic;");var i,o=[];if(e.underline&&o.push("underline"),e.strikethrough&&o.push("line-through"),o.length&&(a+="text-decoration: ".concat(o.join(" "),";")),e.textTransform&&"none"!==e.textTransform&&("small-caps"===e.textTransform?a+="font-variant: small-caps;":"uppercase"===e.textTransform&&(a+="text-transform: uppercase;")),e.shadow){var s=e.shadow;void 0!==s.opacity&&Math.min(1,Math.max(0,s.opacity)),a+="text-shadow: ".concat(s.offsetX||0,"px ").concat(s.offsetY||0,"px ").concat(s.blur||0,"px ").concat(s.color||"#000").concat("",";")}if(a&&(r='<span style="'.concat(a,'">').concat(r,"</span>")),e.superscript&&(r="<sup>".concat(r,"</sup>")),e.subscript&&(r="<sub>".concat(r,"</sub>")),e.link&&"url"===e.link.kind&&e.link.href){var l=(i=e.link.href,String(null!=i?i:"").replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;"));r='<a class="pptx-link" href="'.concat(l,'" target="_blank" rel="noopener noreferrer">').concat(r,"</a>")}else e.link&&"slide"===e.link.kind&&Number.isFinite(e.link.slideIndex)&&(r='<a class="pptx-link" href="#" data-pptx-slide="'.concat(e.link.slideIndex,'">').concat(r,"</a>"));return r}).join(""),h=o&&"none"!==o.type&&("char"===o.type||"auto"===o.type),d="number"==typeof a.marLEm?a.marLEm:null,f="number"==typeof a.indentEm?a.indentEm:null,p=null!==s?"margin-top: ".concat(s.toFixed(3),"em;"):"",g=null!==l?"margin-bottom: ".concat(l.toFixed(3),"em;"):"",m=null!==c?"line-height: ".concat(c.toFixed(3),";"):"",y="".concat(p).concat(g).concat(m);if(!h){for(var v=i;v<r.length;v++)r[v]=null;var b=null!==d?"padding-left: ".concat(d.toFixed(3),"em;"):"",x=null!==f?"text-indent: ".concat(f.toFixed(3),"em;"):"";return'<div class="pptx-paragraph" style="text-align: '.concat(n,"; white-space: inherit; ").concat(b).concat(x).concat(y,'">').concat(u,"</div>")}for(var _=i+1;_<r.length;_++)r[_]=null;var E="";if("auto"===o.type){var w=Number.isFinite(o.startAt)?o.startAt:1;null===r[i]&&(r[i]=w);var k=(o.numType||"").toLowerCase(),T=function(e){var t=Math.max(1,e);if(k.includes("roman")){var r=function(e){for(var t=e,r="",a=0,n=[{v:1e3,s:"M"},{v:900,s:"CM"},{v:500,s:"D"},{v:400,s:"CD"},{v:100,s:"C"},{v:90,s:"XC"},{v:50,s:"L"},{v:40,s:"XL"},{v:10,s:"X"},{v:9,s:"IX"},{v:5,s:"V"},{v:4,s:"IV"},{v:1,s:"I"}];a<n.length;a++)for(var i=n[a];t>=i.v;)r+=i.s,t-=i.v;return r}(t);return k.includes("lc")?r.toLowerCase():r}return k.includes("alpha")||k.includes("alph")?function(e,t){for(var r=e,a="";r>0;)r--,a=String.fromCharCode(97+r%26)+a,r=Math.floor(r/26);return t?a.toUpperCase():a}(t,k.includes("uc")):String(t)}(r[i]),S="",A=".";k.includes("parenboth")?(S="(",A=")"):A=k.includes("parenr")||k.includes("paren")?")":(k.includes("period"),"."),E="".concat(S).concat(T).concat(A),r[i]+=1}else E=o.char||"";var I=null!==d?d:1.25*i,C=null!==f&&f<0?f:0,B=null!==f&&f<0?Math.max(.5,-f):1.2,N=Math.max(0,Math.min(9,i));return'\n                <div class="pptx-paragraph pptx-bullet pptx-lvl-'.concat(N,'" style="padding-left: ').concat(I.toFixed(3),"em; ").concat(y,'">\n                    <span class="pptx-bullet-marker" style="margin-left: ').concat(C.toFixed(3),"em; width: ").concat(B.toFixed(3),'em;">').concat(t.textFormatter.escapeHtml(E),'</span>\n                    <span class="pptx-bullet-content" style="text-align: ').concat(n,';">').concat(u,"</span>\n                </div>\n            ")}).join("")}}])}();window.ShapeRenderer=ShapeRenderer;var SlideRenderer=function(){return _createClass(function SlideRenderer(){_classCallCheck(this,SlideRenderer),this.styleBuilder=new StyleBuilder,this.textFormatter=new TextFormatter,this.shapeRenderer=new ShapeRenderer(this.styleBuilder,this.textFormatter)},[{key:"createSlideHTML",value:function(e){var t,r,a,n;if(!e||!e.shapes)return'<div class="slide" style="background: white;"></div>';var i=this.buildBackgroundStyle(e.background),o=(null===(t=e.slideSize)||void 0===t?void 0:t.ratio)||16/9,s=(null===(r=e.slideSize)||void 0===r?void 0:r.invRatio)||9/16,l=null!==(a=e.slideSize)&&void 0!==a&&a.cx&&null!==(n=e.slideSize)&&void 0!==n&&n.cy?"".concat(e.slideSize.cx," / ").concat(e.slideSize.cy):"16 / 9",c=e.shapes.length>0?this.shapeRenderer.renderShapes(e.shapes):"";return'\n            <div class="slide-wrapper">\n                <div class="slide" style="'.concat(i," --slide-ratio: ").concat(o,"; --slide-inv-ratio: ").concat(s,"; aspect-ratio: ").concat(l,';">\n                    <div class="slide-shapes-container">\n                        ').concat(c,"\n                    </div>\n                </div>\n            </div>\n        ")}},{key:"createThumbnail",value:function(e,t,r){var a,n,i,o,s=document.createElement("div");s.className="thumbnail",s.dataset.slide=t;var l=this.buildBackgroundStyle(e.background),c=(null===(a=e.slideSize)||void 0===a?void 0:a.ratio)||16/9,u=(null===(n=e.slideSize)||void 0===n?void 0:n.invRatio)||9/16,h=null!==(i=e.slideSize)&&void 0!==i&&i.cx&&null!==(o=e.slideSize)&&void 0!==o&&o.cy?"".concat(e.slideSize.cx," / ").concat(e.slideSize.cy):"16 / 9";s.style.setProperty("--slide-ratio",c),s.style.setProperty("--slide-inv-ratio",u),s.style.aspectRatio=h;var d=e.shapes&&e.shapes.length>0?this.shapeRenderer.renderShapes(e.shapes):"",f=document.createElement("div");f.className="thumbnail-slide",f.style.cssText="".concat(l," --slide-ratio: ").concat(c,"; --slide-inv-ratio: ").concat(u,"; aspect-ratio: ").concat(h,";"),f.innerHTML='\n            <div class="slide-shapes-container">\n                '.concat(d,"\n            </div>\n        "),s.appendChild(f);var p=document.createElement("div");return p.className="thumbnail-number",p.textContent=(t+1).toString(),s.appendChild(p),s.addEventListener("click",function(){return r(t)}),s}},{key:"buildBackgroundStyle",value:function(e){if(!e)return"background: white;";var t="";switch(e.type){case"solid":case"pattern":t=e.color?"background: ".concat(e.color,";"):"background: white;";break;case"gradient":t=e.gradient?this.buildGradientStyle(e.gradient):"background: white;";break;case"image":t=e.image?"background-image: url(".concat(e.image,"); background-size: cover; background-position: center;"):"background: white;";break;default:t="background: white;"}return t}},{key:"buildGradientStyle",value:function(e){if(!e||!e.stops||0===e.stops.length)return"background: white;";try{var t=e.angle||90,r=e.stops.map(function(e){return"".concat(e.color," ").concat(100*e.position,"%")}).join(", ");return"background: linear-gradient(".concat(t,"deg, ").concat(r,");")}catch(e){return console.warn("Error building gradient style:",e),"background: white;"}}},{key:"scaleValue",value:function(e){return e*(arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2)}}])}(),ThemeManager=function(){return _createClass(function ThemeManager(){_classCallCheck(this,ThemeManager),this.themeToggle=document.getElementById("theme-toggle"),this.initialize()},[{key:"initialize",value:function(){var e=this,t=localStorage.getItem("theme");if(t)this.setTheme(t);else{var r=window.matchMedia("(prefers-color-scheme: dark)").matches;this.setTheme(r?"dark":"light")}window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",function(t){localStorage.getItem("theme")||e.setTheme(t.matches?"dark":"light")}),this.themeToggle&&this.themeToggle.addEventListener("click",function(){return e.toggle()})}},{key:"toggle",value:function(){var e="dark"===document.documentElement.getAttribute("data-theme")?"light":"dark";this.setTheme(e),localStorage.setItem("theme",e)}},{key:"setTheme",value:function(e){document.documentElement.setAttribute("data-theme",e)}},{key:"getTheme",value:function(){return document.documentElement.getAttribute("data-theme")||"dark"}}])}();window.ThemeManager=ThemeManager;var KeyboardManager=function(){return _createClass(function KeyboardManager(e){_classCallCheck(this,KeyboardManager),this.navigator=e,this.bindKeyboardEvents()},[{key:"bindKeyboardEvents",value:function(){var e=this;document.addEventListener("keydown",function(t){return e.handleKeyDown(t)})}},{key:"handleKeyDown",value:function(e){if(0!==this.navigator.getSlideCount())switch(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"," "].includes(e.key)&&e.preventDefault(),e.key){case"ArrowLeft":case"ArrowUp":this.navigator.navigate(-1);break;case"ArrowRight":case"ArrowDown":case" ":this.navigator.navigate(1);break;case"Home":this.navigator.displaySlide(0);break;case"End":this.navigator.displaySlide(this.navigator.getSlideCount()-1)}}}])}();window.KeyboardManager=KeyboardManager;var ScreenManager=function(){return _createClass(function ScreenManager(){_classCallCheck(this,ScreenManager),this.welcomeScreen=document.getElementById("welcome-screen"),this.viewerContainer=document.getElementById("viewer-container")},[{key:"showViewer",value:function(){this.welcomeScreen.classList.add("hidden"),this.viewerContainer.classList.remove("hidden");var e=document.querySelector(".header");e&&e.classList.add("viewer-active")}},{key:"showWelcome",value:function(){this.welcomeScreen.classList.remove("hidden"),this.viewerContainer.classList.add("hidden");var e=document.querySelector(".header");e&&e.classList.remove("viewer-active")}},{key:"isViewerVisible",value:function(){return!this.viewerContainer.classList.contains("hidden")}}])}();window.ScreenManager=ScreenManager;var SlideNavigator=function(){return _createClass(function SlideNavigator(e){_classCallCheck(this,SlideNavigator),this.slides=[],this.currentSlideIndex=0,this.renderer=e,this.thumbnailList=document.getElementById("thumbnail-list"),this.slideContent=document.getElementById("slide-content"),this.slideCounter=document.getElementById("slide-counter"),this.slideNumberInput=document.getElementById("slide-number-input"),this.prevBtn=document.getElementById("prev-btn"),this.nextBtn=document.getElementById("next-btn"),this.firstBtn=document.getElementById("first-btn"),this.lastBtn=document.getElementById("last-btn"),this.bindEvents()},[{key:"bindEvents",value:function(){var e=this;this.prevBtn.addEventListener("click",function(){return e.navigate(-1)}),this.nextBtn.addEventListener("click",function(){return e.navigate(1)}),this.firstBtn.addEventListener("click",function(){return e.displaySlide(0)}),this.lastBtn.addEventListener("click",function(){return e.displaySlide(e.slides.length-1)}),this.slideNumberInput.addEventListener("change",function(t){var r=parseInt(t.target.value);r>=1&&r<=e.slides.length?e.displaySlide(r-1):t.target.value=e.currentSlideIndex+1}),this.slideNumberInput.addEventListener("keydown",function(e){"Enter"===e.key&&e.target.blur()})}},{key:"setSlides",value:function(e){this.slides=e,this.currentSlideIndex=0}},{key:"displaySlide",value:function(e){if(!(e<0||e>=this.slides.length)){this.currentSlideIndex=e;var t=this.slides[e],r=this.thumbnailList.querySelectorAll(".thumbnail");r.forEach(function(t,r){t.classList.toggle("active",r===e)}),r[e]&&r[e].scrollIntoView({behavior:"smooth",block:"nearest"}),this.slideContent.innerHTML=this.renderer.createSlideHTML(t),this.updateNavigation()}}},{key:"navigate",value:function(e){var t=this.currentSlideIndex+e;t>=0&&t<this.slides.length&&this.displaySlide(t)}},{key:"renderThumbnails",value:function(){var e=this;this.thumbnailList.innerHTML="",this.slides.forEach(function(t,r){var a=e.renderer.createThumbnail(t,r,function(t){return e.displaySlide(t)});e.thumbnailList.appendChild(a)}),this.slides.length>0&&this.thumbnailList.children[0].classList.add("active"),this.slideNumberInput.max=this.slides.length}},{key:"updateNavigation",value:function(){var e=this.slides.length,t=this.currentSlideIndex+1;this.slideCounter.textContent="Slide ".concat(t," of ").concat(e),this.slideNumberInput.value=t,this.prevBtn.disabled=0===this.currentSlideIndex,this.nextBtn.disabled=this.currentSlideIndex===e-1,this.firstBtn.disabled=0===this.currentSlideIndex,this.lastBtn.disabled=this.currentSlideIndex===e-1}},{key:"getCurrentSlideIndex",value:function(){return this.currentSlideIndex}},{key:"getSlideCount",value:function(){return this.slides.length}}])}();window.SlideNavigator=SlideNavigator;var FileManager=function(){return _createClass(function FileManager(e){_classCallCheck(this,FileManager),this.fileInput=document.getElementById("pptx-input"),this.fileName=document.getElementById("file-name"),this.viewerFileName=document.getElementById("viewer-file-name"),this.loadingOverlay=document.getElementById("loading-overlay"),this.onFileLoaded=e,this.parser=new PPTXParser,this.bindEvents()},[{key:"bindEvents",value:function(){var e=this;this.fileInput.addEventListener("change",function(t){return e.handleFileSelect(t)}),document.body.addEventListener("dragover",function(e){e.preventDefault(),e.stopPropagation()}),document.body.addEventListener("drop",function(t){t.preventDefault(),t.stopPropagation();var r=t.dataTransfer.files;r.length>0&&r[0].name.endsWith(".pptx")&&e.loadFile(r[0])})}},{key:"handleFileSelect",value:(t=_asyncToGenerator(_regenerator().m(function e(t){var r;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(!(r=t.target.files[0])){e.n=1;break}return e.n=1,this.loadFile(r);case 1:return e.a(2)}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"loadFile",value:(e=_asyncToGenerator(_regenerator().m(function e(t){var r,a,n;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t.name.endsWith(".pptx")){e.n=1;break}return alert("Please select a valid .pptx file"),e.a(2);case 1:return this.showLoading(!0),this.fileName.textContent=t.name,this.fileName.classList.add("active"),this.viewerFileName&&(this.viewerFileName.textContent=t.name),e.p=2,e.n=3,t.arrayBuffer();case 3:return r=e.v,e.n=4,this.parser.parse(r);case 4:a=e.v,this.onFileLoaded(a),e.n=6;break;case 5:e.p=5,n=e.v,console.error("Error loading PPTX:",n),alert("Error loading the presentation. Please make sure it's a valid PPTX file.");case 6:return e.p=6,this.showLoading(!1),e.f(6);case 7:return e.a(2)}},e,this,[[2,5,6,7]])})),function(t){return e.apply(this,arguments)})},{key:"showLoading",value:function(e){e?this.loadingOverlay.classList.remove("hidden"):this.loadingOverlay.classList.add("hidden")}}]);var e,t}();window.FileManager=FileManager;var UIController=function(){return _createClass(function UIController(){_classCallCheck(this,UIController),this.slides=[],this.currentSlideIndex=0,this.parser=new PPTXParser,this.renderer=new SlideRenderer,this.zoomScale=1,this.zoomStep=.15,this.minZoom=.5,this.maxZoom=3,this.initializeElements(),this.bindEvents(),this.initializeTheme(),this.updateZoomUI()},[{key:"initializeElements",value:function(){this.fileInput=document.getElementById("pptx-input"),this.fileName=document.getElementById("file-name"),this.viewerFileName=document.getElementById("viewer-file-name"),this.headerOpenBtn=document.getElementById("header-open-btn"),this.welcomeScreen=document.getElementById("welcome-screen"),this.viewerContainer=document.getElementById("viewer-container"),this.loadingOverlay=document.getElementById("loading-overlay"),this.thumbnailList=document.getElementById("thumbnail-list"),this.slideContent=document.getElementById("slide-content"),this.slideCounter=document.getElementById("slide-counter"),this.slideNumberInput=document.getElementById("slide-number-input"),this.zoomOutBtn=document.getElementById("zoom-out-btn"),this.zoomInBtn=document.getElementById("zoom-in-btn"),this.zoomLevelLabel=document.getElementById("zoom-level"),this.prevBtn=document.getElementById("prev-btn"),this.nextBtn=document.getElementById("next-btn"),this.firstBtn=document.getElementById("first-btn"),this.lastBtn=document.getElementById("last-btn"),this.themeToggle=document.getElementById("theme-toggle")}},{key:"bindEvents",value:function(){var e=this;this.zoomOutBtn&&this.zoomOutBtn.addEventListener("click",function(){return e.changeZoom(-e.zoomStep)}),this.zoomInBtn&&this.zoomInBtn.addEventListener("click",function(){return e.changeZoom(e.zoomStep)}),this.fileInput.addEventListener("change",function(t){return e.handleFileSelect(t)}),this.themeToggle&&this.themeToggle.addEventListener("click",function(){return e.toggleTheme()}),this.prevBtn.addEventListener("click",function(){return e.navigateSlide(-1)}),this.nextBtn.addEventListener("click",function(){return e.navigateSlide(1)}),this.firstBtn.addEventListener("click",function(){return e.displaySlide(0)}),this.lastBtn.addEventListener("click",function(){return e.displaySlide(e.slides.length-1)}),this.slideNumberInput.addEventListener("change",function(t){var r=parseInt(t.target.value);r>=1&&r<=e.slides.length?e.displaySlide(r-1):t.target.value=e.currentSlideIndex+1}),this.slideNumberInput.addEventListener("keydown",function(e){"Enter"===e.key&&e.target.blur()}),document.addEventListener("keydown",function(t){return e.handleKeyboard(t)}),document.body.addEventListener("dragover",function(e){e.preventDefault(),e.stopPropagation()}),this.slideContent&&this.slideContent.addEventListener("click",function(t){var r,a,n=null===(r=t.target)||void 0===r||null===(a=r.closest)||void 0===a?void 0:a.call(r,"a[data-pptx-slide]");if(n){var i=parseInt(n.getAttribute("data-pptx-slide"),10);Number.isNaN(i)||(t.preventDefault(),t.stopPropagation(),e.displaySlide(i))}}),document.body.addEventListener("drop",function(t){t.preventDefault(),t.stopPropagation();var r=t.dataTransfer.files;r.length>0&&r[0].name.endsWith(".pptx")&&e.loadFile(r[0])}),this.headerOpenBtn&&this.headerOpenBtn.addEventListener("click",function(){e.fileInput.value="",e.fileInput.click()})}},{key:"handleKeyboard",value:function(e){if(0!==this.slides.length)switch(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"," "].includes(e.key)&&e.preventDefault(),e.key){case"ArrowLeft":case"ArrowUp":this.navigateSlide(-1);break;case"ArrowRight":case"ArrowDown":case" ":this.navigateSlide(1);break;case"Home":this.displaySlide(0);break;case"End":this.displaySlide(this.slides.length-1)}}},{key:"handleFileSelect",value:(t=_asyncToGenerator(_regenerator().m(function e(t){var r;return _regenerator().w(function(e){for(;;)switch(e.n){case 0:if(!(r=t.target.files[0])){e.n=1;break}return e.n=1,this.loadFile(r);case 1:return e.a(2)}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"loadFile",value:(e=_asyncToGenerator(_regenerator().m(function e(t){var r,a,n;return _regenerator().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t.name.endsWith(".pptx")){e.n=1;break}return alert("Please select a valid .pptx file"),e.a(2);case 1:return this.showLoading(!0),this.fileName&&(this.fileName.textContent=t.name,this.fileName.classList.add("active")),this.viewerFileName&&(this.viewerFileName.textContent=t.name),e.p=2,e.n=3,t.arrayBuffer();case 3:return r=e.v,e.n=4,this.parser.parse(r);case 4:a=e.v,this.slides=a.slides||[],this.setZoom(1),this.showViewer(),this.renderThumbnails(),this.displaySlide(0),e.n=6;break;case 5:e.p=5,n=e.v,console.error("Error loading PPTX:",n),alert("Error loading the presentation. Please make sure it's a valid PPTX file.");case 6:return e.p=6,this.showLoading(!1),e.f(6);case 7:return e.a(2)}},e,this,[[2,5,6,7]])})),function(t){return e.apply(this,arguments)})},{key:"showLoading",value:function(e){e?this.loadingOverlay.classList.remove("hidden"):this.loadingOverlay.classList.add("hidden")}},{key:"showViewer",value:function(){this.welcomeScreen.classList.add("hidden"),this.viewerContainer.classList.remove("hidden");var e=document.querySelector(".header");e&&e.classList.add("viewer-active")}},{key:"renderThumbnails",value:function(){var e=this;this.thumbnailList.innerHTML="",this.slides.forEach(function(t,r){var a=e.renderer.createThumbnail(t,r,function(t){return e.displaySlide(t)});e.thumbnailList.appendChild(a)}),this.slides.length>0&&this.thumbnailList.children[0].classList.add("active"),this.slideNumberInput.max=this.slides.length}},{key:"displaySlide",value:function(e){if(!(e<0||e>=this.slides.length)){this.currentSlideIndex=e;var t=this.slides[e],r=this.thumbnailList.querySelectorAll(".thumbnail");r.forEach(function(t,r){t.classList.toggle("active",r===e)}),r[e]&&r[e].scrollIntoView({behavior:"smooth",block:"nearest"}),this.slideContent.innerHTML=this.renderer.createSlideHTML(t),this.applyZoomToSlide(),this.updateZoomUI(),this.updateNavigation()}}},{key:"updateNavigation",value:function(){var e=this.slides.length,t=this.currentSlideIndex+1;this.slideCounter.textContent="Slide ".concat(t," of ").concat(e),this.slideNumberInput.value=t,this.prevBtn.disabled=0===this.currentSlideIndex,this.nextBtn.disabled=this.currentSlideIndex===e-1,this.firstBtn.disabled=0===this.currentSlideIndex,this.lastBtn.disabled=this.currentSlideIndex===e-1}},{key:"navigateSlide",value:function(e){var t=this.currentSlideIndex+e;t>=0&&t<this.slides.length&&this.displaySlide(t)}},{key:"changeZoom",value:function(e){this.setZoom(this.zoomScale+e)}},{key:"setZoom",value:function(e){var t=Math.min(this.maxZoom,Math.max(this.minZoom,e));this.zoomScale=t,this.updateZoomUI(),this.applyZoomToSlide()}},{key:"applyZoomToSlide",value:function(){if(this.slideContent){var e=Math.abs(this.zoomScale-1)>.01;this.slideContent.classList.toggle("zoomed",e);var t=this.slideContent.querySelector(".slide-wrapper");t&&(t.style.transform="scale(".concat(this.zoomScale,")"),t.style.transformOrigin="top center")}}},{key:"updateZoomUI",value:function(){if(this.zoomLevelLabel){var e=Math.abs(this.zoomScale-1)<.01;this.zoomLevelLabel.textContent=e?"Fit":"".concat(Math.round(100*this.zoomScale),"%")}this.zoomOutBtn&&(this.zoomOutBtn.disabled=this.zoomScale<=this.minZoom+.001),this.zoomInBtn&&(this.zoomInBtn.disabled=this.zoomScale>=this.maxZoom-.001)}},{key:"initializeTheme",value:function(){var e=this,t=localStorage.getItem("theme");if(t)this.setTheme(t);else{var r=window.matchMedia("(prefers-color-scheme: dark)").matches;this.setTheme(r?"dark":"light")}window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",function(t){localStorage.getItem("theme")||e.setTheme(t.matches?"dark":"light")})}},{key:"toggleTheme",value:function(){var e="dark"===document.documentElement.getAttribute("data-theme")?"light":"dark";this.setTheme(e),localStorage.setItem("theme",e)}},{key:"setTheme",value:function(e){document.documentElement.setAttribute("data-theme",e)}}]);var e,t}();window.UIController=UIController,document.addEventListener("DOMContentLoaded",function(){window.pptxViewer=new UIController});